# file opened: cc.asm
   1  0000
   2  0000              			DEVICE ZXSPECTRUMNEXT
   3  0000                          OPT reset --zxnext --syntax=abfw
   4  0000                          slot 3
   5  0000
   6  0000                          DEFINE DISP_ADDRESS     $2000
   7  0000                          DEFINE SP_ADDRESS       $3D00
   8  0000                          OPT --zxnext=cspect
   9  0000                          DEFINE ORG_ADDRESS      $8000
  10  0000                          DEFINE TEST_CODE_PAGE   223         ; using the last page of 2MiB RAM (in emulator)
  11  0000                          DEFINE TILE_MAP_ADR     $4000           ; 80*32 = 2560 (10*256)
  12  0000                          DEFINE TILE_GFX_ADR     $6000;$5400           ; 128*32 = 4096
  13  0000                                                                  ; = 6656 $1A00 -> fits into ULA classic VRAM
  14  0000
  15  0000
  16  0000              	DEFINE CFG_FILENAME     dspedge.defaultCfgFileName
  17  0000                  STRUCT S_MARGINS        ; pixels of margin 0..31 (-1 = undefined margin)
  18  0000 ~            L           BYTE    -1      ; left
  19  0000 ~            R           BYTE    -1      ; right
  20  0000 ~            T           BYTE    -1      ; top
  21  0000 ~            B           BYTE    -1      ; bottom
  22  0000                  ENDS
  23  0000                  STRUCT S_UI_DEFINITIONS
  24  0000 ~            labelDot    WORD    0       ; address where to write display dot
  25  0000 ~            cellAdr     WORD    0       ; address of big table cell on screen at [1,0] char inside
  26  0000 ~            nextMode    BYTE    0
  27  0000 ~            keyword     WORD    0       ; address of keyword used in the CFG file
  28  0000                  ENDS
  29  0000                  STRUCT S_MODE_EDGES
  30  0000 ~                    ; current margins values (must be first four bytes of the structure)
  31  0000 ~            cur         S_MARGINS
  32  0000 ~                    ; original values (from file)
  33  0000 ~            orig        S_MARGINS
  34  0000 ~                    ; UI related config
  35  0000 ~            ui          S_UI_DEFINITIONS
  36  0000 ~                    ; internal flags and intermediate values
  37  0000 ~            modified    BYTE    0       ; if this mode was modified in some way
  38  0000 ~            leftT       BYTE    0       ; full tiles left
  39  0000 ~            rightT      BYTE    0       ; full tiles right
  40  0000 ~            midT        BYTE    0       ; amount of semi top/bottom tiles (w/o left/right corner tiles)
  41  0000 ~                    ; bit masks to redraw gfx tile with Green/Background color (columns/rows in bits)
  42  0000 ~                    ; preserve the order of offsets, they are processed in "++DE" way
  43  0000 ~            maskLeftG   BYTE    0
  44  0000 ~            maskLeftB   BYTE    0
  45  0000 ~            maskRightG  BYTE    0
  46  0000 ~            maskRightB  BYTE    0
  47  0000 ~            maskTopG    BYTE    0
  48  0000 ~            maskTopB    BYTE    0
  49  0000 ~            maskBottomG BYTE    0
  50  0000 ~            maskBottomB BYTE    0
  51  0000                  ENDS
  52  0000                  STRUCT S_STATE
  53  0000 ~            timingIsUnlocked    BYTE    0
  54  0000 ~            edge                BYTE    0   ; 0 left, 1 top, 2 right, 3 bottom (to align with chars)
  55  0000 ~            lastCtrlKey         BYTE    0   ; save/reload/quit/hz/timing when waiting for confirm
  56  0000 ~            debounceKey         BYTE    0
  57  0000 ~            modified            BYTE    0   ; set if any of modes (even inactive) is modified
  58  0000 ~            noFileFound         BYTE    0
  59  0000 ~            esxErrorNo          BYTE    1
  60  0000 ~            argsPtr             WORD    0
  61  0000                  ENDS
  62  0000                  STRUCT S_PRESERVE
  63  0000 ~                    ; WORDs used, first byte is register number, second byte is preserved value
  64  0000 ~            turbo_07            WORD    TURBO_CONTROL_NR_07
  65  0000 ~            spr_ctrl_15         WORD    SPRITE_CONTROL_NR_15
  66  0000 ~            transp_fallback_4A  WORD    TRANSPARENCY_FALLBACK_COL_NR_4A
  67  0000 ~            tile_transp_4C      WORD    TILEMAP_TRANSPARENCY_I_NR_4C
  68  0000 ~            ula_ctrl_68         WORD    ULA_CONTROL_NR_68
  69  0000 ~            display_ctrl_69     WORD    DISPLAY_CONTROL_NR_69
  70  0000 ~            tile_ctrl_6B        WORD    TILEMAP_CONTROL_NR_6B
  71  0000 ~            tile_def_attr_6C    WORD    TILEMAP_DEFAULT_ATTR_NR_6C
  72  0000 ~            tile_map_adr_6E     WORD    TILEMAP_BASE_ADR_NR_6E
  73  0000 ~            tile_gfx_adr_6F     WORD    TILEMAP_GFX_ADR_NR_6F
  74  0000 ~            tile_xofs_msb_2F    WORD    TILEMAP_XOFFSET_MSB_NR_2F
  75  0000 ~            tile_xofs_lsb_30    WORD    TILEMAP_XOFFSET_LSB_NR_30
  76  0000 ~            tile_yofs_31        WORD    TILEMAP_YOFFSET_NR_31
  77  0000 ~            pal_ctrl_43         WORD    PALETTE_CONTROL_NR_43
  78  0000 ~            pal_idx_40          WORD    PALETTE_INDEX_NR_40
  79  0000 ~            mmu2_52             WORD    MMU2_4000_NR_52
  80  0000 ~            mmu3_53             WORD    MMU3_6000_NR_53
  81  0000 ~                ; not preserving tilemode clip window coordinates, and tilemode palette
  82  0000 ~                ; (intentionally, not expecting anyone to need it, or not being able to fix it)
  83  0000 ~                ; (and subtle sub-states like half-written 9bit color to $44 -> will be lost too)
  84  0000                  ENDS
  85  0000              KEY_DEBOUNCE_WAIT   EQU     8
  86  0000              CHAR_DOT_RED        EQU     25
  87  0000              CHAR_DOT_YELLOW     EQU     26
  88  0000              CHAR_DOT_GREEN      EQU     27
  89  0000              CHAR_ARROW_L        EQU     28
  90  0000              CHAR_ARROW_T        EQU     29
  91  0000              CHAR_ARROW_R        EQU     30
  92  0000              CHAR_ARROW_B        EQU     31
  93  0000              ;; some further constants, mostly machine/API related
  94  0000
  95  0000                  INCLUDE "constants.i.asm"
# file opened: constants.i.asm
   1+ 0000
   2+ 0000              ; ----- Colour palette (ULA)
   3+ 0000              BLACK			equ 0
   4+ 0000              BLUE			equ 1
   5+ 0000              RED				equ 2
   6+ 0000              MAGENTA			equ 3
   7+ 0000              GREEN			equ 4
   8+ 0000              CYAN			equ 5
   9+ 0000              YELLOW			equ 6
  10+ 0000              WHITE			equ 7
  11+ 0000              P_BLACK			equ 0
  12+ 0000              P_BLUE			equ 1<<3
  13+ 0000              P_RED			equ 2<<3
  14+ 0000              P_MAGENTA		equ 3<<3
  15+ 0000              P_GREEN			equ 4<<3
  16+ 0000              P_CYAN			equ 5<<3
  17+ 0000              P_YELLOW		equ 6<<3
  18+ 0000              P_WHITE			equ 7<<3
  19+ 0000              ; ----- Attribs
  20+ 0000              A_FLASH			equ 128
  21+ 0000              A_BRIGHT		equ 64
  22+ 0000              ;----------------------------------------------
  23+ 0000              BIT_UP			equ 4	; 16
  24+ 0000              BIT_DOWN		equ 5	; 32
  25+ 0000              BIT_LEFT		equ 6	; 64
  26+ 0000              BIT_RIGHT		equ 7	; 128
  27+ 0000
  28+ 0000              DIR_NONE		equ %00000000
  29+ 0000              DIR_UP			equ %00010000
  30+ 0000              DIR_DOWN		equ %00100000
  31+ 0000              DIR_LEFT		equ %01000000
  32+ 0000              DIR_RIGHT		equ %10000000
  33+ 0000
  34+ 0000              DIR_UP_I		equ %11101111
  35+ 0000              DIR_DOWN_I		equ %11011111
  36+ 0000              DIR_LEFT_I		equ %10111111
  37+ 0000              DIR_RIGHT_I		equ %01111111
  38+ 0000
  39+ 0000              ;-----------------------------------------------------------------------------
  40+ 0000              ;-- I/O ports - ZX Spectrum classic (48, 128, Timex, Pentagon, ...) ports
  41+ 0000
  42+ 0000              ULA_P_FE                        equ $FE     ; BORDER + MIC + BEEP + read Keyboard
  43+ 0000              TIMEX_P_FF                      equ $FF     ; Timex video control port
  44+ 0000
  45+ 0000              ZX128_MEMORY_P_7FFD             equ $7FFD   ; ZX Spectrum 128 ports
  46+ 0000              ZX128_MEMORY_P_DFFD             equ $DFFD
  47+ 0000              ZX128P3_MEMORY_P_1FFD           equ $1FFD
  48+ 0000
  49+ 0000              AY_REG_P_FFFD                   equ $FFFD
  50+ 0000              AY_DATA_P_BFFD                  equ $BFFD
  51+ 0000
  52+ 0000              Z80_DMA_PORT_DATAGEAR           equ $6B     ; on ZXN the zxnDMA handles this
  53+ 0000              Z80_DMA_PORT_MB02               equ $0B     ; only in Zilog DMA mode zxnDMA handles this
  54+ 0000
  55+ 0000              DIVMMC_CONTROL_P_E3             equ $E3
  56+ 0000              SPI_CS_P_E7                     equ $E7
  57+ 0000              SPI_DATA_P_EB                   equ $EB
  58+ 0000
  59+ 0000              KEMPSTON_MOUSE_X_P_FBDF         equ $FBDF
  60+ 0000              KEMPSTON_MOUSE_Y_P_FFDF         equ $FFDF
  61+ 0000              KEMPSTON_MOUSE_B_P_FADF         equ $FADF   ; kempston mouse wheel+buttons
  62+ 0000
  63+ 0000              KEMPSTON_JOY1_P_1F              equ $1F
  64+ 0000              KEMPSTON_JOY2_P_37              equ $37
  65+ 0000
  66+ 0000              ;-----------------------------------------------------------------------------
  67+ 0000              ;-- I/O ports - ZX Spectrum NEXT specific ports
  68+ 0000
  69+ 0000              TBBLUE_REGISTER_SELECT_P_243B   equ $243B
  70+ 0000                  ; -- port $243B = 9275  Read+Write (detection bitmask: %0010_0100_0011_1011)
  71+ 0000                  ;   -- selects NextREG mapped at port TBBLUE_REGISTER_ACCESS_P_253B
  72+ 0000
  73+ 0000              TBBLUE_REGISTER_ACCESS_P_253B   equ $253B
  74+ 0000                  ; -- port $253B = 9531  Read?+Write? (detection bitmask: %0010_0101_0011_1011)
  75+ 0000                  ;   -- data for selected NextREG (read/write depends on the register selected)
  76+ 0000
  77+ 0000              I2C_SCL_P_103B                  equ $103B   ; i2c bus port (clock) (write only?)
  78+ 0000              I2C_SDA_P_113B                  equ $113B   ; i2c bus port (data) (read+write)
  79+ 0000              UART_TX_P_133B                  equ $133B   ; UART tx port (read+write)
  80+ 0000              UART_RX_P_143B                  equ $143B   ; UART rx port (read+write)
  81+ 0000
  82+ 0000              ZXN_DMA_P_6B                    equ $6B
  83+ 0000                  ; -- port $6B = 107 Read+Write (detection bitmask: %xxxx_xxxx_0110_1011)
  84+ 0000                  ;   - The zxnDMA is mostly compatible with Zilog DMA chip (Z8410) (at least
  85+ 0000                  ;     as far as old ZX apps are concerned), but has many modifications.
  86+ 0000                  ;   - core3.0 update - specific behaviour details can be selected (PERIPHERAL_2_NR_06)
  87+ 0000
  88+ 0000              LAYER2_ACCESS_P_123B            equ $123B
  89+ 0000                  ; -- port $123B = 4667 Read+Write (detection bitmask: %0001_0010_0011_1011)
  90+ 0000                  ;   -- bit 7-6 = write-Layer2-over-ROM bank selection (00, 01 or 10) (11 is 48kiB mode)
  91+ 0000                  ;   -- bit 3 = shadow banks "over ROM" (nextreg $13 banks instead of $12 banks)
  92+ 0000                  ;   -- bit 2 = read-Layer2-over-ROM (1 = read at $0000..$3FFF reads from Layer2)
  93+ 0000                  ;   -- bit 1 = Layer2 visibility (1 = visible, 0 = disabled) (always nextreg $12)
  94+ 0000                  ;   -- bit 0 = write-Layer2-over-ROM (1 = write at $0000..$3FFF writes into Layer2)
  95+ 0000              LAYER2_ACCESS_WRITE_OVER_ROM    equ $01     ; map Layer2 bank into ROM area (0000..3FFF) for WRITE-only (reads as ROM)
  96+ 0000              LAYER2_ACCESS_L2_ENABLED        equ $02     ; enable Layer2 (make banks form nextreg $12 visible)
  97+ 0000              LAYER2_ACCESS_READ_OVER_ROM     equ $04     ; map Layer2 bank into ROM area (0000..3FFF) for READ-only
  98+ 0000              LAYER2_ACCESS_SHADOW_OVER_ROM   equ $08     ; bank selected by bits 6-7 is from "shadow Layer 2" banks range (nextreg $13)
  99+ 0000              LAYER2_ACCESS_OVER_ROM_BANK_M   equ $C0     ; (mask of) value 0..3 selecting bank mapped for R/W (Nextreg $12 or $13)
 100+ 0000              LAYER2_ACCESS_OVER_ROM_BANK_0   equ $00     ; screen lines 0..63
 101+ 0000              LAYER2_ACCESS_OVER_ROM_BANK_1   equ $40     ; screen lines 64..127
 102+ 0000              LAYER2_ACCESS_OVER_ROM_BANK_2   equ $80     ; screen lines 128..191
 103+ 0000              LAYER2_ACCESS_OVER_ROM_48K      equ $C0     ; maps all 0..191 lines into $0000..$BFFF region
 104+ 0000
 105+ 0000              SPRITE_STATUS_SLOT_SELECT_P_303B    equ $303B
 106+ 0000                  ; -- port $303B = 12347  Read+Write (detection bitmask: %0011_0000_0011_1011)
 107+ 0000                  ;   -- write:
 108+ 0000                  ;     - sets both "sprite slot" (0..63) and "pattern slot" (0..63 +128)
 109+ 0000                  ;     - once the sprite/pattern slots are set, they act independently and
 110+ 0000                  ;     each port ($xx57 and $xx5B) will auto-increment its own slot index
 111+ 0000                  ;     (to resync one can write to this port again).
 112+ 0000                  ;     - the +128 flag will make the pattern upload start at byte 128 of pattern
 113+ 0000                  ;     slot (second half of slot)
 114+ 0000                  ;     - The sprite-slot (sprite-attributes) may be optionally interlinked with
 115+ 0000                  ;     NextReg $34 (feature controlled by NextReg $34)
 116+ 0000                  ;     - auto-increments of slot position from value 63 are officially
 117+ 0000                  ;     "undefined behaviour", wrap to 0 is not guaranteed. (only setting slots
 118+ 0000                  ;     explicitly back to valid 0..63 will make your code future-proof)
 119+ 0000                  ;   -- read (will also reset both collision and max-sprites flags):
 120+ 0000                  ;     - bit 1 = maximum sprites per line hit (set when sprite renderer ran
 121+ 0000                  ;               out of time when preparing next scanline)
 122+ 0000                  ;     - bit 0 = collision flag (set when any sprites draw non-transparent
 123+ 0000                  ;               pixel at the same location)
 124+ 0000                  ;     Both flags contain values for current scanline already at the beginning
 125+ 0000                  ;     of scanline (sprite engine renders one line ahead into buffer and updates
 126+ 0000                  ;     flags progressively as it renders the sprites)
 127+ 0000              SPRITE_STATUS_MAXIMUM_SPRITES   equ $02
 128+ 0000              SPRITE_STATUS_COLLISION         equ $01
 129+ 0000              SPRITE_SLOT_SELECT_PATTERN_HALF equ 128     ; add it to 0..63 index to make pattern upload start at second half of pattern
 130+ 0000
 131+ 0000              SPRITE_ATTRIBUTE_P_57           equ $57
 132+ 0000                  ; -- port $xx57 = 87 write-only (detection bitmask: %xxxx_xxxx_0101_0111)
 133+ 0000                  ;  - writing 4 or 5 bytes long structures to control particular sprite
 134+ 0000                  ;  - after 4/5 bytes block the sprite slot index is auto-incremented
 135+ 0000                  ;  - for detailed documentation check official docs or wiki (too long)
 136+ 0000
 137+ 0000              SPRITE_PATTERN_P_5B             equ $5B
 138+ 0000                  ; -- port $xx5B = 91 write-only (detection bitmask: %xxxx_xxxx_0101_1011)
 139+ 0000                  ;  - each pattern slot is 256 bytes long = one 16x16 pattern of 8-bit pixels
 140+ 0000                  ;    or two 16x16 patterns of 4-bit pixels.
 141+ 0000                  ;  - Patterns are uploaded in "English" order (left to right, top to bottom),
 142+ 0000                  ;    one byte encodes single pixel in 8 bit mode and two pixels in 4 bit
 143+ 0000                  ;    mode (bits 7-4 are "left" pixel, 3-0 are "right" pixel)
 144+ 0000                  ;  - pixels are offset (index) into active sprite palette
 145+ 0000
 146+ 0000              TURBO_SOUND_CONTROL_P_FFFD      equ $FFFD   ; write with bit 7 = 1 (port shared with AY)
 147+ 0000
 148+ 0000              ;-----------------------------------------------------------------------------
 149+ 0000              ;-- NEXT HW Registers (NextReg)
 150+ 0000              MACHINE_ID_NR_00                equ $00
 151+ 0000              NEXT_VERSION_NR_01              equ $01
 152+ 0000              NEXT_RESET_NR_02                equ $02
 153+ 0000              MACHINE_TYPE_NR_03              equ $03
 154+ 0000              ROM_MAPPING_NR_04               equ $04     ;In config mode, allows RAM to be mapped to ROM area.
 155+ 0000              PERIPHERAL_1_NR_05              equ $05     ;Sets joystick mode, video frequency and Scandoubler.
 156+ 0000              PERIPHERAL_2_NR_06              equ $06     ;Enables Acceleration, DivMMC, Multiface, Mouse and AY audio
 157+ 0000              TURBO_CONTROL_NR_07             equ $07
 158+ 0000              PERIPHERAL_3_NR_08              equ $08     ;ABC/ACB Stereo, Internal Speaker, SpecDrum, Timex Video Modes, Turbo Sound Next, RAM contention and [un]lock 128k paging.
 159+ 0000              PERIPHERAL_4_NR_09              equ $09     ;Sets scanlines, AY mono output, Sprite-id lockstep, disables Kempston and divMMC ports.
 160+ 0000              NEXT_VERSION_MINOR_NR_0E        equ $0E
 161+ 0000              ANTI_BRICK_NR_10                equ $10
 162+ 0000              VIDEO_TIMING_NR_11              equ $11
 163+ 0000              LAYER2_RAM_BANK_NR_12           equ $12     ;bank number where visible Layer 2 video memory begins.
 164+ 0000              LAYER2_RAM_SHADOW_BANK_NR_13    equ $13     ;bank number for Layer2 "shadow" write-over-rom
 165+ 0000              GLOBAL_TRANSPARENCY_NR_14       equ $14     ;Sets the color treated as transparent for ULA/Layer2/LoRes
 166+ 0000              SPRITE_CONTROL_NR_15            equ $15     ;LoRes mode, Sprites configuration, layers priority
 167+ 0000                  ; bit 7: enable LoRes mode
 168+ 0000                  ; bit 6: sprite rendering (1=sprite 0 on top of other, 0=sprite 0 at bottom)
 169+ 0000                  ; bit 5: If 1, the clipping works even in "over border" mode
 170+ 0000                  ; 4-2: layers priority: 000=SLU, 001=LSU, 010=SUL, 011=LUS, 100=USL, 101=ULS, 110=S,mix(U+L), 111=S,mix(U+L-5)
 171+ 0000                  ; bit 1: enable sprites over border, bit 0: show sprites
 172+ 0000              LAYER2_XOFFSET_NR_16            equ $16
 173+ 0000              LAYER2_YOFFSET_NR_17            equ $17
 174+ 0000              CLIP_LAYER2_NR_18               equ $18
 175+ 0000              CLIP_SPRITE_NR_19               equ $19
 176+ 0000              CLIP_ULA_LORES_NR_1A            equ $1A
 177+ 0000              CLIP_TILEMAP_NR_1B              equ $1B
 178+ 0000              CLIP_WINDOW_CONTROL_NR_1C       equ $1C     ;set to 15 to reset all clip-window indices to 0
 179+ 0000              RASTER_LINE_MSB_NR_1E           equ $1E
 180+ 0000              RASTER_LINE_LSB_NR_1F           equ $1F
 181+ 0000              RASTER_INTERUPT_CONTROL_NR_22   equ $22     ;Controls the timing of raster interrupts and the ULA frame interrupt.
 182+ 0000              RASTER_INTERUPT_VALUE_NR_23     equ $23
 183+ 0000              ULA_XOFFSET_NR_26               equ $26     ;since core 3.0
 184+ 0000              ULA_YOFFSET_NR_27               equ $27     ;since core 3.0
 185+ 0000              HIGH_ADRESS_KEYMAP_NR_28        equ $28
 186+ 0000              LOW_ADRESS_KEYMAP_NR_29         equ $29
 187+ 0000              HIGH_DATA_TO_KEYMAP_NR_2A       equ $2A
 188+ 0000              LOW_DATA_TO_KEYMAP_NR_2B        equ $2B
 189+ 0000              DAC_B_MIRROR_NR_2C              equ $2C
 190+ 0000              DAC_AD_MIRROR_NR_2D             equ $2D     ;another alias for $2D
 191+ 0000              SOUNDDRIVE_DF_MIRROR_NR_2D      equ $2D     ;Nextreg port-mirror of port 0xDF
 192+ 0000              DAC_C_MIRROR_NR_2E              equ $2E
 193+ 0000              TILEMAP_XOFFSET_MSB_NR_2F       equ $2F
 194+ 0000              TILEMAP_XOFFSET_LSB_NR_30       equ $30
 195+ 0000              TILEMAP_YOFFSET_NR_31           equ $31
 196+ 0000              LORES_XOFFSET_NR_32             equ $32
 197+ 0000              LORES_YOFFSET_NR_33             equ $33
 198+ 0000              SPRITE_ATTR_SLOT_SEL_NR_34      equ $34     ;Sprite-attribute slot index for $35-$39/$75-$79 port $57 mirrors
 199+ 0000              SPRITE_ATTR0_NR_35              equ $35     ;port $57 mirror in nextreg space (accessible to copper)
 200+ 0000              SPRITE_ATTR1_NR_36              equ $36
 201+ 0000              SPRITE_ATTR2_NR_37              equ $37
 202+ 0000              SPRITE_ATTR3_NR_38              equ $38
 203+ 0000              SPRITE_ATTR4_NR_39              equ $39
 204+ 0000              PALETTE_INDEX_NR_40             equ $40     ;Chooses a ULANext palette number to configure.
 205+ 0000              PALETTE_VALUE_NR_41             equ $41     ;Used to upload 8-bit colors to the ULANext palette.
 206+ 0000              PALETTE_FORMAT_NR_42            equ $42     ;ink-mask for ULANext modes
 207+ 0000              PALETTE_CONTROL_NR_43           equ $43     ;Enables or disables ULANext interpretation of attribute values and toggles active palette.
 208+ 0000              PALETTE_VALUE_9BIT_NR_44        equ $44     ;Holds the additional blue color bit for RGB333 color selection.
 209+ 0000              TRANSPARENCY_FALLBACK_COL_NR_4A equ $4A     ;8-bit colour to be drawn when all layers are transparent
 210+ 0000              SPRITE_TRANSPARENCY_I_NR_4B     equ $4B     ;index of transparent colour in sprite palette (only bottom 4 bits for 4-bit patterns)
 211+ 0000              TILEMAP_TRANSPARENCY_I_NR_4C    equ $4C     ;index of transparent colour in tilemap graphics (only bottom 4 bits)
 212+ 0000              MMU0_0000_NR_50                 equ $50     ;Set a Spectrum RAM page at position 0x0000 to 0x1FFF
 213+ 0000              MMU1_2000_NR_51                 equ $51     ;Set a Spectrum RAM page at position 0x2000 to 0x3FFF
 214+ 0000              MMU2_4000_NR_52                 equ $52     ;Set a Spectrum RAM page at position 0x4000 to 0x5FFF
 215+ 0000              MMU3_6000_NR_53                 equ $53     ;Set a Spectrum RAM page at position 0x6000 to 0x7FFF
 216+ 0000              MMU4_8000_NR_54                 equ $54     ;Set a Spectrum RAM page at position 0x8000 to 0x9FFF
 217+ 0000              MMU5_A000_NR_55                 equ $55     ;Set a Spectrum RAM page at position 0xA000 to 0xBFFF
 218+ 0000              MMU6_C000_NR_56                 equ $56     ;Set a Spectrum RAM page at position 0xC000 to 0xDFFF
 219+ 0000              MMU7_E000_NR_57                 equ $57     ;Set a Spectrum RAM page at position 0xE000 to 0xFFFF
 220+ 0000              COPPER_DATA_NR_60               equ $60
 221+ 0000              COPPER_CONTROL_LO_NR_61         equ $61
 222+ 0000              COPPER_CONTROL_HI_NR_62         equ $62
 223+ 0000              COPPER_DATA_16B_NR_63           equ $63     ; same as $60, but waits for full 16b before write
 224+ 0000              ULA_CONTROL_NR_68               equ $68
 225+ 0000              DISPLAY_CONTROL_NR_69           equ $69
 226+ 0000              LORES_CONTROL_NR_6A             equ $6A
 227+ 0000              TILEMAP_CONTROL_NR_6B           equ $6B
 228+ 0000              TILEMAP_DEFAULT_ATTR_NR_6C      equ $6C
 229+ 0000              TILEMAP_BASE_ADR_NR_6E          equ $6E     ;Tilemap base address of map
 230+ 0000              TILEMAP_GFX_ADR_NR_6F           equ $6F     ;Tilemap definitions (graphics of tiles)
 231+ 0000              LAYER2_CONTROL_NR_70            equ $70
 232+ 0000              SPRITE_ATTR0_INC_NR_75          equ $75     ;port $57 mirror in nextreg space (accessible to copper) (slot index++)
 233+ 0000              SPRITE_ATTR1_INC_NR_76          equ $76
 234+ 0000              SPRITE_ATTR2_INC_NR_77          equ $77
 235+ 0000              SPRITE_ATTR3_INC_NR_78          equ $78
 236+ 0000              SPRITE_ATTR4_INC_NR_79          equ $79
 237+ 0000              USER_STORAGE_0_NR_7F            equ $7F
 238+ 0000              EXPANSION_BUS_CONTROL_NR_80     equ $80
 239+ 0000              INTERNAL_PORT_DECODING_0_NR_82  equ $82     ;bits 0-7
 240+ 0000              INTERNAL_PORT_DECODING_1_NR_83  equ $83     ;bits 8-15
 241+ 0000              INTERNAL_PORT_DECODING_2_NR_84  equ $84     ;bits 16-23
 242+ 0000              INTERNAL_PORT_DECODING_3_NR_85  equ $85     ;bits 24-31
 243+ 0000              EXPANSION_BUS_DECODING_0_NR_86  equ $86     ;bits 0-7 mask
 244+ 0000              EXPANSION_BUS_DECODING_1_NR_87  equ $87     ;bits 8-15 mask
 245+ 0000              EXPANSION_BUS_DECODING_2_NR_88  equ $88     ;bits 16-23 mask
 246+ 0000              EXPANSION_BUS_DECODING_3_NR_89  equ $89     ;bits 24-31 mask
 247+ 0000              EXPANSION_BUS_PROPAGATE_NR_8A   equ $8A     ;Monitoring internal I/O or adding external keyboard
 248+ 0000              PI_GPIO_OUT_ENABLE_0_NR_90      equ $90     ;pins 0-7
 249+ 0000              PI_GPIO_OUT_ENABLE_1_NR_91      equ $91     ;pins 8-15
 250+ 0000              PI_GPIO_OUT_ENABLE_2_NR_92      equ $92     ;pins 16-23
 251+ 0000              PI_GPIO_OUT_ENABLE_3_NR_93      equ $93     ;pins 24-27
 252+ 0000              PI_GPIO_0_NR_98                 equ $98     ;pins 0-7
 253+ 0000              PI_GPIO_1_NR_99                 equ $99     ;pins 8-15
 254+ 0000              PI_GPIO_2_NR_9A                 equ $9A     ;pins 16-23
 255+ 0000              PI_GPIO_3_NR_9B                 equ $9B     ;pins 24-27
 256+ 0000              PI_PERIPHERALS_ENABLE_NR_A0     equ $A0
 257+ 0000              PI_I2S_AUDIO_CONTROL_NR_A2      equ $A2
 258+ 0000              PI_I2S_CLOCK_DIVIDE_NR_A3       equ $A3
 259+ 0000              DEBUG_LED_CONTROL_NR_FF         equ $FF     ;Turns debug LEDs on and off on TBBlue implementations that have them.
 260+ 0000
 261+ 0000              ;-----------------------------------------------------------------------------
 262+ 0000              ;-- common memory addresses
 263+ 0000              MEM_ROM_CHARS_3C00              equ $3C00   ; actual chars start at $3D00 with space
 264+ 0000              MEM_ZX_SCREEN_4000              equ $4000
 265+ 0000              MEM_ZX_ATTRIB_5800              equ $5800
 266+ 0000              MEM_LORES0_4000                 equ $4000
 267+ 0000              MEM_LORES1_6000                 equ $6000
 268+ 0000              MEM_TIMEX_SCR0_4000             equ $4000
 269+ 0000              MEM_TIMEX_SCR1_6000             equ $6000
 270+ 0000
 271+ 0000              ;-----------------------------------------------------------------------------
 272+ 0000              ;-- Copper commands
 273+ 0000              COPPER_NOOP                     equ %00000000
 274+ 0000              COPPER_WAIT_H                   equ %1'000000'0
 275+ 0000              COPPER_HALT_B                   equ $FF   ; 2x $FF = wait for (511,63) = infinite wait
 276+ 0000
 277+ 0000              ;-----------------------------------------------------------------------------
 278+ 0000              ; DMA (Register 6)
 279+ 0000              DMA_RESET					equ $C3
 280+ 0000              DMA_RESET_PORT_A_TIMING		equ $C7
 281+ 0000              DMA_RESET_PORT_B_TIMING		equ $CB
 282+ 0000              DMA_LOAD					equ $CF
 283+ 0000              DMA_CONTINUE				equ $D3
 284+ 0000              DMA_DISABLE_INTERUPTS		equ $AF
 285+ 0000              DMA_ENABLE_INTERUPTS		equ $AB
 286+ 0000              DMA_RESET_DISABLE_INTERUPTS	equ $A3
 287+ 0000              DMA_ENABLE_AFTER_RETI		equ $B7
 288+ 0000              DMA_READ_STATUS_BYTE		equ $BF
 289+ 0000              DMA_REINIT_STATUS_BYTE		equ $8B
 290+ 0000              DMA_START_READ_SEQUENCE		equ $A7
 291+ 0000              DMA_FORCE_READY				equ $B3
 292+ 0000              DMA_DISABLE					equ $83
 293+ 0000              DMA_ENABLE					equ $87
 294+ 0000              DMA_READ_MASK_FOLLOWS		equ $BB
 295+ 0000
 296+ 0000              ; About UART<->ESP baund rate from AA:
 297+ 0000              ;
 298+ 0000              ; It's very easy to compute the prescalar.
 299+ 0000              ; 1. Read nextreg 0x11 to find out the video timing the system is using 0-7
 300+ 0000              ; 2. Take the associated actual system clock from this table:define(__CLK_28_0', 28000000)
 301+ 0000              ; define(CLK_28_1', 28571429)
 302+ 0000              ; define(`CLK_28_2', 29464286)
 303+ 0000              ; define(__CLK_28_3', 30000000)
 304+ 0000              ; define(CLK_28_4', 31000000)
 305+ 0000              ; define(`CLK_28_5', 32000000)
 306+ 0000              ; define(__CLK_28_6', 33000000)
 307+ 0000              ; define(__CLK_28_7', 27000000)
 308+ 0000              ; 3. Divide the clock by the baud rate you want to find the 14-bit prescalar value.
 309+ 0000              ; That's it.
 310+ 0000
# file closed: constants.i.asm
  96  0000              ;-----------------------------------------------------------------------------
  97  0000              ;-- ESX DOS functions
  98  0000              M_DOSVERSION                    equ $88
  99  0000              M_GETSETDRV                     equ $89     ; get current drive (or use A='*'/'$' for current/system drive!)
 100  0000              M_GETHANDLE                     equ $8D     ; get file handle of current dot command
 101  0000              M_GETERR                        equ $93
 102  0000              F_OPEN                          equ $9A
 103  0000              F_CLOSE                         equ $9B
 104  0000              F_READ                          equ $9D
 105  0000              F_WRITE                         equ $9E
 106  0000              F_SEEK                          equ $9F
 107  0000              F_FGETPOS                       equ $A0
 108  0000              F_UNLINK                        equ $AD
 109  0000              F_RENAME                        equ $B0
 110  0000              FA_READ                         equ $01
 111  0000              ;; helper macros
 112  0000              ESXDOS      MACRO service?
 112  0000 ~              push hl
 112  0000 ~              pop ix
 112  0000 ~              rst $08
 112  0000 ~              db service?
 112  0000                ENDM    ; copies HL into IX
 113  0000              NEXTREG2A   MACRO nextreg?
 113  0000 ~              ld a,nextreg?
 113  0000 ~              call readNextReg2A
 113  0000                ENDM
 114  0000              CSP_BREAK   MACRO
 114  0000 ~              IFDEF TESTING
 114  0000 ~              break
 114  0000 ~              ENDIF
 114  0000                ENDM
 115  0000                  ;; reserved space for values (but not initialized, i.e. not part of the binary)
 116  0000                  ; actually in DISPLAYEDGE tool these re-use the same memory area where font was stored
 117  0000                  ; (turned out the DS/BLOCK does overwrite device memory always, so I'm reserving space
 118  0000                  ; here ahead of the real machine code is produced, the real code will later overwrite
 119  0000                  ; the memory as desired)
 120  0000                          ORG tilemapFont_char24
 121  9EC1              ;EsxErrorBuffer:     DS      34
 122  9EC1              ;ReadMarginsArray:   DS      dspedge.S_MARGINS * dspedge.MODE_COUNT
 123  9EC1                  ; parsing/writing buffers has to be 256B-aligned
 124  9EC1               ;   ALIGN   256
 125  9EC1              ; ParsingBuffer:      DS      256
 126  9EC1              ; WritingBuffer:      DS      256
 127  9EC1              ; WritingBuffer2:     DS      256
 128  9EC1              ; BackupFilename:     DS      256
 129  9EC1              ;lastReserved:   ASSERT  lastReserved < $3D00 && last < $3D00
 130  9EC1                          org $8000
 131  8000
 132  8000
 133  8000              CHARS         equ  15616-256
 134  8000              mystak        equ  24575         ;ar bi trary value picked to be be low
 135  8000                                              ;BFE0h and above 4000h
 136  8000              staksto       equ  24575         ;some where to put BA SIC's stack
 137  8000                                              ;pointer
 138  8000
 139  8000                                              ;last value out put to 7FFDh
 140  8000              port1         equ  #7FFD         ;ad dress of ROM/RAM switch ing port
 141  8000                                              ;in I/O map
 142  8000              catbuff       equ  #A000         ;some where for DOS to put its catalog
 143  8000              dos_catalog   equ  #011E         ;the DOS routine to call
 144  8000 00 00 00...  filename 	  ds   15
 145  800F              typ 		  equ $-4
 146  800F              pocetpolozek	equ 200
 147  800F 00           virtmem		defb 0
 148  8010              maxlen		equ 261
 149  8010              maxline equ 37
 150  8010 00 00        save_allfiles	defw 0
 151  8012 00           OKNO 	defb 0
 152  8013
 153  8013 42 41        KURZL	defw $4002+160*2		;adresa kurzoru levého okna
 154  8015 92 41        KURZR	defw $4002+160*2+80		;adresa kurzoru pravého okna
 155  8017
 156  8017 00           POSKURZL	defb 0				;pozice kurzoru v levém okně
 157  8018 00           POSKURZR	defb 0				;pozice kurzoru v pravém okně
 158  8019
 159  8019 00 00        ALLPOSL		defw 0				;celková pozice na souboru
 160  801B 00 00        ALLPOSR		defw 0
 161  801D
 162  801D 01 00        STARTWINL	defw 1				;pocatecni soubor na zacatku okna
 163  801F 01 00        STARTWINR	defw 1
 164  8021
 165  8021
 166  8021 25 80        pathl		defw PATHLEFT
 167  8023 2D 81        pathr       defw PATHRIGHT
 168  8025 43 3A FF     PATHLEFT	defb "C:",255
 169  8028 00 00 00...  			ds 261
 170  812D 43 3A FF     PATHRIGHT   defb "C:",255
 171  8130 00 00 00...  			ds 261
 172  8235 20 20 20 20  bottom		defb "                                                                                ",0
 172  8239 20 20 20 20
 172  823D 20 20 20 20
 172  8241 20 20 20 20
 172  8245 20 20 20 20
 172  8249 20 20 20 20
 172  824D 20 20 20 20
 172  8251 20 20 20 20
 172  8255 20 20 20 20
 172  8259 20 20 20 20
 172  825D 20 20 20 20
 172  8261 20 20 20 20
 172  8265 20 20 20 20
 172  8269 20 20 20 20
 172  826D 20 20 20 20
 172  8271 20 20 20 20
 172  8275 20 20 20 20
 172  8279 20 20 20 20
 172  827D 20 20 20 20
 172  8281 20 20 20 20
 172  8285 00
 173  8286              start
 174  8286 3E 03        		ld a,3
 175  8288 32 12 80     		ld (OKNO),a
 176  828B 3E 01        		ld a,1
 177  828D D3 FE        		out (254),a
 178  828F ED 91 53 0B          nextreg MMU3_6000_NR_53,5*2+1
 179  8293 21 00 60             ld      hl,$6000
 180  8296 11 01 60             ld      de,$6000+1
 181  8299 01 FF 01             ld      bc,16*32-1
 182  829C 36 00                ld      (hl),0
 183  829E ED B0                ldir
 184  82A0 21 00 60     		ld hl,$6000
 185  82A3 11 01 60     		ld de,$6001
 186  82A6 01 00 02     		ld bc,32*16
 187  82A9 75           		ld (hl),l
 188  82AA ED B0        		ldir
 189  82AC 11 00 64     		ld		de,$6000 + 32*32
 190  82AF
 191  82AF                 ; convert ROM font to 4bpp tiles by code
 192  82AF 21 00 3D             ld      hl,MEM_ROM_CHARS_3C00 + 32*8
 193  82B2 06 60                ld      b,128-' '
 194  82B4              .RomCharsLoop
 195  82B4 CD C4 93             call    ConvertRomCharTo4bpp
 196  82B7 10 FB                djnz    .RomCharsLoop
 197  82B9
 198  82B9 21 C1 9E     		ld hl,specialchar
 199  82BC 11 00 62     		ld de,$6000+32*16
 200  82BF 01 00 01     		ld bc,specialchar2-specialchar
 201  82C2
 202  82C2 ED B0        		ldir
 203  82C4
 204  82C4 ED 91 07 03          nextreg TURBO_CONTROL_NR_07,3               ; 28Mhz mode
 205  82C8 ED 91 15 10          nextreg SPRITE_CONTROL_NR_15,%000'100'00    ; layer priority: USL
 206  82CC ED 91 4A 00          nextreg TRANSPARENCY_FALLBACK_COL_NR_4A,0   ; black transparency fallback color
 207  82D0 ED 91 4C 0F          nextreg TILEMAP_TRANSPARENCY_I_NR_4C,$0F
 208  82D4 ED 91 68 80          nextreg ULA_CONTROL_NR_68,$80               ; disable ULA layer
 209  82D8 ED 91 69 00          nextreg DISPLAY_CONTROL_NR_69,0             ; layer2 off, bank 5, timex=0
 210  82DC ED 91 6B C3          nextreg TILEMAP_CONTROL_NR_6B,%1100'0011    ; 80x32x2, 4bpp, pal0, 512tile-mode, force tile-over-ULA
 211  82E0 ED 91 6C 00          nextreg TILEMAP_DEFAULT_ATTR_NR_6C,$00      ; no pal offset, no mirror/rot, 0 bit8
 212  82E4 ED 91 6E 40          nextreg TILEMAP_BASE_ADR_NR_6E,high $4000
 213  82E8 ED 91 6F 60          nextreg TILEMAP_GFX_ADR_NR_6F,high $6000
 214  82EC ED 91 1C 08          nextreg CLIP_WINDOW_CONTROL_NR_1C,%0000'1000
 215  82F0 ED 91 1B 00          nextreg CLIP_TILEMAP_NR_1B,0
 216  82F4 ED 91 1B 9F          nextreg CLIP_TILEMAP_NR_1B,159
 217  82F8 ED 91 1B 00          nextreg CLIP_TILEMAP_NR_1B,0
 218  82FC ED 91 1B FF          nextreg CLIP_TILEMAP_NR_1B,255
 219  8300 ED 91 2F 00          nextreg TILEMAP_XOFFSET_MSB_NR_2F,0
 220  8304 ED 91 30 00          nextreg TILEMAP_XOFFSET_LSB_NR_30,0
 221  8308 ED 91 31 00          nextreg TILEMAP_YOFFSET_NR_31,0
 222  830C
 223  830C
 224  830C              		; set tilemap palette
 225  830C ED 91 43 30          nextreg PALETTE_CONTROL_NR_43,%0'011'0000   ; tilemap pal0
 226  8310 ED 91 40 00          nextreg PALETTE_INDEX_NR_40,0
 227  8314
 228  8314 21 01 9C             ld      hl,tilemapPalette
 229  8317 06 C0                ld      b,tilemapPalette_SZ
 230  8319              .setPalLoop:
 231  8319 7E                   ld      a,(hl)
 232  831A 23                   inc     hl
 233  831B ED 92 44             nextreg PALETTE_VALUE_9BIT_NR_44,a
 234  831E 10 F9                djnz    .setPalLoop
 235  8320 21 00 40     		ld hl,$4000
 236  8323 11 01 40     		ld de,$4001
 237  8326 01 00 14     		ld bc,80*32*2
 238  8329 36 00        		ld (hl),0
 239  832B ED B0        		ldir
 240  832D 21 80 8E     		ld hl,text
 241  8330 11 00 40     		ld de,#4000
 242  8333 01 50 00     		ld bc,80
 243  8336              menu0
 244  8336 7E           		ld a,(hl)
 245  8337 12           		ld (de),a
 246  8338 13           		inc de
 247  8339 3E 10        		ld a,16
 248  833B 12           		ld (de),a
 249  833C 13           		inc de
 250  833D 23           		inc hl
 251  833E 0B           		dec bc
 252  833F 79           		ld a,c
 253  8340 B0           		or b
 254  8341 20 F3        		jr nz,menu0
 255  8343 CD D1 96     		call kresli		;NAKRESLI HLAVNI OBRAZOVKU
 256  8346
 257  8346              STOP
 258  8346 CD 58 98     		call reload_dir
 259  8349
 260  8349 21 02 40     		ld hl,$4000+2
 261  834C 22 46 94     		ld (adrs+1),hl
 262  834F
 263  834F CD F6 90     		call getroot
 264  8352
 265  8352 CD EB 93     		call showwin
 266  8355
 267  8355 3A 12 80     		ld a,(OKNO)
 268  8358 EE 10        		xor 16
 269  835A 32 12 80     		ld (OKNO),a
 270  835D
 271  835D CD 58 98     		call reload_dir
 272  8360
 273  8360 21 52 40     		ld hl,$4000+2+80
 274  8363 22 46 94     		ld (adrs+1),hl
 275  8366 CD 75 91     		call getroot_reload
 276  8369 CD EB 93     		call showwin
 277  836C 3A 12 80     		ld a,(OKNO)
 278  836F EE 10        		xor 16
 279  8371 32 12 80     		ld (OKNO),a
 280  8374              III
 281  8374 3E 20        		ld a,32
 282  8376 CD 8C 93     		call writecur
 283  8379 3E 10        		ld a,16
 284  837B 11 35 82     		ld de,bottom
 285  837E 21 1F 00     		ld hl,0*256+31
 286  8381 CD 97 97     		call print
 287  8384
 288  8384              loop0
 289  8384 21 37 48     		ld   hl,$4000+160*13+23
 290  8387 22 B5 84     		ld (PROGS+1),hl
 291  838A
 292  838A CD 1F 8D     		call gettime
 293  838D ED 91 56 14  		nextreg $56,20
 294  8391
 295  8391
 296  8391
 297  8391 21 1F 01     		ld hl,1*256+31
 298  8394 3E 10        		ld a,16
 299  8396 11 03 84     		ld de,seltxt
 300  8399 CD 97 97     		call print
 301  839C
 302  839C 21 1F 29     		ld hl,41*256+31
 303  839F 3E 10        		ld a,16
 304  83A1 11 03 84     		ld de,seltxt
 305  83A4 CD 97 97     		call print
 306  83A7
 307  83A7
 308  83A7 2A FF 83     		ld hl,(numsel)
 309  83AA CD 2A 91     		call NUM
 310  83AD 21 1F 0B     		ld hl,11*256+31
 311  83B0 3E 10        		ld a,16
 312  83B2 11 21 91     		ld de,NUMBUF
 313  83B5 CD 97 97     		call print
 314  83B8
 315  83B8 2A 01 84     		ld hl,(numsel+2)
 316  83BB CD 2A 91     		call NUM
 317  83BE 21 1F 33     		ld hl,51*256+31
 318  83C1 3E 10        		ld a,16
 319  83C3 11 21 91     		ld de,NUMBUF
 320  83C6 CD 97 97     		call print
 321  83C9              ;*******************************
 322  83C9
 323  83C9              		; ld a,(POSKURZL)
 324  83C9              		; ld l,a
 325  83C9              		; ld h,0
 326  83C9              		; call NUM
 327  83C9              		; ld hl,1*256+31
 328  83C9              		; ld a,16
 329  83C9              		; ld de,NUMBUF
 330  83C9              		; call print
 331  83C9
 332  83C9              		; ld hl,(STARTWINL)
 333  83C9              		; call NUM
 334  83C9              		; ld hl,9*256+31
 335  83C9              		; ld a,16
 336  83C9              		; ld de,NUMBUF
 337  83C9              		; call print
 338  83C9
 339  83C9              		; ld a,(POSKURZL)
 340  83C9              		; ld l,a
 341  83C9              		; ld h,0
 342  83C9              		; ex de,hl
 343  83C9              		; ld hl,(STARTWINL)
 344  83C9              		; add hl,de
 345  83C9              		; inc hl
 346  83C9              		; call find83
 347  83C9              		; xor a
 348  83C9              		; ld (TMP83+11),a
 349  83C9              		; ld hl,20*256+31
 350  83C9              		; ld a,16
 351  83C9              		; ld de,TMP83
 352  83C9
 353  83C9              		; call print
 354  83C9
 355  83C9              		; ld a,(POSKURZR)
 356  83C9              		; ld l,a
 357  83C9              		; ld h,0
 358  83C9              		; call NUM
 359  83C9              		; ld hl,41*256+31
 360  83C9              		; ld a,16
 361  83C9              		; ld de,NUMBUF
 362  83C9              		; call print
 363  83C9
 364  83C9              		; ld hl,(STARTWINR)
 365  83C9              		; call NUM
 366  83C9              		; ld hl,49*256+31
 367  83C9              		; ld a,16
 368  83C9              		; ld de,NUMBUF
 369  83C9              		; call print
 370  83C9
 371  83C9              		; ld a,(POSKURZR)
 372  83C9              		; ld l,a
 373  83C9              		; ld h,0
 374  83C9              		; ex de,hl
 375  83C9              		; ld hl,(STARTWINR)
 376  83C9              		; add hl,de
 377  83C9              		; inc hl
 378  83C9              		; call find83
 379  83C9              		; xor a
 380  83C9              		; ld (TMP83+11),a
 381  83C9              		; ld hl,60*256+31
 382  83C9              		; ld a,16
 383  83C9              		; ld de,TMP83
 384  83C9
 385  83C9              		; call print
 386  83C9
 387  83C9              ;*******************************
 388  83C9
 389  83C9
 390  83C9
 391  83C9 CD 05 95     		call INKEY
 392  83CC
 393  83CC 32 89 93     		ld (klavesa),a
 394  83CF
 395  83CF FE 7F        		cp ''
 396  83D1 CC 00 96     		call z,info
 397  83D4 FE 0A        		cp 10
 398  83D6 CA 0E 92     		jp z,down
 399  83D9 FE 0B        		cp 11
 400  83DB CA EC 92     		jp z,up
 401  83DE FE 04        		cp 4		;true video
 402  83E0
 403  83E0 CA BD 91     		jp z,changewin
 404  83E3 FE 0D        		cp 13
 405  83E5 CA 0F 90     		jp z,enter
 406  83E8 FE 38        		cp "8"
 407  83EA CA 93 86     		jp z,delete
 408  83ED FE 30        		cp "0"
 409  83EF CA 48 8D     		jp z,menu
 410  83F2 FE 35        		cp "5"
 411  83F4 CA 77 88     		jp z,copy
 412  83F7 FE 20        		cp 32
 413  83F9 CA 0E 84     		jp z,select
 414  83FC
 415  83FC C3 84 83     		jp loop0
 416  83FF
 417  83FF 00 00 00 00  numsel	defw 0,0
 418  8403 53 65 6C 65  seltxt defb "Selected: ",0
 418  8407 63 74 65 64
 418  840B 3A 20 00
 419  840E              select
 420  840E 21 17 80     		ld hl,POSKURZL
 421  8411 CD B3 93     		call ROZHOD
 422  8414 7E           		ld a,(hl)
 423  8415 6F           		ld l,a
 424  8416 26 00        		ld h,0
 425  8418
 426  8418 E5           		push hl
 427  8419 21 1D 80     		ld hl,STARTWINL
 428  841C CD BB 93     		call ROZHOD2
 429  841F 7E           		ld a,(hl)
 430  8420 23           		inc hl
 431  8421 66           		ld h,(hl)
 432  8422 6F           		ld l,a
 433  8423
 434  8423 EB           		ex de,hl
 435  8424 E1           		pop hl
 436  8425 19           		add hl,de
 437  8426 23           		inc hl				;v HL máme číslo souboru
 438  8427 CD AC 9A     		call BUFF83
 439  842A CD DB 94     		call find83
 440  842D CD AC 9A     		call BUFF83
 441  8430 2A F6 94     		ld hl,(foundfile)
 442  8433              SEL
 443  8433 CB 7E        		bit 7,(hl)
 444  8435 28 15        		jr z,select_file
 445  8437 CB BE        		res 7,(hl)
 446  8439
 447  8439 21 FF 83     		ld hl,numsel
 448  843C CD BB 93     		call ROZHOD2
 449  843F E5           		push hl
 450  8440 7E           		ld a,(hl)
 451  8441 23           		inc hl
 452  8442 66           		ld h,(hl)
 453  8443 6F           		ld l,a
 454  8444 D1           		pop de
 455  8445 2B           		dec hl
 456  8446 EB           		ex de,hl
 457  8447 73           		ld (hl),e
 458  8448 23           		inc hl
 459  8449 72           		ld (hl),d
 460  844A
 461  844A 18 13        		jr deselect_file
 462  844C              select_file
 463  844C CB FE        		set 7,(hl)			;označ soubor
 464  844E 21 FF 83     		ld hl,numsel
 465  8451 CD BB 93     		call ROZHOD2
 466  8454 E5           		push hl
 467  8455 7E           		ld a,(hl)
 468  8456 23           		inc hl
 469  8457 66           		ld h,(hl)
 470  8458 6F           		ld l,a
 471  8459 D1           		pop de
 472  845A 23           		inc hl
 473  845B EB           		ex de,hl
 474  845C 73           		ld (hl),e
 475  845D 23           		inc hl
 476  845E 72           		ld (hl),d
 477  845F
 478  845F              deselect_file
 479  845F
 480  845F              selcont
 481  845F 21 B9 91     		ld hl,adrl
 482  8462 CD BB 93     		call ROZHOD2
 483  8465 7E           		ld a,(hl)
 484  8466 23           		inc hl
 485  8467 66           		ld h,(hl)
 486  8468 6F           		ld l,a
 487  8469 22 46 94     		ld (adrs+1),hl
 488  846C
 489  846C CD F6 90     		call getroot
 490  846F
 491  846F CD EB 93     		call showwin
 492  8472
 493  8472 C3 0E 92     		jp down
 494  8475
 495  8475
 496  8475              					; CPPX1    ld   de,0
 497  8475              							 ; or   a
 498  8475              							 ; sbc  hl,de
 499  8475              							 ; jr   c,CPPNE1
 500  8475              					; CPPX3    ld   b,1
 501  8475              							 ; ld   (PROGPROM),hl
 502  8475              							 ; call PROGRES
 503  8475              					; CPPNE1
 504  8475
 505  8475 00 00        PROGPROM	defw 0
 506  8477 00 00        PROGPROM2	defw 0
 507  8479
 508  8479              ;Výpočet důležitý pro progress
 509  8479              ;Počet v registru DE
 510  8479              ;		Výstup HL na CPPX1
 511  8479              ;			   A na CPPX3
 512  8479              ;			   PROGRES vynulovat
 513  8479 62           PROVYP   ld   h,d
 514  847A 6B                    ld   l,e
 515  847B 7A                    ld   a,d
 516  847C B7                    or   a
 517  847D 20 05                 jr   nz,PROV3
 518  847F 7B                    ld   a,e
 519  8480 FE 09                 cp   9
 520  8482 38 1B                 jr   c,PROV4
 521  8484 AF           PROV3    xor  a
 522  8485 CB 3C                 srl  h
 523  8487 CB 1D                 rr   l
 524  8489 1F                    rra
 525  848A CB 3C                 srl  h
 526  848C CB 1D                 rr   l
 527  848E 1F                    rra
 528  848F CB 3C                 srl  h
 529  8491 CB 1D                 rr   l
 530  8493 1F                    rra
 531  8494 CB 3C                 srl  h
 532  8496 CB 1D                 rr   l
 533  8498 1F                    rra
 534  8499 B7                    or   a
 535  849A
 536  849A 3E 01                 ld   a,1
 537  849C
 538  849C C8           		 ret  z
 539  849D 23                    inc  hl
 540  849E C9                    ret
 541  849F
 542  849F 21 A9 84     PROV4    ld   hl,TABPRO
 543  84A2 1B                    dec  de
 544  84A3 19                    add  hl,de
 545  84A4 7E                    ld   a,(hl)
 546  84A5 21 01 00              ld   hl,1
 547  84A8
 548  84A8 C9                    ret
 549  84A9 10 08 05 04  TABPRO   db 16,8,5,4,3,2,2,2
 549  84AD 03 02 02 02
 550  84B1
 551  84B1 06 01        PRGRS1   ld   b,1
 552  84B3 E5           PROGRES  push hl
 553  84B4 21 39 48     PROGS    ld   hl,$4000+160*13+25
 554  84B7 3E 24                 ld   a,36		;barva teploměru
 555  84B9 77           PROGRSM1 ld   (hl),a
 556  84BA 23                    inc  hl
 557  84BB 23           		 inc  hl
 558  84BC 10 FB                 djnz PROGRSM1
 559  84BE 22 B5 84              ld   (PROGS+1),hl
 560  84C1 E1                    pop  hl
 561  84C2 C9                    ret
 562  84C3
 563  84C3 E5           PROGRES2 push hl
 564  84C4 21 D9 48     PROGS2   ld   hl,$4000+160*14+25
 565  84C7 3E 24                 ld   a,36		;barva teploměru
 566  84C9 77           PROGRSM12 ld   (hl),a
 567  84CA 23                    inc  hl
 568  84CB 23           		 inc  hl
 569  84CC 10 FB                 djnz PROGRSM12
 570  84CE 22 C5 84              ld   (PROGS2+1),hl
 571  84D1 E1                    pop  hl
 572  84D2 C9                    ret
 573  84D3
 574  84D3              clearpr
 575  84D3 21 D9 48     		ld   hl,$4000+160*14+25
 576  84D6 3E 10        		ld a,16
 577  84D8 06 28        		ld b,40
 578  84DA              clearpr2
 579  84DA 77           		ld (hl),a
 580  84DB 23           		inc hl
 581  84DC 23           		inc hl
 582  84DD 10 FB        		djnz clearpr2
 583  84DF C9           		ret
 584  84E0
 585  84E0              moredelete
 586  84E0
 587  84E0
 588  84E0 CD E6 91     		call savescr
 589  84E3
 590  84E3 21 0A 0A     		ld hl,10 * 256 + 10
 591  84E6 01 05 3C     		ld bc,60 * 256 + 5
 592  84E9 3E 10        		ld a,16
 593  84EB CD B7 97     		call window
 594  84EE
 595  84EE 21 0B 0B     		ld hl,11*256+11
 596  84F1 3E 10        		ld a,16
 597  84F3 11 C8 89     		ld de,moredeletetxt
 598  84F6 CD 97 97     		call print
 599  84F9
 600  84F9
 601  84F9
 602  84F9
 603  84F9 21 FF 83     		ld hl,numsel
 604  84FC CD BB 93     		call ROZHOD2
 605  84FF
 606  84FF 7E           		ld a,(hl)
 607  8500 23           		inc hl
 608  8501 66           		ld h,(hl)
 609  8502 6F           		ld l,a
 610  8503 E5           		push hl
 611  8504
 612  8504 EB           		ex de,hl
 613  8505
 614  8505 CD 79 84     		call PROVYP
 615  8508 87           		add a,a
 616  8509 22 47 8B     		ld   (CPPX1+1),hl
 617  850C 32 4F 8B             ld   (CPPX3+1),a
 618  850F 21 00 00             ld   hl,0
 619  8512 22 75 84             ld   (PROGPROM),hl
 620  8515
 621  8515 21 21 91     		ld hl,NUMBUF
 622  8518 11 22 91     		ld de,NUMBUF+1
 623  851B 01 05 00     		ld bc,5
 624  851E 3E 20        		ld a,32
 625  8520 77           		ld (hl),a
 626  8521 ED B0        		ldir
 627  8523 21 21 91     		ld hl,NUMBUF
 628  8526 AF           		xor a
 629  8527 32 24 91     		ld (NUMBUF+3),a
 630  852A 22 6C 91     		ld (numadr+1),hl
 631  852D E1           		pop hl
 632  852E CD 4C 91     		call DECIMAL3
 633  8531 21 0B 12     		ld hl,18*256+11
 634  8534 3E 10        		ld a,16
 635  8536 11 21 91     		ld de,NUMBUF
 636  8539 CD 97 97     		call print
 637  853C
 638  853C
 639  853C 21 0E 3C     		ld hl,60*256+14
 640  853F 3E 30        		ld a,48
 641  8541 11 1B 88     		ld de,yestxt
 642  8544 CD 97 97     		call print
 643  8547
 644  8547
 645  8547
 646  8547
 647  8547 21 0F 3C     		ld hl,60*256+15
 648  854A 3E 10        		ld a,16
 649  854C 11 27 88     		ld de,notxt
 650  854F CD 97 97     		call print
 651  8552              mdeletewait
 652  8552 CD 05 95     		call INKEY
 653  8555 FE 01        		cp 1
 654  8557 CA A8 89     		jp z,copyend
 655  855A FE 0D        		cp 13
 656  855C 28 02        		jr z,mdeletecont
 657  855E 18 F2        		jr mdeletewait
 658  8560
 659  8560              mdeletecont
 660  8560
 661  8560 21 FF 83     		ld hl,numsel
 662  8563 CD BB 93     		call ROZHOD2
 663  8566
 664  8566 7E           		ld a,(hl)
 665  8567 23           		inc hl
 666  8568 56           		ld d,(hl)
 667  8569 5F           		ld e,a
 668  856A
 669  856A CD 79 84     		call PROVYP
 670  856D 87           		add a,a
 671  856E 22 B1 85     		ld   (DPPX1+1),hl
 672  8571 32 B9 85             ld   (DPPX3+1),a
 673  8574 21 00 00             ld   hl,0
 674  8577 22 75 84             ld   (PROGPROM),hl
 675  857A
 676  857A 21 00 00     		ld hl,0
 677  857D
 678  857D              deletenext
 679  857D E5           		push hl
 680  857E CD DB 94     		call find83
 681  8581 CD AC 9A     		call BUFF83
 682  8584 2A F6 94     		ld hl,(foundfile)
 683  8587 CB 7E        		bit 7,(hl)
 684  8589 CA C0 85     		jp z,nemazat
 685  858C CB BE        		res 7,(hl)
 686  858E
 687  858E 06 0B        		ld b,11
 688  8590 21 F8 94     		ld hl,TMP83
 689  8593              ACCCAC							;vynuluj všechny stavové bity v názvu (7.)
 690  8593 CB BE        		res 7,(hl)
 691  8595 23           		inc hl
 692  8596 10 FB        		djnz ACCCAC
 693  8598 3E FF        		ld a,$ff
 694  859A 32 03 95     		ld (TMP83+11),a
 695  859D
 696  859D CD 58 99     		call dospage
 697  85A0
 698  85A0 21 F8 94     		ld hl,TMP83
 699  85A3 CD 24 01     		call $0124
 700  85A6
 701  85A6 CD 68 99     		call basicpage
 702  85A9              ;------------------------
 703  85A9
 704  85A9 2A 75 84     		ld   hl,(PROGPROM)
 705  85AC 23                   inc  hl
 706  85AD 22 75 84             ld   (PROGPROM),hl
 707  85B0 11 00 00     DPPX1    ld   de,0
 708  85B3 B7                    or   a
 709  85B4 ED 52                 sbc  hl,de
 710  85B6 38 08                 jr   c,DPPNE1
 711  85B8 06 01        DPPX3    ld   b,1
 712  85BA 22 75 84              ld   (PROGPROM),hl
 713  85BD CD B3 84              call PROGRES
 714  85C0              DPPNE1
 715  85C0
 716  85C0              nemazat
 717  85C0
 718  85C0 21 D1 9A     		ld hl,ALLFILES
 719  85C3 CD BB 93     		call ROZHOD2
 720  85C6 7E           		ld a,(hl)
 721  85C7 23           		inc hl
 722  85C8 56           		ld d,(hl)
 723  85C9 5F           		ld e,a
 724  85CA E1           		pop hl
 725  85CB B7           		or a
 726  85CC ED 52        		sbc hl,de
 727  85CE 19           		add hl,de
 728  85CF CA D6 85     		jp z,mmorekonec
 729  85D2 23           		inc hl
 730  85D3 C3 7D 85     		jp deletenext
 731  85D6
 732  85D6              mmorekonec
 733  85D6
 734  85D6 21 00 00     		ld hl,0
 735  85D9 21 D1 9A     		ld hl,ALLFILES
 736  85DC CD BB 93     		call ROZHOD2
 737  85DF AF           		xor a
 738  85E0 77           		ld (hl),a
 739  85E1 23           		inc hl
 740  85E2 77           		ld (hl),a
 741  85E3 21 17 80     		ld hl,POSKURZL
 742  85E6 CD B3 93     		call ROZHOD
 743  85E9 AF           		xor a
 744  85EA 77           		ld (hl),a
 745  85EB CD FA 91     		call loadscr
 746  85EE
 747  85EE 21 B5 91     		ld hl,pozicel
 748  85F1 CD BB 93     		call ROZHOD2
 749  85F4 7E           		ld a,(hl)
 750  85F5 23           		inc hl
 751  85F6 66           		ld h,(hl)
 752  85F7 6F           		ld l,a
 753  85F8
 754  85F8 01 1B 26     		ld bc,38 * 256 + 27
 755  85FB 3E 00        		ld a,0
 756  85FD CD B7 97     		call window
 757  8600
 758  8600
 759  8600 CD 58 98     		call reload_dir
 760  8603
 761  8603 21 B9 91     		ld hl,adrl
 762  8606 CD BB 93     		call ROZHOD2
 763  8609 7E           		ld a,(hl)
 764  860A 23           		inc hl
 765  860B 66           		ld h,(hl)
 766  860C 6F           		ld l,a
 767  860D 22 46 94     		ld (adrs+1),hl
 768  8610 CD 75 91     		call getroot_reload
 769  8613 CD EB 93     		call showwin
 770  8616 3E 20        		ld a,32
 771  8618 CD 8C 93     		call writecur
 772  861B
 773  861B
 774  861B              ;---------------------------
 775  861B 3A 12 80     		ld a,(OKNO)
 776  861E EE 10        		xor 16
 777  8620 32 12 80     		ld (OKNO),a
 778  8623
 779  8623 CD 58 99     		call dospage
 780  8626 21 21 80     		ld hl,pathl
 781  8629 CD BB 93     		call ROZHOD2
 782  862C 7E           		ld a,(hl)
 783  862D 23           		inc hl
 784  862E 66           		ld h,(hl)
 785  862F 6F           		ld l,a
 786  8630
 787  8630 AF           		xor a
 788  8631 CD B1 01     		call $01b1
 789  8634 CD 68 99     		call basicpage
 790  8637
 791  8637 21 00 00     		ld hl,0
 792  863A 21 D1 9A     		ld hl,ALLFILES
 793  863D CD BB 93     		call ROZHOD2
 794  8640 AF           		xor a
 795  8641 77           		ld (hl),a
 796  8642 23           		inc hl
 797  8643 77           		ld (hl),a
 798  8644 21 17 80     		ld hl,POSKURZL
 799  8647 CD B3 93     		call ROZHOD
 800  864A AF           		xor a
 801  864B 77           		ld (hl),a
 802  864C              		;call loadscr
 803  864C
 804  864C 21 B5 91     		ld hl,pozicel
 805  864F CD BB 93     		call ROZHOD2
 806  8652 7E           		ld a,(hl)
 807  8653 23           		inc hl
 808  8654 66           		ld h,(hl)
 809  8655 6F           		ld l,a
 810  8656
 811  8656 01 1B 26     		ld bc,38 * 256 + 27
 812  8659 3E 00        		ld a,0
 813  865B CD B7 97     		call window
 814  865E
 815  865E
 816  865E CD 58 98     		call reload_dir
 817  8661
 818  8661 21 B9 91     		ld hl,adrl
 819  8664 CD BB 93     		call ROZHOD2
 820  8667 7E           		ld a,(hl)
 821  8668 23           		inc hl
 822  8669 66           		ld h,(hl)
 823  866A 6F           		ld l,a
 824  866B 22 46 94     		ld (adrs+1),hl
 825  866E CD 75 91     		call getroot_reload
 826  8671 CD EB 93     		call showwin
 827  8674 3A 12 80     		ld a,(OKNO)
 828  8677 EE 10        		xor 16
 829  8679 32 12 80     		ld (OKNO),a
 830  867C
 831  867C CD 58 99     		call dospage
 832  867F 21 21 80     		ld hl,pathl
 833  8682 CD BB 93     		call ROZHOD2
 834  8685 7E           		ld a,(hl)
 835  8686 23           		inc hl
 836  8687 66           		ld h,(hl)
 837  8688 6F           		ld l,a
 838  8689
 839  8689 AF           		xor a
 840  868A CD B1 01     		call $01b1
 841  868D CD 68 99     		call basicpage
 842  8690 C3 84 83     		jp loop0
 843  8693
 844  8693
 845  8693
 846  8693              delete
 847  8693 21 FF 83     		ld hl,numsel
 848  8696 CD BB 93     		call ROZHOD2
 849  8699 7E           		ld a,(hl)
 850  869A 23           		inc hl
 851  869B 66           		ld h,(hl)
 852  869C 6F           		ld l,a
 853  869D B4           		or h
 854  869E C2 E0 84     		jp nz,moredelete
 855  86A1
 856  86A1 CD E6 91     		call savescr
 857  86A4 21 0A 0A     		ld hl,10 * 256 + 10
 858  86A7 01 05 3C     		ld bc,60 * 256 + 5
 859  86AA 3E 10        		ld a,16
 860  86AC CD B7 97     		call window
 861  86AF
 862  86AF 21 0B 0B     		ld hl,11*256+11
 863  86B2 3E 10        		ld a,16
 864  86B4 11 0D 88     		ld de,onedeletetxt
 865  86B7 CD 97 97     		call print
 866  86BA
 867  86BA 21 17 80     		ld hl,POSKURZL
 868  86BD CD B3 93     		call ROZHOD
 869  86C0 7E           		ld a,(hl)
 870  86C1 6F           		ld l,a
 871  86C2 26 00        		ld h,0
 872  86C4
 873  86C4 E5           		push hl
 874  86C5 21 1D 80     		ld hl,STARTWINL
 875  86C8 CD BB 93     		call ROZHOD2
 876  86CB 7E           		ld a,(hl)
 877  86CC 23           		inc hl
 878  86CD 66           		ld h,(hl)
 879  86CE 6F           		ld l,a
 880  86CF
 881  86CF EB           		ex de,hl
 882  86D0 E1           		pop hl
 883  86D1 19           		add hl,de
 884  86D2 E5           		push hl
 885  86D3 23           		inc hl
 886  86D4 CD DB 94     		call find83
 887  86D7 E1           		pop hl
 888  86D8 CD 37 9A     		call FINDLFN
 889  86DB
 890  86DB
 891  86DB
 892  86DB
 893  86DB 21 D7 9A     		ld hl,LFNNAME
 894  86DE 11 49 88     		ld de,bfname
 895  86E1 01 2D 00     		ld bc,45
 896  86E4 ED B0        		ldir
 897  86E6
 898  86E6 21 0B 18     		ld hl,24*256+11
 899  86E9 3E 10        		ld a,16
 900  86EB 11 49 88     		ld de,bfname
 901  86EE CD 97 97     		call print
 902  86F1
 903  86F1 21 0E 3C     		ld hl,60*256+14
 904  86F4 3E 30        		ld a,48
 905  86F6 11 1B 88     		ld de,yestxt
 906  86F9 CD 97 97     		call print
 907  86FC
 908  86FC
 909  86FC
 910  86FC
 911  86FC 21 0F 3C     		ld hl,60*256+15
 912  86FF 3E 10        		ld a,16
 913  8701 11 27 88     		ld de,notxt
 914  8704 CD 97 97     		call print
 915  8707              deletewait
 916  8707 CD 05 95     		call INKEY
 917  870A FE 01        		cp 1
 918  870C CA A8 89     		jp z,copyend
 919  870F FE 0D        		cp 13
 920  8711 28 02        		jr z,deletecont
 921  8713 18 F2        		jr deletewait
 922  8715
 923  8715              deletecont
 924  8715
 925  8715 06 0B        		ld b,11
 926  8717 21 F8 94     		ld hl,TMP83
 927  871A              CCCAC							;vynuluj všechny stavové bity v názvu (7.)
 928  871A CB BE        		res 7,(hl)
 929  871C 23           		inc hl
 930  871D 10 FB        		djnz CCCAC
 931  871F 3E FF        		ld a,$ff
 932  8721 32 03 95     		ld (TMP83+11),a
 933  8724
 934  8724 CD 58 99     		call dospage
 935  8727
 936  8727 21 F8 94     		ld hl,TMP83
 937  872A CD 24 01     		call $0124
 938  872D
 939  872D CD 68 99     		call basicpage
 940  8730              ;------------------------
 941  8730              KON
 942  8730
 943  8730 21 00 00     		ld hl,0
 944  8733 21 D1 9A     		ld hl,ALLFILES
 945  8736 CD BB 93     		call ROZHOD2
 946  8739 AF           		xor a
 947  873A 77           		ld (hl),a
 948  873B 23           		inc hl
 949  873C 77           		ld (hl),a
 950  873D 21 17 80     		ld hl,POSKURZL
 951  8740 CD B3 93     		call ROZHOD
 952  8743 AF           		xor a
 953  8744 77           		ld (hl),a
 954  8745
 955  8745 CD 58 99     		call dospage
 956  8748 21 21 80     		ld hl,pathl
 957  874B CD BB 93     		call ROZHOD2
 958  874E 7E           		ld a,(hl)
 959  874F 23           		inc hl
 960  8750 66           		ld h,(hl)
 961  8751 6F           		ld l,a
 962  8752
 963  8752 AF           		xor a
 964  8753 CD B1 01     		call $01b1
 965  8756 CD 68 99     		call basicpage
 966  8759
 967  8759 CD 58 98     		call reload_dir
 968  875C CD FA 91     		call loadscr
 969  875F
 970  875F 21 B5 91     		ld hl,pozicel
 971  8762 CD BB 93     		call ROZHOD2
 972  8765 7E           		ld a,(hl)
 973  8766 23           		inc hl
 974  8767 66           		ld h,(hl)
 975  8768 6F           		ld l,a
 976  8769
 977  8769 01 1B 26     		ld bc,38 * 256 + 27
 978  876C 3E 00        		ld a,0
 979  876E CD B7 97     		call window
 980  8771
 981  8771
 982  8771 21 B9 91     		ld hl,adrl
 983  8774 CD BB 93     		call ROZHOD2
 984  8777 7E           		ld a,(hl)
 985  8778 23           		inc hl
 986  8779 66           		ld h,(hl)
 987  877A 6F           		ld l,a
 988  877B 22 46 94     		ld (adrs+1),hl
 989  877E CD 75 91     		call getroot_reload
 990  8781 CD EB 93     		call showwin
 991  8784 3E 20        		ld a,32
 992  8786 CD 8C 93     		call writecur
 993  8789              ;---------------------------
 994  8789 3A 12 80     		ld a,(OKNO)
 995  878C EE 10        		xor 16
 996  878E 32 12 80     		ld (OKNO),a
 997  8791
 998  8791 CD 58 99     		call dospage
 999  8794 21 21 80     		ld hl,pathl
1000  8797 CD BB 93     		call ROZHOD2
1001  879A 7E           		ld a,(hl)
1002  879B 23           		inc hl
1003  879C 66           		ld h,(hl)
1004  879D 6F           		ld l,a
1005  879E
1006  879E AF           		xor a
1007  879F CD B1 01     		call $01b1
1008  87A2 CD 68 99     		call basicpage
1009  87A5
1010  87A5 21 00 00     		ld hl,0
1011  87A8 21 D1 9A     		ld hl,ALLFILES
1012  87AB CD BB 93     		call ROZHOD2
1013  87AE AF           		xor a
1014  87AF 77           		ld (hl),a
1015  87B0 23           		inc hl
1016  87B1 77           		ld (hl),a
1017  87B2 21 17 80     		ld hl,POSKURZL
1018  87B5 CD B3 93     		call ROZHOD
1019  87B8 AF           		xor a
1020  87B9 77           		ld (hl),a
1021  87BA              		;call loadscr
1022  87BA
1023  87BA 21 B5 91     		ld hl,pozicel
1024  87BD CD BB 93     		call ROZHOD2
1025  87C0 7E           		ld a,(hl)
1026  87C1 23           		inc hl
1027  87C2 66           		ld h,(hl)
1028  87C3 6F           		ld l,a
1029  87C4
1030  87C4 01 1B 26     		ld bc,38 * 256 + 27
1031  87C7 3E 00        		ld a,0
1032  87C9 CD B7 97     		call window
1033  87CC
1034  87CC
1035  87CC CD 58 98     		call reload_dir
1036  87CF
1037  87CF 21 B9 91     		ld hl,adrl
1038  87D2 CD BB 93     		call ROZHOD2
1039  87D5 7E           		ld a,(hl)
1040  87D6 23           		inc hl
1041  87D7 66           		ld h,(hl)
1042  87D8 6F           		ld l,a
1043  87D9 22 46 94     		ld (adrs+1),hl
1044  87DC CD 75 91     		call getroot_reload
1045  87DF CD EB 93     		call showwin
1046  87E2 3A 12 80     	ld a,(OKNO)
1047  87E5 EE 10        		xor 16
1048  87E7 32 12 80     		ld (OKNO),a
1049  87EA
1050  87EA CD 58 99     		call dospage
1051  87ED 21 21 80     		ld hl,pathl
1052  87F0 CD BB 93     		call ROZHOD2
1053  87F3 7E           		ld a,(hl)
1054  87F4 23           		inc hl
1055  87F5 66           		ld h,(hl)
1056  87F6 6F           		ld l,a
1057  87F7
1058  87F7 AF           		xor a
1059  87F8 CD B1 01     		call $01b1
1060  87FB CD 68 99     		call basicpage
1061  87FE
1062  87FE C3 84 83     		jp loop0
1063  8801
1064  8801
1065  8801
1066  8801              blocklenght	equ 1024*6
1067  8801
1068  8801 43 6F 70 79  onecopytxt 	defb "Copy file: ",0
1068  8805 20 66 69 6C
1068  8809 65 3A 20 00
1069  880D 44 65 6C 65  onedeletetxt 	defb "Delete file: ",0
1069  8811 74 65 20 66
1069  8815 69 6C 65 3A
1069  8819 20 00
1070  881B 45 4E 54 45  yestxt		defb "ENTER = yes",0
1070  881F 52 20 3D 20
1070  8823 79 65 73 00
1071  8827 42 52 45 41  notxt 		defb "BREAK = no",0
1071  882B 4B 20 3D 20
1071  882F 6E 6F 00
1072  8832 20 20 20 20  spaces 		defb "          ",0
1072  8836 20 20 20 20
1072  883A 20 20 00
1073  883D 50 6C 61 73  pleasewait	defb "Plase wait ",0
1073  8841 65 20 77 61
1073  8845 69 74 20 00
1074  8849 00 00 00...  bfname		defs 45
1075  8876 00           			defb 0
1076  8877              copy
1077  8877 21 FF 83     		ld hl,numsel
1078  887A CD BB 93     		call ROZHOD2
1079  887D 7E           		ld a,(hl)
1080  887E 23           		inc hl
1081  887F 66           		ld h,(hl)
1082  8880 6F           		ld l,a
1083  8881 B4           		or h
1084  8882 C2 F9 89     		jp nz,morecopy
1085  8885
1086  8885
1087  8885
1088  8885 CD E6 91     		call savescr
1089  8888 21 0A 0A     		ld hl,10 * 256 + 10
1090  888B 01 05 3C     		ld bc,60 * 256 + 5
1091  888E 3E 10        		ld a,16
1092  8890 CD B7 97     		call window
1093  8893
1094  8893 21 0B 0B     		ld hl,11*256+11
1095  8896 3E 10        		ld a,16
1096  8898 11 01 88     		ld de,onecopytxt
1097  889B CD 97 97     		call print
1098  889E
1099  889E 21 17 80     		ld hl,POSKURZL
1100  88A1 CD B3 93     		call ROZHOD
1101  88A4 7E           		ld a,(hl)
1102  88A5 6F           		ld l,a
1103  88A6 26 00        		ld h,0
1104  88A8
1105  88A8 E5           		push hl
1106  88A9 21 1D 80     		ld hl,STARTWINL
1107  88AC CD BB 93     		call ROZHOD2
1108  88AF 7E           		ld a,(hl)
1109  88B0 23           		inc hl
1110  88B1 66           		ld h,(hl)
1111  88B2 6F           		ld l,a
1112  88B3
1113  88B3 EB           		ex de,hl
1114  88B4 E1           		pop hl
1115  88B5 19           		add hl,de
1116  88B6 E5           		push hl
1117  88B7 23           		inc hl
1118  88B8 CD DB 94     		call find83
1119  88BB E1           		pop hl
1120  88BC CD 37 9A     		call FINDLFN
1121  88BF
1122  88BF
1123  88BF
1124  88BF
1125  88BF 21 D7 9A     		ld hl,LFNNAME
1126  88C2 11 49 88     		ld de,bfname
1127  88C5 01 2D 00     		ld bc,45
1128  88C8 ED B0        		ldir
1129  88CA
1130  88CA 21 0B 16     		ld hl,22*256+11
1131  88CD 3E 10        		ld a,16
1132  88CF 11 49 88     		ld de,bfname
1133  88D2 CD 97 97     		call print
1134  88D5
1135  88D5 21 0E 3C     		ld hl,60*256+14
1136  88D8 3E 30        		ld a,48
1137  88DA 11 1B 88     		ld de,yestxt
1138  88DD CD 97 97     		call print
1139  88E0
1140  88E0
1141  88E0
1142  88E0
1143  88E0 21 0F 3C     		ld hl,60*256+15
1144  88E3 3E 10        		ld a,16
1145  88E5 11 27 88     		ld de,notxt
1146  88E8 CD 97 97     		call print
1147  88EB              copywait
1148  88EB CD 05 95     		call INKEY
1149  88EE FE 01        		cp 1
1150  88F0 CA A8 89     		jp z,copyend
1151  88F3 FE 0D        		cp 13
1152  88F5 28 02        		jr z,copycont
1153  88F7 18 F2        		jr copywait
1154  88F9
1155  88F9              copycont
1156  88F9
1157  88F9 21 16 49     		ld   hl,$4000+160*14+23 + 1 + 62
1158  88FC 36 7C        		ld (hl),"|"
1159  88FE
1160  88FE 21 0E 3C     		ld hl,60*256+14
1161  8901 3E 10        		ld a,16
1162  8903 11 3D 88     		ld de,pleasewait
1163  8906 CD 97 97     		call print
1164  8909
1165  8909
1166  8909 21 0F 3C     		ld hl,60*256+15
1167  890C 3E 10        		ld a,16
1168  890E 11 32 88     		ld de,spaces
1169  8911 CD 97 97     		call print
1170  8914 21 17 80     		ld hl,POSKURZL
1171  8917 CD B3 93     		call ROZHOD
1172  891A 7E           		ld a,(hl)
1173  891B 6F           		ld l,a
1174  891C 26 00        		ld h,0
1175  891E
1176  891E E5           		push hl
1177  891F 21 1D 80     		ld hl,STARTWINL
1178  8922 CD BB 93     		call ROZHOD2
1179  8925 7E           		ld a,(hl)
1180  8926 23           		inc hl
1181  8927 66           		ld h,(hl)
1182  8928 6F           		ld l,a
1183  8929
1184  8929 EB           		ex de,hl
1185  892A E1           		pop hl
1186  892B 19           		add hl,de
1187  892C
1188  892C CD 92 8C     		call openfile
1189  892F CD F6 8B     		call createfile
1190  8932 CD 46 8C     		call readfile
1191  8935 06 00        		ld b,0
1192  8937 CD 3A 8C     		call closefile
1193  893A 06 02        		ld b,2
1194  893C CD 3A 8C     		call closefile
1195  893F
1196  893F
1197  893F 3A 12 80     		ld a,(OKNO)
1198  8942 EE 10        		xor 16
1199  8944 32 12 80     		ld (OKNO),a
1200  8947
1201  8947 21 00 00     		ld hl,0
1202  894A 21 D1 9A     		ld hl,ALLFILES
1203  894D CD BB 93     		call ROZHOD2
1204  8950 AF           		xor a
1205  8951 77           		ld (hl),a
1206  8952 23           		inc hl
1207  8953 77           		ld (hl),a
1208  8954 21 17 80     		ld hl,POSKURZL
1209  8957 CD B3 93     		call ROZHOD
1210  895A AF           		xor a
1211  895B 77           		ld (hl),a
1212  895C
1213  895C CD 58 99     		call dospage
1214  895F 21 21 80     		ld hl,pathl
1215  8962 CD BB 93     		call ROZHOD2
1216  8965 7E           		ld a,(hl)
1217  8966 23           		inc hl
1218  8967 66           		ld h,(hl)
1219  8968 6F           		ld l,a
1220  8969
1221  8969 AF           		xor a
1222  896A CD B1 01     		call $01b1
1223  896D CD 68 99     		call basicpage
1224  8970
1225  8970 CD 58 98     		call reload_dir
1226  8973 CD FA 91     		call loadscr
1227  8976 21 B9 91     		ld hl,adrl
1228  8979 CD BB 93     		call ROZHOD2
1229  897C 7E           		ld a,(hl)
1230  897D 23           		inc hl
1231  897E 66           		ld h,(hl)
1232  897F 6F           		ld l,a
1233  8980 22 46 94     		ld (adrs+1),hl
1234  8983 CD 75 91     		call getroot_reload
1235  8986 CD EB 93     		call showwin
1236  8989
1237  8989 3A 12 80     		ld a,(OKNO)
1238  898C EE 10        		xor 16
1239  898E 32 12 80     		ld (OKNO),a
1240  8991
1241  8991 CD 58 99     		call dospage
1242  8994 21 21 80     		ld hl,pathl
1243  8997 CD BB 93     		call ROZHOD2
1244  899A 7E           		ld a,(hl)
1245  899B 23           		inc hl
1246  899C 66           		ld h,(hl)
1247  899D 6F           		ld l,a
1248  899E AF           		xor a
1249  899F CD B1 01     		call $01b1
1250  89A2 CD 68 99     		call basicpage
1251  89A5
1252  89A5 C3 84 83     		jp loop0
1253  89A8
1254  89A8              copyend
1255  89A8 21 FF 83     			ld hl,numsel
1256  89AB CD BB 93     			call ROZHOD2
1257  89AE AF           			xor a
1258  89AF 77           			ld (hl),a
1259  89B0 23           			inc hl
1260  89B1 77           			ld (hl),a
1261  89B2
1262  89B2 CD FA 91     		call loadscr
1263  89B5 C3 84 83     		jp loop0
1264  89B8
1265  89B8 43 6F 70 79  morecopytxt	defb "Copy     files?",0
1265  89BC 20 20 20 20
1265  89C0 20 66 69 6C
1265  89C4 65 73 3F 00
1266  89C8 44 65 6C 65  moredeletetxt	defb "Delete     files?",0
1266  89CC 74 65 20 20
1266  89D0 20 20 20 66
1266  89D4 69 6C 65 73
1266  89D8 3F 00
1267  89DA
1268  89DA 43 6F 70 79  nowcopy	defb "Copy     file from     files",0
1268  89DE 20 20 20 20
1268  89E2 20 66 69 6C
1268  89E6 65 20 66 72
1268  89EA 6F 6D 20 20
1268  89EE 20 20 20 66
1268  89F2 69 6C 65 73
1268  89F6 00
1269  89F7 00 00        actcount defw 0
1270  89F9              morecopy
1271  89F9 21 00 00     		ld hl,0
1272  89FC 22 F7 89     		ld (actcount),hl
1273  89FF CD E6 91     		call savescr
1274  8A02
1275  8A02 21 0A 0A     		ld hl,10 * 256 + 10
1276  8A05 01 05 3C     		ld bc,60 * 256 + 5
1277  8A08 3E 10        		ld a,16
1278  8A0A CD B7 97     		call window
1279  8A0D
1280  8A0D 21 0B 0B     		ld hl,11*256+11
1281  8A10 3E 10        		ld a,16
1282  8A12 11 B8 89     		ld de,morecopytxt
1283  8A15 CD 97 97     		call print
1284  8A18
1285  8A18
1286  8A18 21 FF 83     		ld hl,numsel
1287  8A1B CD BB 93     		call ROZHOD2
1288  8A1E
1289  8A1E 7E           		ld a,(hl)
1290  8A1F 23           		inc hl
1291  8A20 66           		ld h,(hl)
1292  8A21 6F           		ld l,a
1293  8A22 E5           		push hl
1294  8A23
1295  8A23 EB           		ex de,hl
1296  8A24
1297  8A24 CD 79 84     		call PROVYP
1298  8A27 87           		add a,a
1299  8A28 22 47 8B     		ld   (CPPX1+1),hl
1300  8A2B 32 4F 8B             ld   (CPPX3+1),a
1301  8A2E 21 00 00             ld   hl,0
1302  8A31 22 75 84             ld   (PROGPROM),hl
1303  8A34
1304  8A34 21 21 91     		ld hl,NUMBUF
1305  8A37 11 22 91     		ld de,NUMBUF+1
1306  8A3A 01 05 00     		ld bc,5
1307  8A3D 3E 20        		ld a,32
1308  8A3F 77           		ld (hl),a
1309  8A40 ED B0        		ldir
1310  8A42 21 21 91     		ld hl,NUMBUF
1311  8A45 AF           		xor a
1312  8A46 32 24 91     		ld (NUMBUF+3),a
1313  8A49 22 6C 91     		ld (numadr+1),hl
1314  8A4C E1           		pop hl
1315  8A4D CD 4C 91     		call DECIMAL3
1316  8A50 21 0B 10     		ld hl,16*256+11
1317  8A53 3E 10        		ld a,16
1318  8A55 11 21 91     		ld de,NUMBUF
1319  8A58 CD 97 97     		call print
1320  8A5B
1321  8A5B
1322  8A5B              ;*****seem
1323  8A5B 21 0E 3C     		ld hl,60*256+14
1324  8A5E 3E 30        		ld a,48
1325  8A60 11 1B 88     		ld de,yestxt
1326  8A63 CD 97 97     		call print
1327  8A66
1328  8A66
1329  8A66 21 0F 3C     		ld hl,60*256+15
1330  8A69 3E 10        		ld a,16
1331  8A6B 11 27 88     		ld de,notxt
1332  8A6E CD 97 97     		call print
1333  8A71              acopywait
1334  8A71 CD 05 95     		call INKEY
1335  8A74 FE 01        		cp 1
1336  8A76 CA A8 89     		jp z,copyend
1337  8A79 FE 0D        		cp 13
1338  8A7B 28 02        		jr z,acopycont
1339  8A7D 18 F2        		jr acopywait
1340  8A7F
1341  8A7F              acopycont
1342  8A7F
1343  8A7F 21 0E 3C     		ld hl,60*256+14
1344  8A82 3E 10        		ld a,16
1345  8A84 11 3D 88     		ld de,pleasewait
1346  8A87 CD 97 97     		call print
1347  8A8A
1348  8A8A
1349  8A8A 21 0F 3C     		ld hl,60*256+15
1350  8A8D 3E 10        		ld a,16
1351  8A8F 11 32 88     		ld de,spaces
1352  8A92 CD 97 97     		call print
1353  8A95
1354  8A95 21 76 48     		ld   hl,$4000+160*13+23 + 1 + 62
1355  8A98 36 7C        		ld (hl),"|"
1356  8A9A 21 16 49     		ld   hl,$4000+160*14+23 + 1 + 62
1357  8A9D 36 7C        		ld (hl),"|"
1358  8A9F
1359  8A9F 21 00 00     		ld hl,0
1360  8AA2
1361  8AA2
1362  8AA2
1363  8AA2
1364  8AA2 E5           moredalsi push hl
1365  8AA3
1366  8AA3 CD DB 94     		call find83
1367  8AA6 CD AC 9A     		call BUFF83
1368  8AA9 2A F6 94     		ld hl,(foundfile)
1369  8AAC CB 7E        		bit 7,(hl)
1370  8AAE CA 56 8B     		jp z,nekopirovat
1371  8AB1 E5           		push hl
1372  8AB2
1373  8AB2 21 0B 0B     		ld hl,11*256+11
1374  8AB5 3E 10        		ld a,16
1375  8AB7 11 DA 89     		ld de,nowcopy
1376  8ABA CD 97 97     		call print
1377  8ABD
1378  8ABD 2A F7 89     		ld hl,(actcount)
1379  8AC0 23           		inc hl
1380  8AC1 22 F7 89     		ld 	(actcount),hl
1381  8AC4 E5           		push hl
1382  8AC5 21 21 91     		ld hl,NUMBUF
1383  8AC8 11 22 91     		ld de,NUMBUF+1
1384  8ACB 01 05 00     		ld bc,5
1385  8ACE 3E 20        		ld a,32
1386  8AD0 77           		ld (hl),a
1387  8AD1 ED B0        		ldir
1388  8AD3 21 21 91     		ld hl,NUMBUF
1389  8AD6 AF           		xor a
1390  8AD7 32 24 91     		ld (NUMBUF+3),a
1391  8ADA 22 6C 91     		ld (numadr+1),hl
1392  8ADD E1           		pop hl
1393  8ADE CD 4C 91     		call DECIMAL3
1394  8AE1 21 0B 10     		ld hl,16*256+11
1395  8AE4 3E 10        		ld a,16
1396  8AE6 11 21 91     		ld de,NUMBUF
1397  8AE9 CD 97 97     		call print
1398  8AEC
1399  8AEC
1400  8AEC
1401  8AEC 21 FF 83     		ld hl,numsel
1402  8AEF CD BB 93     		call ROZHOD2
1403  8AF2
1404  8AF2 7E           		ld a,(hl)
1405  8AF3 23           		inc hl
1406  8AF4 66           		ld h,(hl)
1407  8AF5 6F           		ld l,a
1408  8AF6 E5           		push hl
1409  8AF7 21 21 91     		ld hl,NUMBUF
1410  8AFA 11 22 91     		ld de,NUMBUF+1
1411  8AFD 01 05 00     		ld bc,5
1412  8B00 3E 20        		ld a,32
1413  8B02 77           		ld (hl),a
1414  8B03 ED B0        		ldir
1415  8B05 21 21 91     		ld hl,NUMBUF
1416  8B08 AF           		xor a
1417  8B09 32 24 91     		ld (NUMBUF+3),a
1418  8B0C 22 6C 91     		ld (numadr+1),hl
1419  8B0F E1           		pop hl
1420  8B10 CD 4C 91     		call DECIMAL3
1421  8B13 21 0B 1E     		ld hl,30*256+11
1422  8B16 3E 10        		ld a,16
1423  8B18 11 21 91     		ld de,NUMBUF
1424  8B1B CD 97 97     		call print
1425  8B1E
1426  8B1E E1           		pop hl
1427  8B1F CB BE        		res 7,(hl)			;zrus oznaceni
1428  8B21 11 07 00     		ld de,7
1429  8B24 19           		add hl,de
1430  8B25 CB 7E        		bit 7,(hl)
1431  8B27 20 16        		jr nz,NODIR		;preskoč adresar
1432  8B29 E1           		pop hl
1433  8B2A E5           		push hl
1434  8B2B 2B           		dec hl
1435  8B2C CD 92 8C     		call openfile
1436  8B2F CD F6 8B     		call createfile
1437  8B32 CD 46 8C     		call readfile
1438  8B35 06 00        		ld b,0
1439  8B37 CD 3A 8C     		call closefile
1440  8B3A 06 02        		ld b,2
1441  8B3C CD 3A 8C     		call closefile
1442  8B3F 2A 75 84     NODIR   ld   hl,(PROGPROM)
1443  8B42 23                   inc  hl
1444  8B43 22 75 84             ld   (PROGPROM),hl
1445  8B46 11 00 00     CPPX1    ld   de,0
1446  8B49 B7                    or   a
1447  8B4A ED 52                 sbc  hl,de
1448  8B4C 38 08                 jr   c,CPPNE1
1449  8B4E 06 01        CPPX3    ld   b,1
1450  8B50 22 75 84              ld   (PROGPROM),hl
1451  8B53 CD B3 84              call PROGRES
1452  8B56              CPPNE1
1453  8B56
1454  8B56              nekopirovat
1455  8B56 21 D1 9A     		ld hl,ALLFILES
1456  8B59 CD BB 93     		call ROZHOD2
1457  8B5C 7E           		ld a,(hl)
1458  8B5D 23           		inc hl
1459  8B5E 56           		ld d,(hl)
1460  8B5F 5F           		ld e,a
1461  8B60 E1           		pop hl
1462  8B61 B7           		or a
1463  8B62 ED 52        		sbc hl,de
1464  8B64 19           		add hl,de
1465  8B65 28 04        		jr z,morekonec
1466  8B67 23           		inc hl
1467  8B68 C3 A2 8A     		jp moredalsi
1468  8B6B              morekonec
1469  8B6B 3A 12 80     		ld a,(OKNO)
1470  8B6E EE 10        		xor 16
1471  8B70 32 12 80     		ld (OKNO),a
1472  8B73
1473  8B73 21 00 00     		ld hl,0
1474  8B76 21 D1 9A     		ld hl,ALLFILES
1475  8B79 CD BB 93     		call ROZHOD2
1476  8B7C AF           		xor a
1477  8B7D 77           		ld (hl),a
1478  8B7E 23           		inc hl
1479  8B7F 77           		ld (hl),a
1480  8B80 21 17 80     		ld hl,POSKURZL
1481  8B83 CD B3 93     		call ROZHOD
1482  8B86 AF           		xor a
1483  8B87 77           		ld (hl),a
1484  8B88
1485  8B88 CD 58 99     		call dospage
1486  8B8B 21 21 80     		ld hl,pathl
1487  8B8E CD BB 93     		call ROZHOD2
1488  8B91 7E           		ld a,(hl)
1489  8B92 23           		inc hl
1490  8B93 66           		ld h,(hl)
1491  8B94 6F           		ld l,a
1492  8B95
1493  8B95 AF           		xor a
1494  8B96 CD B1 01     		call $01b1
1495  8B99 CD 68 99     		call basicpage
1496  8B9C
1497  8B9C CD 58 98     		call reload_dir
1498  8B9F CD FA 91     		call loadscr
1499  8BA2 21 B9 91     		ld hl,adrl
1500  8BA5 CD BB 93     		call ROZHOD2
1501  8BA8 7E           		ld a,(hl)
1502  8BA9 23           		inc hl
1503  8BAA 66           		ld h,(hl)
1504  8BAB 6F           		ld l,a
1505  8BAC 22 46 94     		ld (adrs+1),hl
1506  8BAF CD 75 91     		call getroot_reload
1507  8BB2 CD EB 93     		call showwin
1508  8BB5
1509  8BB5 3A 12 80     		ld a,(OKNO)
1510  8BB8 EE 10        		xor 16
1511  8BBA 32 12 80     		ld (OKNO),a
1512  8BBD
1513  8BBD
1514  8BBD 21 B9 91     		ld hl,adrl
1515  8BC0 CD BB 93     		call ROZHOD2
1516  8BC3 7E           		ld a,(hl)
1517  8BC4 23           		inc hl
1518  8BC5 66           		ld h,(hl)
1519  8BC6 6F           		ld l,a
1520  8BC7 22 46 94     		ld (adrs+1),hl
1521  8BCA CD 75 91     		call getroot_reload
1522  8BCD CD EB 93     		call showwin
1523  8BD0 3E 20        		ld a,32
1524  8BD2 CD 8C 93     		call writecur
1525  8BD5
1526  8BD5 CD 58 99     		call dospage
1527  8BD8 21 21 80     		ld hl,pathl
1528  8BDB CD BB 93     		call ROZHOD2
1529  8BDE 7E           		ld a,(hl)
1530  8BDF 23           		inc hl
1531  8BE0 66           		ld h,(hl)
1532  8BE1 6F           		ld l,a
1533  8BE2 AF           		xor a
1534  8BE3 CD B1 01     		call $01b1
1535  8BE6 CD 68 99     		call basicpage
1536  8BE9
1537  8BE9
1538  8BE9
1539  8BE9 21 FF 83     		ld hl,numsel
1540  8BEC CD BB 93     		call ROZHOD2
1541  8BEF AF           		xor a
1542  8BF0 77           		ld (hl),a
1543  8BF1 23           		inc hl
1544  8BF2 77           		ld (hl),a
1545  8BF3
1546  8BF3
1547  8BF3
1548  8BF3
1549  8BF3
1550  8BF3
1551  8BF3 C3 84 83     		jp loop0
1552  8BF6
1553  8BF6              createfile
1554  8BF6
1555  8BF6 3A 12 80     		ld a,(OKNO)
1556  8BF9 EE 10        		xor 16
1557  8BFB 32 12 80     		ld (OKNO),a
1558  8BFE
1559  8BFE
1560  8BFE CD 58 99     		call dospage
1561  8C01
1562  8C01 21 21 80     		ld hl,pathl
1563  8C04 CD BB 93     		call ROZHOD2
1564  8C07 7E           		ld a,(hl)
1565  8C08 23           		inc hl
1566  8C09 66           		ld h,(hl)
1567  8C0A 6F           		ld l,a
1568  8C0B
1569  8C0B AF           		xor a
1570  8C0C CD B1 01     		call $01b1
1571  8C0F
1572  8C0F 06 02        		ld b,2 				;soubor číslo 1
1573  8C11 0E 02        		ld c,2				;exclusive WRITE
1574  8C13 16 02        		ld d,2
1575  8C15 1E 04        		ld e,4
1576  8C17 21 D7 9A     		ld hl,LFNNAME
1577  8C1A
1578  8C1A CD 06 01     		call 0106h			;create file
1579  8C1D
1580  8C1D
1581  8C1D
1582  8C1D 3A 12 80     		ld a,(OKNO)
1583  8C20 EE 10        		xor 16
1584  8C22 32 12 80     		ld (OKNO),a
1585  8C25 CD 58 99     		call dospage
1586  8C28
1587  8C28 21 21 80     		ld hl,pathl
1588  8C2B CD BB 93     		call ROZHOD2
1589  8C2E 7E           		ld a,(hl)
1590  8C2F 23           		inc hl
1591  8C30 66           		ld h,(hl)
1592  8C31 6F           		ld l,a
1593  8C32
1594  8C32 AF           		xor a
1595  8C33 CD B1 01     		call $01b1
1596  8C36 CD 68 99     		call basicpage
1597  8C39 C9           		ret
1598  8C3A
1599  8C3A              closefile
1600  8C3A C5           		push bc
1601  8C3B CD 58 99     		call dospage
1602  8C3E C1           		pop bc
1603  8C3F CD 09 01     		call 0109h
1604  8C42 CD 68 99     		call basicpage
1605  8C45 C9           		ret
1606  8C46
1607  8C46              readfile
1608  8C46              READ
1609  8C46 CD 58 99     		call dospage
1610  8C49 CD BD 9A     		call NOBUFF83
1611  8C4C              read0
1612  8C4C
1613  8C4C
1614  8C4C 2A 77 84     		 ld   hl,(PROGPROM2)
1615  8C4F 23                    inc  hl
1616  8C50 22 77 84              ld   (PROGPROM2),hl
1617  8C53 11 00 00     CPPX2    ld   de,0
1618  8C56 B7                    or   a
1619  8C57 ED 52                 sbc  hl,de
1620  8C59 38 08                 jr   c,CPPNE2
1621  8C5B 06 01        CPPX4    ld   b,1
1622  8C5D 22 77 84              ld   (PROGPROM2),hl
1623  8C60 CD C3 84              call PROGRES2
1624  8C63              CPPNE2
1625  8C63
1626  8C63
1627  8C63 06 00        		ld b,0
1628  8C65 0E 03        		ld c,3
1629  8C67 11 00 18     		ld de,blocklenght				;počet bytu
1630  8C6A 21 C1 9E     		ld hl,FILEBUFF
1631  8C6D CD 12 01     		call 0112h
1632  8C70 30 0F        		jr nc, konec
1633  8C72
1634  8C72 0E 03        		ld c,3
1635  8C74 06 02        		ld b,2
1636  8C76 11 00 18     		ld de,blocklenght
1637  8C79 21 C1 9E     		ld hl,FILEBUFF
1638  8C7C CD 15 01     		call 115h
1639  8C7F
1640  8C7F
1641  8C7F 18 CB        		jr read0
1642  8C81              konec
1643  8C81
1644  8C81 0E 03        		ld c,3
1645  8C83 06 02        		ld b,2
1646  8C85 11 00 18     		ld de,blocklenght
1647  8C88 21 C1 9E     		ld hl,FILEBUFF
1648  8C8B CD 15 01     		call 115h
1649  8C8E
1650  8C8E CD 68 99     		call basicpage
1651  8C91 C9           		ret
1652  8C92
1653  8C92
1654  8C92
1655  8C92              openfile
1656  8C92
1657  8C92 E5           		push hl
1658  8C93
1659  8C93 23           		inc hl
1660  8C94
1661  8C94 CD AC 9A     		call BUFF83
1662  8C97 CD DB 94     		call find83
1663  8C9A E1           		pop hl
1664  8C9B E5           		push hl
1665  8C9C CD 37 9A     		call FINDLFN
1666  8C9F
1667  8C9F 21 D7 9A     		ld hl,LFNNAME
1668  8CA2 11 49 88     		ld de,bfname
1669  8CA5 01 2D 00     		ld bc,45
1670  8CA8 ED B0        		ldir
1671  8CAA
1672  8CAA 21 0F 0B     		ld hl,11*256+15
1673  8CAD 3E 10        		ld a,16
1674  8CAF 11 49 88     		ld de,bfname
1675  8CB2 CD 97 97     		call print
1676  8CB5
1677  8CB5
1678  8CB5 CD AC 9A     		call BUFF83
1679  8CB8 2A 03 95     		ld hl,(TMP83+11)
1680  8CBB              ZDE
1681  8CBB 0E 06        		ld c,6
1682  8CBD CD 28 9A     		call deleno
1683  8CC0
1684  8CC0 23           		inc hl
1685  8CC1              of0
1686  8CC1 EB           		ex de,hl
1687  8CC2 CD 79 84     		call PROVYP
1688  8CC5 87           		add a,a
1689  8CC6 22 54 8C     		ld   (CPPX2+1),hl
1690  8CC9 32 5C 8C             ld   (CPPX4+1),a
1691  8CCC 21 00 00             ld   hl,0
1692  8CCF 22 77 84             ld   (PROGPROM2),hl
1693  8CD2 21 D7 48     		ld   hl,$4000+160*14+23
1694  8CD5 22 C5 84     		ld (PROGS2+1),hl
1695  8CD8 CD D3 84     		call clearpr
1696  8CDB
1697  8CDB
1698  8CDB E1           		pop hl
1699  8CDC              LF
1700  8CDC CD 37 9A     		call FINDLFN
1701  8CDF              						;na adrese TMP83 je adresa
1702  8CDF 21 D6 9B     		ld hl,LFNNAME+255
1703  8CE2 36 FF        		ld (hl),255
1704  8CE4 06 0B        		ld b,11
1705  8CE6 21 F8 94     		ld hl,TMP83
1706  8CE9              CCCA							;vynuluj všechny stavové bity v názvu (7.)
1707  8CE9 CB BE        		res 7,(hl)
1708  8CEB 23           		inc hl
1709  8CEC 10 FB        		djnz CCCA
1710  8CEE 21 02 95     		ld hl,TMP83+10		;najdi poslední znak názvu souboru/adresare
1711  8CF1 7E           achng2	ld a,(hl)
1712  8CF2 FE 20        		cp 32
1713  8CF4 20 03        		jr nz,azap
1714  8CF6 2B           		dec hl
1715  8CF7 18 F8        		jr achng2
1716  8CF9 3E FF        azap		ld a,255
1717  8CFB 23           		inc hl
1718  8CFC 77           		ld (hl),a
1719  8CFD
1720  8CFD 21 D5 9B     		ld hl,LFNNAME+254		;najdi poslední znak LFN souboru/adresare
1721  8D00 7E           achnga2	ld a,(hl)
1722  8D01 FE 20        		cp 32
1723  8D03 20 03        		jr nz,azapa
1724  8D05 2B           		dec hl
1725  8D06 18 F8        		jr achnga2
1726  8D08 3E FF        azapa	ld a,255
1727  8D0A 23           		inc hl
1728  8D0B 77           		ld (hl),a
1729  8D0C
1730  8D0C
1731  8D0C
1732  8D0C CD 58 99     		call dospage
1733  8D0F 06 00        		ld b,0 				;soubor číslo 0
1734  8D11 0E 01        		ld c,1				;exclusive READ
1735  8D13 1E 02        		ld e,2
1736  8D15 21 F8 94     		ld hl,TMP83
1737  8D18
1738  8D18
1739  8D18 CD 06 01     		call 0106h			;open file
1740  8D1B
1741  8D1B CD 68 99     		call basicpage
1742  8D1E C9           		ret
1743  8D1F
1744  8D1F
1745  8D1F              gettime
1746  8D1F CD 58 99     		call dospage
1747  8D22
1748  8D22 CD CC 01     		call $01cc		;načti čas a datum  DE = time, BC DATE
1749  8D25 ED 53 46 8D  		ld (dostime),de
1750  8D29 30 15        		jr nc,timeend
1751  8D2B
1752  8D2B 7A           		ld a,d
1753  8D2C E6 1F        		and 00011111b
1754  8D2E 32 44 8D     		ld (hodiny),a
1755  8D31 7A           		ld a,d
1756  8D32
1757  8D32 1F           		rra
1758  8D33 1F           		rra
1759  8D34 1F           		rra
1760  8D35 1F           		rra
1761  8D36 1F           		rra
1762  8D37 47           		ld b,a
1763  8D38 7B           		ld a,e
1764  8D39 17           		rla
1765  8D3A 17           		rla
1766  8D3B 17           		rla
1767  8D3C B0           		or b
1768  8D3D 32 45 8D     		ld (minuty),a
1769  8D40              timeend
1770  8D40 CD 68 99     		call basicpage
1771  8D43 C9           		ret
1772  8D44
1773  8D44 00           hodiny	defb 0
1774  8D45 00           minuty	defb 0
1775  8D46 00 00        dostime	defw 0
1776  8D48 CD E6 91     menu	call savescr
1777  8D4B
1778  8D4B CD E9 8D     		call show_menu
1779  8D4E
1780  8D4E CD 05 95     menu01	call INKEY
1781  8D51
1782  8D51 FE 01        		cp 1
1783  8D53 CA 68 8D     		jp z,menu_exit
1784  8D56
1785  8D56 FE 0A        		cp 10
1786  8D58 28 51        		jr z,menudown
1787  8D5A FE 0B        		cp 11
1788  8D5C 28 6D        		jr z,menuup
1789  8D5E FE 09        		cp 9
1790  8D60 28 0C        		jr z,menu_right
1791  8D62 FE 08        		cp 8
1792  8D64 28 27        		jr z,menu_left
1793  8D66 18 E6        		jr menu01
1794  8D68
1795  8D68              menu_exit
1796  8D68 CD FA 91     		call loadscr
1797  8D6B C3 84 83     		jp loop0
1798  8D6E
1799  8D6E              menu_right
1800  8D6E 3A E2 8E     		ld a,(nummenu)
1801  8D71 FE 04        		cp 4
1802  8D73 CA 4E 8D     		jp z,menu01
1803  8D76
1804  8D76 3C           		inc a
1805  8D77 32 E2 8E     		ld (nummenu),a
1806  8D7A CD FA 91     		call loadscr
1807  8D7D 3E 01        		ld a,1
1808  8D7F 32 6D 8E     		ld (curmeny+1),a
1809  8D82
1810  8D82 CD E9 8D     		call show_menu
1811  8D85 3E 40        		ld a,64
1812  8D87 CD 66 8E     		call writecurmenu
1813  8D8A C3 4E 8D     		jp menu01
1814  8D8D
1815  8D8D              menu_left
1816  8D8D 3A E2 8E     		ld a,(nummenu)
1817  8D90 B7           		or a
1818  8D91 CA 4E 8D     		jp z,menu01
1819  8D94
1820  8D94 3D           		dec a
1821  8D95 32 E2 8E     		ld (nummenu),a
1822  8D98 CD FA 91     		call loadscr
1823  8D9B 3E 01        		ld a,1
1824  8D9D 32 6D 8E     		ld (curmeny+1),a
1825  8DA0
1826  8DA0 CD E9 8D     		call show_menu
1827  8DA3 3E 40        		ld a,64
1828  8DA5 CD 66 8E     		call writecurmenu
1829  8DA8 C3 4E 8D     		jp menu01
1830  8DAB
1831  8DAB
1832  8DAB              menudown
1833  8DAB 21 6D 8E     		ld hl,curmeny+1
1834  8DAE 7E           		ld a,(hl)
1835  8DAF 21 49 8E     		ld hl,pocet_radku+1
1836  8DB2 BE           		cp (hl)
1837  8DB3 CA 4E 8D     		jp z,menu01
1838  8DB6
1839  8DB6
1840  8DB6 3E 30        		ld a,48
1841  8DB8 CD 66 8E     		call writecurmenu
1842  8DBB 21 6D 8E     		ld hl,curmeny+1
1843  8DBE 7E           		ld a,(hl)
1844  8DBF
1845  8DBF 3C           		inc a
1846  8DC0 32 6D 8E     		ld (curmeny+1),a
1847  8DC3 3E 40        		ld a,64
1848  8DC5 CD 66 8E     		call writecurmenu
1849  8DC8 C3 4E 8D     		jp menu01
1850  8DCB
1851  8DCB 21 6D 8E     menuup 	ld hl,curmeny+1
1852  8DCE 7E           		ld a,(hl)
1853  8DCF FE 01        		cp 1
1854  8DD1 CA 4E 8D     		jp z,menu01
1855  8DD4
1856  8DD4
1857  8DD4 3E 30        		ld a,48
1858  8DD6 CD 66 8E     		call writecurmenu
1859  8DD9 21 6D 8E     		ld hl,curmeny+1
1860  8DDC 7E           		ld a,(hl)
1861  8DDD
1862  8DDD 3D           		dec a
1863  8DDE 32 6D 8E     		ld (curmeny+1),a
1864  8DE1 3E 40        		ld a,64
1865  8DE3 CD 66 8E     		call writecurmenu
1866  8DE6 C3 4E 8D     		jp menu01
1867  8DE9
1868  8DE9
1869  8DE9              show_menu
1870  8DE9              SAS
1871  8DE9 3A E2 8E     		ld a,(nummenu)				;zjisteni delky menu
1872  8DEC 5F           		ld e,a
1873  8DED 16 00        		ld d,0
1874  8DEF 21 ED 8E     		ld hl,menulenght
1875  8DF2 19           		add hl,de
1876  8DF3 7E           		ld a,(hl)
1877  8DF4 32 49 8E     		ld (pocet_radku+1),a
1878  8DF7
1879  8DF7 21 DD 8E     		ld hl,menupos				;zjisteni X souradnice
1880  8DFA 19           		add hl,de
1881  8DFB 7E           		ld a,(hl)
1882  8DFC B7           		or a
1883  8DFD 28 02        		jr z,sm1
1884  8DFF 3D           		dec a
1885  8E00 3D           		dec a
1886  8E01 32 19 8E     sm1		ld (menux+1),a
1887  8E04
1888  8E04 43           		ld b,e
1889  8E05 AF           		xor a
1890  8E06 C6 02        sm0		add a,2
1891  8E08 10 FC        		djnz sm0
1892  8E0A
1893  8E0A 5F           		ld e,a
1894  8E0B 16 00        		ld d,0
1895  8E0D 21 E3 8E     		ld hl,menuitems
1896  8E10 19           		add hl,de
1897  8E11 7E           		ld a,(hl)
1898  8E12 23           		inc hl
1899  8E13 66           		ld h,(hl)
1900  8E14 6F           		ld l,a
1901  8E15 22 3A 8E     		ld (adresa_polozky+1),hl		;uloz definované menu
1902  8E18
1903  8E18 21 02 40     menux		ld hl,$4000+2
1904  8E1B 22 6A 8E     			ld (curmen+1),hl
1905  8E1E 23           			inc hl
1906  8E1F 3E 30        			ld a,48
1907  8E21 77           			ld (hl),a
1908  8E22
1909  8E22 23           			inc hl
1909  8E23 23             inc hl
1910  8E24 77           			ld (hl),a
1911  8E25
1912  8E25 23           			inc hl
1912  8E26 23             inc hl
1913  8E27 77           			ld (hl),a
1914  8E28
1915  8E28 23           			inc hl
1915  8E29 23             inc hl
1916  8E2A 77           			ld (hl),a
1917  8E2B
1918  8E2B 23           			inc hl
1918  8E2C 23             inc hl
1919  8E2D 77           			ld (hl),a
1920  8E2E
1921  8E2E 23           			inc hl
1921  8E2F 23             inc hl
1922  8E30 77           			ld (hl),a
1923  8E31
1924  8E31 23           			inc hl
1924  8E32 23             inc hl
1925  8E33 77           			ld (hl),a
1926  8E34
1927  8E34
1928  8E34
1929  8E34 67           			ld h,a
1930  8E35 2E 01        			ld l,1
1931  8E37
1932  8E37 3E 10        		ld a,16
1933  8E39
1934  8E39 11 00 00     adresa_polozky	ld de,0
1935  8E3C
1936  8E3C
1937  8E3C 3E 01        		ld a,1
1938  8E3E 32 4B 8E     		ld (ymenu+1),a
1939  8E41 3A 19 8E     		ld a,(menux+1)
1940  8E44 1F           		rra				;vydel dvema - atributy
1941  8E45 32 4D 8E     		ld (xmenu +1),a
1942  8E48 06 00        pocet_radku ld b,0
1943  8E4A 2E 01        ymenu	ld l,1
1944  8E4C 26 00        xmenu	ld h,0
1945  8E4E 3E 30        		ld a,48
1946  8E50 CD 97 97     		call print
1947  8E53 1A           		ld a,(de)
1948  8E54 FE FF        		cp 255
1949  8E56 C8           		ret z
1950  8E57 13           		inc de
1951  8E58 13           		inc de
1952  8E59 13           		inc de
1953  8E5A 21 4B 8E     		ld hl,ymenu+1
1954  8E5D 34           		inc (hl)
1955  8E5E 10 EA        		djnz ymenu
1956  8E60
1957  8E60 3E 40        		ld a,64
1958  8E62 CD 66 8E     		call writecurmenu
1959  8E65
1960  8E65 C9           		ret
1961  8E66              SASS
1962  8E66              writecurmenu
1963  8E66 32 76 8E     			ld (curmencolor+1),a
1964  8E69
1965  8E69 21 00 00     curmen		ld hl,0
1966  8E6C 06 01        curmeny		ld b,1
1967  8E6E 11 A0 00     			ld de,160
1968  8E71              curmen1
1969  8E71 19           			add hl,de
1970  8E72 10 FD        			djnz curmen1
1971  8E74
1972  8E74 23           			inc hl
1973  8E75 3E 10        curmencolor	ld a,16
1974  8E77 77           			ld (hl),a
1975  8E78 06 10        			ld b,16
1976  8E7A 23           curmen0		inc hl
1976  8E7B 23             inc hl
1977  8E7C 77           			ld (hl),a
1978  8E7D 10 FB        			djnz curmen0
1979  8E7F C9           			ret
1980  8E80
1981  8E80
1982  8E80
1983  8E80 20 4C 45 46  text 		defb " LEFT  | FILE  | UTILS | RIGHT | QUIT                                                       ",0
1983  8E84 54 20 20 7C
1983  8E88 20 46 49 4C
1983  8E8C 45 20 20 7C
1983  8E90 20 55 54 49
1983  8E94 4C 53 20 7C
1983  8E98 20 52 49 47
1983  8E9C 48 54 20 7C
1983  8EA0 20 51 55 49
1983  8EA4 54 20 20 20
1983  8EA8 20 20 20 20
1983  8EAC 20 20 20 20
1983  8EB0 20 20 20 20
1983  8EB4 20 20 20 20
1983  8EB8 20 20 20 20
1983  8EBC 20 20 20 20
1983  8EC0 20 20 20 20
1983  8EC4 20 20 20 20
1983  8EC8 20 20 20 20
1983  8ECC 20 20 20 20
1983  8ED0 20 20 20 20
1983  8ED4 20 20 20 20
1983  8ED8 20 20 20 20
1983  8EDC 00
1984  8EDD 00 12 22 32  menupos		defb 0, 18, 34, 50,66
1984  8EE1 42
1985  8EE2
1986  8EE2 00           nummenu		defb 0				;jakou položku zobrazit v menu
1987  8EE3 F3 8E 30 8F  menuitems	defw menuleft, menufile, menuutil, menuright, menuquit
1987  8EE7 BE 8F 95 8F
1987  8EEB FB 8F
1988  8EED 03 05 02 02  menulenght	defb 3, 5, 2, 2, 1	;počet položek v daném menu
1988  8EF1 01
1989  8EF2 00           menucur 	defb 0
1990  8EF3 20 52 45 4C  menuleft	defb " RELOAD DIR      ",0
1990  8EF7 4F 41 44 20
1990  8EFB 44 49 52 20
1990  8EFF 20 20 20 20
1990  8F03 20 00
1991  8F05 00 00        			defw 0
1992  8F07 20 43 48 41  			defb " CHANGE DISC     ",0
1992  8F0B 4E 47 45 20
1992  8F0F 44 49 53 43
1992  8F13 20 20 20 20
1992  8F17 20 00
1993  8F19 00 00        			defw 0
1994  8F1B 20 4D 45 4E  			defb " MENU ITEM       ",0
1994  8F1F 55 20 49 54
1994  8F23 45 4D 20 20
1994  8F27 20 20 20 20
1994  8F2B 20 00
1995  8F2D 00 00        			defw 0
1996  8F2F FF           			defb 255
1997  8F30 20 43 4F 50  menufile    defb " COPY            ",0
1997  8F34 59 20 20 20
1997  8F38 20 20 20 20
1997  8F3C 20 20 20 20
1997  8F40 20 00
1998  8F42 00 00        			defw 0
1999  8F44 20 4D 4F 56  			defb " MOVE            ",0
1999  8F48 45 20 20 20
1999  8F4C 20 20 20 20
1999  8F50 20 20 20 20
1999  8F54 20 00
2000  8F56 00 00        			defw 0
2001  8F58 20 4D 45 4E  			defb " MENU ITEM       ",0
2001  8F5C 55 20 49 54
2001  8F60 45 4D 20 20
2001  8F64 20 20 20 20
2001  8F68 20 00
2002  8F6A 00 00        			defw 0
2003  8F6C 20 4D 45 4E  			defb " MENU ITEM 1     ",0
2003  8F70 55 20 49 54
2003  8F74 45 4D 20 31
2003  8F78 20 20 20 20
2003  8F7C 20 00
2004  8F7E 00 00        			defw 0
2005  8F80 20 4D 45 4E  			defb " MENU ITEM 2     ",0
2005  8F84 55 20 49 54
2005  8F88 45 4D 20 32
2005  8F8C 20 20 20 20
2005  8F90 20 00
2006  8F92 00 00        			defw 0
2007  8F94 FF           			defb 255
2008  8F95
2009  8F95 20 52 45 4C  menuright	defb " RELOAD DIR      ",0
2009  8F99 4F 41 44 20
2009  8F9D 44 49 52 20
2009  8FA1 20 20 20 20
2009  8FA5 20 00
2010  8FA7 00 00        			defw 0
2011  8FA9 20 4D 45 4E  			defb " MENU ITEM       ",0
2011  8FAD 55 20 49 54
2011  8FB1 45 4D 20 20
2011  8FB5 20 20 20 20
2011  8FB9 20 00
2012  8FBB 00 00        			defw 0
2013  8FBD FF           			defb 255
2014  8FBE 20 53 4F 52  menuutil 	defb " SORT DIRECTORY  ",0
2014  8FC2 54 20 44 49
2014  8FC6 52 45 43 54
2014  8FCA 4F 52 59 20
2014  8FCE 20 00
2015  8FD0 00 00        			defw 0
2016  8FD2 20 4D 45 4E  			defb " MENU ITEM 1     ",0
2016  8FD6 55 20 49 54
2016  8FDA 45 4D 20 31
2016  8FDE 20 20 20 20
2016  8FE2 20 00
2017  8FE4 00 00        			defw 0
2018  8FE6 20 4D 45 4E  			defb " MENU ITEM 2     ",0
2018  8FEA 55 20 49 54
2018  8FEE 45 4D 20 32
2018  8FF2 20 20 20 20
2018  8FF6 20 00
2019  8FF8 00 00        			defw 0
2020  8FFA FF           			defb 255
2021  8FFB 20 51 55 49  menuquit	defb " QUIT CCommander ",0
2021  8FFF 54 20 43 43
2021  9003 6F 6D 6D 61
2021  9007 6E 64 65 72
2021  900B 20 00
2022  900D 00 00        			defw 0
2023  900F
2024  900F              enter
2025  900F 21 17 80     		ld hl,POSKURZL
2026  9012 CD B3 93     		call ROZHOD
2027  9015 7E           		ld a,(hl)
2028  9016 6F           		ld l,a
2029  9017 26 00        		ld h,0
2030  9019
2031  9019 E5           		push hl
2032  901A 21 1D 80     		ld hl,STARTWINL
2033  901D CD BB 93     		call ROZHOD2
2034  9020 7E           		ld a,(hl)
2035  9021 23           		inc hl
2036  9022 66           		ld h,(hl)
2037  9023 6F           		ld l,a
2038  9024
2039  9024 EB           		ex de,hl
2040  9025 E1           		pop hl
2041  9026 19           		add hl,de
2042  9027 23           		inc hl
2043  9028 CD AC 9A     e2		call BUFF83
2044  902B CD DB 94     		call find83
2045  902E DD 21 F8 94  		ld ix,TMP83
2046  9032 DD CB 07 7E  		bit 7,(ix+7)
2047  9036 20 03        		jr nz,enter_directory
2048  9038
2049  9038 C3 84 83     		jp loop0
2050  903B
2051  903B              enter_directory
2052  903B
2053  903B
2054  903B 06 0B        		ld b,11
2055  903D 21 F8 94     		ld hl,TMP83
2056  9040              CCC							;vynuluj všechny stavové bity v názvu (7.)
2057  9040 CB BE        		res 7,(hl)
2058  9042 23           		inc hl
2059  9043 10 FB        		djnz CCC
2060  9045 21 02 95     		ld hl,TMP83+10		;najdi poslední znak názvu souboru/adresare
2061  9048 7E           chng2	ld a,(hl)
2062  9049 FE 20        		cp 32
2063  904B 20 03        		jr nz,zap
2064  904D 2B           		dec hl
2065  904E 18 F8        		jr chng2
2066  9050 3E FF        zap		ld a,255
2067  9052 23           		inc hl
2068  9053 77           		ld (hl),a
2069  9054 CD 58 99     		call dospage
2070  9057 AF           		xor a 			;change path
2071  9058 21 F8 94     		ld hl,TMP83
2072  905B              AAAA
2073  905B CD B1 01     		call $01b1		;změň adresář
2074  905E
2075  905E CD 68 99     		call basicpage
2076  9061 21 00 00     		ld hl,0
2077  9064 21 D1 9A     		ld hl,ALLFILES
2078  9067 CD BB 93     		call ROZHOD2
2079  906A AF           		xor a
2080  906B 77           		ld (hl),a
2081  906C 23           		inc hl
2082  906D 77           		ld (hl),a
2083  906E 21 17 80     		ld hl,POSKURZL
2084  9071 CD B3 93     		call ROZHOD
2085  9074 AF           		xor a
2086  9075 77           		ld (hl),a
2087  9076 CD 58 98     		call reload_dir
2088  9079
2089  9079 21 B5 91     		ld hl,pozicel
2090  907C CD BB 93     		call ROZHOD2
2091  907F 7E           		ld a,(hl)
2092  9080 23           		inc hl
2093  9081 66           		ld h,(hl)
2094  9082 6F           		ld l,a
2095  9083
2096  9083 01 1B 26     		ld bc,38 * 256 + 27
2097  9086 3E 00        		ld a,0
2098  9088 CD B7 97     		call window
2099  908B
2100  908B 21 21 80     		ld hl,pathl
2101  908E CD BB 93     		call ROZHOD2
2102  9091 7E           		ld a,(hl)
2103  9092 23           		inc hl
2104  9093 66           		ld h,(hl)
2105  9094 6F           		ld l,a
2106  9095 11 03 00     		ld de,3
2107  9098 19           		add hl,de
2108  9099 7E           		ld a,(hl)
2109  909A FE FF        		cp 255
2110  909C 28 07        		jr z,root
2111  909E 3E 01        		ld a,1
2112  90A0 32 B7 90     		ld (star+1),a
2113  90A3 18 04        		jr rcont
2114  90A5 AF           root	xor a
2115  90A6 32 B7 90     		ld (star+1),a
2116  90A9 21 B9 91     rcont	ld hl,adrl
2117  90AC CD BB 93     		call ROZHOD2
2118  90AF 7E           		ld a,(hl)
2119  90B0 23           		inc hl
2120  90B1 66           		ld h,(hl)
2121  90B2 6F           		ld l,a
2122  90B3
2123  90B3
2124  90B3 22 46 94     		ld (adrs+1),hl
2125  90B6 21 01 00     star	ld hl,1
2126  90B9 CD EB 93     		call showwin
2127  90BC 3E 20        		ld a,32
2128  90BE CD 8C 93     		call writecur
2129  90C1
2130  90C1 21 21 80     		ld hl,pathl
2131  90C4 CD BB 93     		call ROZHOD2
2132  90C7 7E           		ld a,(hl)
2133  90C8 23           		inc hl
2134  90C9 66           		ld h,(hl)
2135  90CA 6F           		ld l,a
2136  90CB 11 03 00     		ld de,3
2137  90CE 19           		add hl,de
2138  90CF 7E           		ld a,(hl)
2139  90D0 FE FF        		cp 255
2140  90D2 28 05        		jr z,snula
2141  90D4 21 01 00     		ld hl,1
2142  90D7 18 03        		jr scont
2143  90D9 21 00 00     snula	ld hl,0
2144  90DC              scont
2145  90DC
2146  90DC 21 19 80     		ld hl,ALLPOSL
2147  90DF CD BB 93     		call ROZHOD2
2148  90E2 36 00        		ld (hl),0
2149  90E4 21 1D 80     		ld hl,STARTWINL
2150  90E7 CD BB 93     		call ROZHOD2
2151  90EA E5           		push hl
2152  90EB CD 75 91     		call getroot_reload
2153  90EE D1           		pop de
2154  90EF EB           		ex de,hl
2155  90F0
2156  90F0 73           		ld (hl),e
2157  90F1 23           		inc hl
2158  90F2 72           		ld (hl),d
2159  90F3 C3 84 83     		jp loop0
2160  90F6
2161  90F6
2162  90F6              getroot
2163  90F6 21 21 80     		ld hl,pathl
2164  90F9 CD BB 93     		call ROZHOD2
2165  90FC 7E           		ld a,(hl)
2166  90FD 23           		inc hl
2167  90FE 66           		ld h,(hl)
2168  90FF 6F           		ld l,a
2169  9100 11 03 00     		ld de,3
2170  9103 19           		add hl,de
2171  9104 7E           		ld a,(hl)
2172  9105 FE FF        		cp 255
2173  9107 28 0C        		jr z,mroot
2174  9109
2175  9109 21 1D 80     		ld hl,STARTWINL
2176  910C CD BB 93     		call ROZHOD2
2177  910F 7E           		ld a,(hl)
2178  9110 23           		inc hl
2179  9111 66           		ld h,(hl)
2180  9112 6F           		ld l,a
2181  9113 18 0B        		jr mmm0
2182  9115              mroot
2183  9115 21 1D 80     		ld hl,STARTWINL
2184  9118 CD BB 93     		call ROZHOD2
2185  911B 7E           		ld a,(hl)
2186  911C 23           		inc hl
2187  911D 66           		ld h,(hl)
2188  911E 6F           		ld l,a
2189  911F 2B           		dec hl
2190  9120              mmm0
2191  9120 C9           		ret
2192  9121
2193  9121 20 20 20 20  NUMBUF	defb "        ",0
2193  9125 20 20 20 20
2193  9129 00
2194  912A              NUM
2195  912A E5           		push hl
2196  912B 21 21 91     		ld hl,NUMBUF
2197  912E 11 22 91     		ld de,NUMBUF+1
2198  9131 01 05 00     		ld bc,5
2199  9134 3E 20        		ld a,32
2200  9136 77           		ld (hl),a
2201  9137 ED B0        		ldir
2202  9139 21 21 91     		ld hl,NUMBUF
2203  913C 22 6C 91     		ld (numadr+1),hl
2204  913F E1           		pop hl
2205  9140 11 10 27     DECIMAL5 ld de,10000 ;řád desetitisíců
2206  9143 CD 5B 91     		 call DIGIT ;počet desetitisíců
2207  9146 11 E8 03     DECIMAL4 ld de,1000 ;řád tisíců
2208  9149 CD 5B 91     		 call DIGIT ;a jeho počet
2209  914C 11 64 00     DECIMAL3 ld de,100 ;řád stovek
2210  914F CD 5B 91     		 call DIGIT ;počet
2211  9152 11 0A 00     DECIMAL2 ld de,10 ;desítky
2212  9155 CD 5B 91     		 call DIGIT ;počet
2213  9158 11 01 00     DECIMAL1 ld de,1 ;jednotky
2214  915B 3E 2F        DIGIT 	 ld a,"0"-1 ;do A kód znaku 0 bez jedné
2215  915D 3C           DIGIT2 	 inc a ;přičti jedničku
2216  915E B7           		 or a ;vynuluj CARRY Flag
2217  915F ED 52        		 sbc hl,de ;pokusně odečti řád
2218  9161 30 FA        		 jr nc,DIGIT2 ;pokud není výsledek záporný opakuj
2219  9163 19           		 add hl,de ;přičti řád zpátky
2220  9164 FE 3A        		 cp "9"+1 ;testuj znaky 0 až 9
2221  9166 38 02        		 jr c,DIGIT3 ;odskoč pokud platí
2222  9168 C6 07        		 add a,"A"-"9"-1 ;oprava na A až F pro hexa čísla
2223  916A E5           DIGIT3   push 	hl
2224  916B 21 00 00     numadr	 ld hl,0
2225  916E 77           		 ld (hl),a
2226  916F 23           		 inc hl
2227  9170 22 6C 91     		 ld (numadr+1),hl
2228  9173 E1           		 pop hl
2229  9174 C9           		 ret
2230  9175
2231  9175
2232  9175
2233  9175
2234  9175              getroot_reload
2235  9175 21 21 80     		ld hl,pathl
2236  9178 CD BB 93     		call ROZHOD2
2237  917B 7E           		ld a,(hl)
2238  917C 23           		inc hl
2239  917D 66           		ld h,(hl)
2240  917E 6F           		ld l,a
2241  917F 11 03 00     		ld de,3
2242  9182 19           		add hl,de
2243  9183 7E           		ld a,(hl)
2244  9184 FE FF        		cp 255
2245  9186 28 05        		jr z,amroot
2246  9188 21 01 00     		ld hl,1
2247  918B 18 03        		jr ammm0
2248  918D              amroot
2249  918D 21 00 00     		ld hl,0
2250  9190              ammm0
2251  9190 C9           		ret
2252  9191
2253  9191
2254  9191 43 3A FF     DIRTMP  defb "C:",255
2255  9194
2256  9194              getdir
2257  9194 21 21 80     		ld hl,pathl
2258  9197 CD BB 93     		call ROZHOD2
2259  919A 7E           		ld a,(hl)
2260  919B 23           		inc hl
2261  919C 66           		ld h,(hl)
2262  919D 6F           		ld l,a
2263  919E EB           		ex de,hl
2264  919F D5           		push de
2265  91A0 21 91 91     		ld hl,DIRTMP
2266  91A3
2267  91A3
2268  91A3 01 04 00     		ld bc,4
2269  91A6 ED B0        		ldir
2270  91A8
2271  91A8 CD 58 99     		call dospage
2272  91AB
2273  91AB E1           		pop hl
2274  91AC 3E 01        		ld a,1
2275  91AE CD B1 01     		call $01b1
2276  91B1 CD 68 99     		call basicpage
2277  91B4 C9           		ret
2278  91B5
2279  91B5
2280  91B5 01 00        pozicel	defw $01
2281  91B7 01 28        pozice2 defw 40* 256 + 1
2282  91B9
2283  91B9 02 40        adrl	defw $4000+2
2284  91BB 52 40        adrr 	defw $4000+2+80
2285  91BD
2286  91BD              changewin
2287  91BD 3E 00        		ld a,0
2288  91BF CD 8C 93     		call writecur
2289  91C2 3A 12 80     		ld a,(OKNO)
2290  91C5 EE 10        		xor 16
2291  91C7 32 12 80     		ld (OKNO),a
2292  91CA 3E 20        		ld a,32
2293  91CC CD 8C 93     		call writecur
2294  91CF
2295  91CF CD 58 99     		call dospage
2296  91D2
2297  91D2 21 21 80     		ld hl,pathl
2298  91D5 CD BB 93     		call ROZHOD2
2299  91D8 7E           		ld a,(hl)
2300  91D9 23           		inc hl
2301  91DA 66           		ld h,(hl)
2302  91DB 6F           		ld l,a
2303  91DC
2304  91DC AF           		xor a
2305  91DD CD B1 01     		call $01b1
2306  91E0
2307  91E0 CD 68 99     		call basicpage
2308  91E3
2309  91E3
2310  91E3 C3 84 83     		jp loop0
2311  91E6
2312  91E6              bufscr equ $e000
2313  91E6              ;Uloží obrazovku do banky 19 ZX Next. Ukládají se spodní dvě třetiny obrazovky,
2314  91E6              ;a celé atributy. Banka 19 se stránkuje od adresy $e000
2315  91E6              savescr
2316  91E6 ED 91 57 13  		nextreg $57,19				;Stránka na uložení VideoRam
2317  91EA 21 00 40     		ld hl,16384
2318  91ED 11 00 E0     		ld de,bufscr
2319  91F0 01 00 14     		ld bc,32*160
2320  91F3 ED B0        		ldir
2321  91F5 ED 91 57 01  		nextreg $57,1				;Nastránkuj zpátky
2322  91F9 C9           		ret
2323  91FA
2324  91FA              ;Obnovení spodních dvou třetin obrazovky z 19 stárnky ZX Next.
2325  91FA              loadscr
2326  91FA ED 91 57 13  		nextreg $57,19
2327  91FE 21 00 E0     		ld hl,bufscr
2328  9201 11 00 40     		ld de,16384
2329  9204 01 00 14     		ld bc,32*160
2330  9207 ED B0        		ldir
2331  9209 ED 91 57 01  		nextreg $57,1
2332  920D C9           		ret
2333  920E              DDDD
2334  920E              down
2335  920E 21 17 80     		ld hl,POSKURZL
2336  9211 CD B3 93     		call ROZHOD
2337  9214 7E           		ld a,(hl)
2338  9215 FE 1A        		cp 26
2339  9217 28 5B        		jr z,down0
2340  9219 F5           		push af
2341  921A
2342  921A 21 1D 80     		ld hl,STARTWINL
2343  921D CD BB 93     		call ROZHOD2
2344  9220 7E           		ld a,(hl)
2345  9221 23           		inc hl
2346  9222 66           		ld h,(hl)
2347  9223 6F           		ld l,a
2348  9224 F1           		pop af
2349  9225 5F           		ld e,a
2350  9226 16 00        		ld d,0
2351  9228 19           		add hl,de
2352  9229 E5           		push hl
2353  922A 21 D1 9A     		ld hl,ALLFILES
2354  922D
2355  922D CD BB 93     		call ROZHOD2
2356  9230 7E           		ld a,(hl)
2357  9231 23           		inc hl
2358  9232 66           		ld h,(hl)
2359  9233 6F           		ld l,a
2360  9234 2B           		dec hl
2361  9235 D1           		pop de
2362  9236 B7           		or a
2363  9237 ED 52        		sbc hl,de
2364  9239 CA 84 83     		jp z,loop0
2365  923C
2366  923C
2367  923C
2368  923C 3E 00        		ld a,0
2369  923E CD 8C 93     		call writecur
2370  9241
2371  9241 21 17 80     		ld hl,POSKURZL
2372  9244 CD B3 93     		call ROZHOD
2373  9247
2374  9247 34           		inc (hl)
2375  9248 21 19 80     		ld hl,ALLPOSL
2376  924B CD BB 93     		call ROZHOD2
2377  924E E5           		push hl
2378  924F 7E           		ld a,(hl)
2379  9250 23           		inc hl
2380  9251 66           		ld h,(hl)
2381  9252 6F           		ld l,a
2382  9253 D1           		pop de
2383  9254 EB           		ex de,hl
2384  9255 13           		inc de
2385  9256 73           		ld (hl),e
2386  9257 23           		inc hl
2387  9258 72           		ld (hl),d
2388  9259
2389  9259
2390  9259 21 B9 91     		ld hl,adrl
2391  925C CD BB 93     		call ROZHOD2
2392  925F 7E           		ld a,(hl)
2393  9260 23           		inc hl
2394  9261 66           		ld h,(hl)
2395  9262 6F           		ld l,a
2396  9263 22 46 94     		ld (adrs+1),hl
2397  9266
2398  9266 CD F6 90     		call getroot
2399  9269
2400  9269 CD EB 93     		call showwin
2401  926C 3E 20        		ld a,32
2402  926E CD 8C 93     		call writecur
2403  9271 C3 84 83     		jp loop0
2404  9274
2405  9274              down0
2406  9274 F5           		push af
2407  9275
2408  9275 21 1D 80     		ld hl,STARTWINL
2409  9278 CD BB 93     		call ROZHOD2
2410  927B 7E           		ld a,(hl)
2411  927C 23           		inc hl
2412  927D 66           		ld h,(hl)
2413  927E 6F           		ld l,a
2414  927F F1           		pop af
2415  9280 5F           		ld e,a
2416  9281 16 00        		ld d,0
2417  9283 19           		add hl,de
2418  9284 E5           		push hl
2419  9285 21 D1 9A     		ld hl,ALLFILES
2420  9288
2421  9288 CD BB 93     		call ROZHOD2
2422  928B 7E           		ld a,(hl)
2423  928C 23           		inc hl
2424  928D 66           		ld h,(hl)
2425  928E 6F           		ld l,a
2426  928F 2B           		dec hl
2427  9290 D1           		pop de
2428  9291 B7           		or a
2429  9292 ED 52        		sbc hl,de
2430  9294 CA 84 83     		jp z,loop0
2431  9297
2432  9297
2433  9297
2434  9297
2435  9297
2436  9297 21 19 80     		ld hl,ALLPOSL
2437  929A CD BB 93     		call ROZHOD2
2438  929D E5           		push hl
2439  929E 7E           		ld a,(hl)
2440  929F 23           		inc hl
2441  92A0 66           		ld h,(hl)
2442  92A1 6F           		ld l,a
2443  92A2
2444  92A2 E5           		push hl
2445  92A3 21 E8 92     		ld hl,downall
2446  92A6 CD BB 93     		call ROZHOD2
2447  92A9 7E           		ld a,(hl)
2448  92AA 23           		inc hl
2449  92AB 66           		ld h,(hl)
2450  92AC 6F           		ld l,a
2451  92AD D1           		pop de
2452  92AE EB           		ex de,hl
2453  92AF
2454  92AF B7           		or a
2455  92B0 ED 52        		sbc hl,de
2456  92B2 19           		add hl,de
2457  92B3 D1           		pop de
2458  92B4 CA 84 83     		jp z,loop0
2459  92B7
2460  92B7 EB           		ex de,hl
2461  92B8 13           		inc de
2462  92B9 73           		ld (hl),e
2463  92BA 23           		inc hl
2464  92BB 72           		ld (hl),d
2465  92BC
2466  92BC 21 1D 80     		ld hl,STARTWINL
2467  92BF CD BB 93     		call ROZHOD2
2468  92C2 E5           		push hl
2469  92C3 7E           		ld a,(hl)
2470  92C4 23           		inc hl
2471  92C5 66           		ld h,(hl)
2472  92C6 6F           		ld l,a
2473  92C7 D1           		pop de
2474  92C8
2475  92C8 EB           		ex de,hl
2476  92C9 13           		inc de
2477  92CA 73           		ld (hl),e
2478  92CB 23           		inc hl
2479  92CC 72           		ld (hl),d
2480  92CD
2481  92CD 21 B9 91     		ld hl,adrl
2482  92D0 CD BB 93     		call ROZHOD2
2483  92D3 7E           		ld a,(hl)
2484  92D4 23           		inc hl
2485  92D5 66           		ld h,(hl)
2486  92D6 6F           		ld l,a
2487  92D7 22 46 94     		ld (adrs+1),hl
2488  92DA
2489  92DA CD F6 90     		call getroot
2490  92DD
2491  92DD              DDD
2492  92DD CD EB 93     		call showwin
2493  92E0 3E 20        		ld a,32
2494  92E2 CD 8C 93     		call writecur
2495  92E5 C3 84 83     		jp loop0
2496  92E8
2497  92E8 00 00 00 00  downall	defw 0, 0
2498  92EC
2499  92EC              up
2500  92EC 21 17 80     		ld hl,POSKURZL
2501  92EF CD B3 93     		call ROZHOD
2502  92F2 7E           		ld a,(hl)
2503  92F3 B7           		or a
2504  92F4 28 38        		jr z,up0
2505  92F6
2506  92F6 3E 00        		ld a,0
2507  92F8 CD 8C 93     		call writecur
2508  92FB 21 17 80     		ld hl,POSKURZL
2509  92FE CD B3 93     		call ROZHOD
2510  9301 35           		dec (hl)
2511  9302
2512  9302
2513  9302 21 19 80     		ld hl,ALLPOSL
2514  9305 CD BB 93     		call ROZHOD2
2515  9308 E5           		push hl
2516  9309 7E           		ld a,(hl)
2517  930A 23           		inc hl
2518  930B 66           		ld h,(hl)
2519  930C 6F           		ld l,a
2520  930D D1           		pop de
2521  930E EB           		ex de,hl
2522  930F 1B           		dec de
2523  9310 73           		ld (hl),e
2524  9311 23           		inc hl
2525  9312 72           		ld (hl),d
2526  9313
2527  9313
2528  9313 21 B9 91     		ld hl,adrl
2529  9316 CD BB 93     		call ROZHOD2
2530  9319 7E           		ld a,(hl)
2531  931A 23           		inc hl
2532  931B 66           		ld h,(hl)
2533  931C 6F           		ld l,a
2534  931D 22 46 94     		ld (adrs+1),hl
2535  9320
2536  9320 CD F6 90     		call getroot
2537  9323
2538  9323
2539  9323 CD EB 93     		call showwin
2540  9326 3E 20        		ld a,32
2541  9328 CD 8C 93     		call writecur
2542  932B C3 84 83     		jp loop0
2543  932E
2544  932E              up0
2545  932E              UP0
2546  932E
2547  932E 21 21 80     		ld hl,pathl
2548  9331 CD BB 93     		call ROZHOD2
2549  9334 7E           		ld a,(hl)
2550  9335 23           		inc hl
2551  9336 66           		ld h,(hl)
2552  9337 6F           		ld l,a
2553  9338 11 03 00     		ld de,3
2554  933B 19           		add hl,de
2555  933C 7E           		ld a,(hl)
2556  933D FE FF        		cp 255
2557  933F 28 07        		jr z,upzero
2558  9341 3E 01        		ld a,1
2559  9343 32 58 93     		ld (kolik+1),a
2560  9346 18 04        		jr opcont
2561  9348 AF           upzero	xor a
2562  9349 32 58 93     		ld (kolik+1),a
2563  934C
2564  934C              opcont
2565  934C 21 1D 80     		ld hl,STARTWINL
2566  934F CD BB 93     		call ROZHOD2
2567  9352 E5           		push hl
2568  9353 7E           		ld a,(hl)
2569  9354 23           		inc hl
2570  9355 66           		ld h,(hl)
2571  9356 6F           		ld l,a
2572  9357 11 00 00     kolik	ld de,0
2573  935A B7           		or a
2574  935B 22 67 93     		ld (usavehl+1),hl
2575  935E ED 52        		sbc hl,de
2576  9360              		;add hl,de
2577  9360 D1           		pop de
2578  9361 7D           		ld a,l
2579  9362 B4           		or h
2580  9363 CA 84 83     		jp z,loop0
2581  9366 21 00 00     usavehl	ld hl,0
2582  9369              		;or a
2583  9369              		;sbc hl,bc
2584  9369 EB           		ex de,hl
2585  936A 1B           		dec de
2586  936B 73           		ld (hl),e
2587  936C 23           		inc hl
2588  936D 72           		ld (hl),d
2589  936E
2590  936E
2591  936E 21 B9 91     		ld hl,adrl
2592  9371 CD BB 93     		call ROZHOD2
2593  9374 7E           		ld a,(hl)
2594  9375 23           		inc hl
2595  9376 66           		ld h,(hl)
2596  9377 6F           		ld l,a
2597  9378 22 46 94     		ld (adrs+1),hl
2598  937B
2599  937B CD F6 90     		call getroot
2600  937E
2601  937E CD EB 93     		call showwin
2602  9381 3E 20        		ld a,32
2603  9383 CD 8C 93     		call writecur
2604  9386
2605  9386
2606  9386 C3 84 83     		jp loop0
2607  9389              KL
2608  9389 00           klavesa	defb 0
2609  938A
2610  938A 00 00        leftpos	defw	0
2611  938C
2612  938C              writecur
2613  938C 32 AA 93     		ld (curcolor+1),a
2614  938F 21 13 80     		ld hl,KURZL
2615  9392 CD BB 93     		call ROZHOD2
2616  9395
2617  9395 7E           		ld a,(hl)
2618  9396 23           		inc hl
2619  9397 66           		ld h,(hl)
2620  9398 6F           		ld l,a
2621  9399 23           		inc hl
2622  939A E5           		push hl
2623  939B 21 17 80     		ld hl,POSKURZL
2624  939E CD B3 93     		call ROZHOD
2625  93A1 7E           		ld a,(hl)
2626  93A2 5F           		ld e,a
2627  93A3 16 A0        		ld d,160
2628  93A5 ED 30        		mul d,e
2629  93A7
2630  93A7 E1           		pop hl
2631  93A8 19           		add hl,de
2632  93A9
2633  93A9 3E 20        curcolor ld a,32
2634  93AB 06 26        		ld b,38
2635  93AD 77           wr0		ld (hl),a
2636  93AE 23           		inc hl
2637  93AF 23           		inc hl
2638  93B0 10 FB        		djnz wr0
2639  93B2 C9           		ret
2640  93B3
2641  93B3 3A 12 80     ROZHOD   ld   a,(OKNO)
2642  93B6 CB 67                 bit  4,a
2643  93B8 C8                    ret  z
2644  93B9 23                    inc  hl
2645  93BA C9                    ret
2646  93BB
2647  93BB 3A 12 80     ROZHOD2  ld   a,(OKNO)
2648  93BE CB 67                 bit  4,a
2649  93C0 C8                    ret  z
2650  93C1 23                    inc  hl
2651  93C2 23                    inc  hl
2652  93C3 C9                    ret
2653  93C4
2654  93C4
2655  93C4              ConvertRomCharTo4bpp:
2656  93C4 C5                   push    bc
2657  93C5 01 FF 08             ld      bc,$08FF
2658  93C8              .lineLoop:
2659  93C8 7E                   ld      a,(hl)
2660  93C9 23                   inc     hl
2661  93CA E5                   push    hl
2662  93CB CD D3 93             call    .convert8pixels
2663  93CE E1                   pop     hl
2664  93CF 10 F7                djnz    .lineLoop
2665  93D1 C1                   pop     bc
2666  93D2 C9                   ret
2667  93D3              .convert8pixels:
2668  93D3 CD D6 93             call    .convert4pixels
2669  93D6              .convert4pixels:
2670  93D6 CD D9 93             call    .convert2pixels
2671  93D9              .convert2pixels:
2672  93D9 07                   rlca
2673  93DA 07                   rlca
2674  93DB F5                   push    af
2675  93DC E6 03                and     3
2676  93DE 21 E7 93             ld      hl,.pixelTable
2677  93E1 ED 31                add     hl,a
2678  93E3 ED A0                ldi
2679  93E5 F1                   pop     af
2680  93E6 C9                   ret
2681  93E7              .pixelTable:
2682  93E7 00 03 30 33         DB      $00, $03, $30, $33
2683  93EB
2684  93EB
2685  93EB              showwin
2686  93EB
2687  93EB 21 1D 80     		ld hl,STARTWINL
2688  93EE CD BB 93     		call ROZHOD2
2689  93F1 7E           		ld a,(hl)
2690  93F2 23           		inc hl
2691  93F3 66           		ld h,(hl)
2692  93F4 6F           		ld l,a
2693  93F5
2694  93F5 3E 02        		ld a,2
2695  93F7 32 40 94     		ld (ypos+1),a
2696  93FA E5           		push hl
2697  93FB 21 D1 9A     		ld hl,ALLFILES
2698  93FE CD BB 93     		call ROZHOD2
2699  9401 7E           		ld a,(hl)
2700  9402 23           		inc hl
2701  9403 66           		ld h,(hl)
2702  9404 6F           		ld l,a
2703  9405 44           		ld b,h
2704  9406 4D           		ld c,l
2705  9407
2706  9407 0B           		dec bc
2707  9408 60           		ld h,b
2708  9409 69           		ld l,c
2709  940A 11 1C 00     		ld de,28
2710  940D B7           		or a
2711  940E ED 52        		sbc hl,de
2712  9410 38 03        		jr c,SSS
2713  9412 01 1B 00     		ld bc,27
2714  9415
2715  9415
2716  9415 E1           SSS		pop hl
2717  9416              showloop
2718  9416 E5           		push hl
2719  9417 C5           		push bc
2720  9418 23           		inc hl
2721  9419 CD DB 94     		call find83
2722  941C CD AC 9A     		call BUFF83
2723  941F
2724  941F 2A F6 94     		ld hl,(foundfile)
2725  9422 CB 7E        		bit 7,(hl)		;testuj jestli je soubor označený
2726  9424 28 07        		jr z,nonselect
2727  9426 3E 50        		ld a,80
2728  9428 32 59 94     		ld (inkcolor+1),a
2729  942B 18 05        		jr isselect
2730  942D              nonselect
2731  942D 3E 00        		ld a,0
2732  942F 32 59 94     		ld (inkcolor+1),a
2733  9432              isselect
2734  9432
2735  9432
2736  9432
2737  9432 2A 03 95     		ld hl,(TMP83+11)
2738  9435 22 7F 94     		ld (velikost+1),hl
2739  9438 C1           		pop bc
2740  9439 E1           		pop hl
2741  943A E5           		push hl
2742  943B C5           		push bc
2743  943C
2744  943C CD 37 9A     		call FINDLFN
2745  943F              SSSS
2746  943F 1E 02        ypos	ld e,2
2747  9441 16 A0        		ld d,80 * 2
2748  9443 ED 30        		mul d,e
2749  9445 21 02 40     adrs	ld hl,$4000 + 2
2750  9448
2751  9448 19           		add hl,de
2752  9449 EB           		ex de,hl
2753  944A 21 D7 9A     		ld hl,LFNNAME
2754  944D
2755  944D 01 1F 00     		ld bc,31
2756  9450 7E           shw0	ld a,(hl)
2757  9451 FE FF        		cp 255
2758  9453 28 0C        		jr z,shw01
2759  9455 12           		ld (de),a
2760  9456 13           		inc de
2761  9457 23           		inc hl
2762  9458 3E 00        inkcolor ld a,0
2763  945A 12           		ld (de),a
2764  945B 13           		inc de
2765  945C 0B           		dec bc
2766  945D 78           		ld a,b
2767  945E B1           		or c
2768  945F 20 EF        		jr nz,shw0
2769  9461
2770  9461              shw01
2771  9461 21 FF 94     		ld hl,TMP83 +7
2772  9464 CB 7E        		bit 7,(hl)
2773  9466 28 16        		jr z,shw20
2774  9468
2775  9468 21 C7 94     dir		ld hl,dirext
2776  946B 01 07 00     		ld bc,5+2
2777  946E 7E           shw1	ld a,(hl)
2778  946F
2779  946F 12           		ld (de),a
2780  9470 13           		inc de
2781  9471 23           		inc hl
2782  9472 3A 59 94     		ld a,(inkcolor+1)
2783  9475 12           		ld (de),a
2784  9476 13           		inc de
2785  9477 0B           		dec bc
2786  9478 78           		ld a,b
2787  9479 B1           		or c
2788  947A 20 F2        		jr nz,shw1
2789  947C 18 38        		jr shw3
2790  947E
2791  947E
2792  947E              shw20
2793  947E 21 00 00     velikost ld hl,0
2794  9481
2795  9481
2796  9481 D5           		push de
2797  9482 CD 2A 91     		call NUM
2798  9485 21 21 91     		ld hl,NUMBUF
2799  9488
2800  9488 06 05        		ld b,5
2801  948A 7E           vel1	ld a,(hl)
2802  948B FE 30        		cp "0"
2803  948D 20 05        		jr nz,vel2
2804  948F 36 20        		ld (hl)," "
2805  9491 23           		inc hl
2806  9492 10 F6        		djnz vel1
2807  9494 D1           vel2	pop de
2808  9495 21 21 91     		ld hl,NUMBUF
2809  9498 06 05        shw2	ld b,5
2810  949A 7E           sh		ld a,(hl)
2811  949B 12           		ld (de),a
2812  949C 3A 59 94     		ld a,(inkcolor+1)
2813  949F 13           		inc de
2814  94A0 12           		ld (de),a
2815  94A1 13           		inc de
2816  94A2 23           		inc hl
2817  94A3 10 F5        		djnz sh
2818  94A5
2819  94A5 3E 6B        		ld a,"k"
2820  94A7 12           		ld (de),a
2821  94A8 13           		inc de
2822  94A9 3A 59 94     		ld a,(inkcolor+1)
2823  94AC 12           		ld (de),a
2824  94AD 13           		inc de
2825  94AE 3E 42        		ld a,"B"
2826  94B0 12           		ld (de),a
2827  94B1 13           		inc de
2828  94B2 3A 59 94     		ld a,(inkcolor+1)
2829  94B5 12           		ld (de),a
2830  94B6 C1           shw3	pop bc
2831  94B7 E1           		pop hl
2832  94B8 23           		inc hl
2833  94B9
2834  94B9 3A 40 94     		ld a,(ypos+1)
2835  94BC 3C           		inc a
2836  94BD 32 40 94     		ld (ypos+1),a
2837  94C0 0B           		dec bc
2838  94C1 78           		ld a,b
2839  94C2 B1           		or c
2840  94C3 C2 16 94     		jp nz,showloop
2841  94C6
2842  94C6
2843  94C6 C9           		ret
2844  94C7
2845  94C7 20 20 3C 44  dirext	defb "  <DIR>",0
2845  94CB 49 52 3E 00
2846  94CF
2847  94CF              ; Násobení HL x B
2848  94CF              ; Vysledek HL
2849  94CF 55           mull		ld d,l		;vynásob spodní byty
2850  94D0 58           			ld e,b		;
2851  94D1 ED 30        			mul d,e		;vysledek je v de
2852  94D3 EB           			ex de,hl	;vysledek je v hl
2853  94D4 58           			ld e,b		;násobitel do e
2854  94D5 ED 30        			mul d,e		;vynásob
2855  94D7 7B           			ld a,e		;do akumulátoru hoď výsledek (spodní byte)
2856  94D8 84           			add a,h
2857  94D9 67           			ld h,a		;konečný výsledek je v HL
2858  94DA C9           			ret
2859  94DB
2860  94DB
2861  94DB              ;HL ... pozice
2862  94DB              find83
2863  94DB 06 0D        		ld b,13
2864  94DD CD CF 94     		call mull
2865  94E0 11 00 A0     		ld de,$a000
2866  94E3 19           		add hl,de
2867  94E4
2868  94E4 CD AC 9A     		call BUFF83
2869  94E7 22 F6 94     		ld (foundfile),hl
2870  94EA 11 F8 94     		ld de,TMP83
2871  94ED 01 0D 00     		ld bc,13
2872  94F0 ED B0        		ldir
2873  94F2 CD BD 9A     		call NOBUFF83
2874  94F5 C9           		ret
2875  94F6              FFF
2876  94F6 00 00        foundfile	defw 0
2877  94F8 00 00 00...  TMP83	ds 13
2878  9505              INKEY
2879  9505 AF           		xor  a
2880  9506 32 2C 95              ld   (aLAST_KEY+1),a
2881  9509 FB           		ei
2882  950A 76           		 halt
2883  950B
2884  950B              ahl0
2885  950B CD 3E 95     		 call KEYSCAN
2886  950E
2887  950E 7B           		 ld   a,e
2888  950F 3C                    inc  a
2889  9510 28 F3                 jr   z,INKEY
2890  9512 7A                    ld   a,d
2891  9513 21 70 95              ld   hl,SYMTAB
2892  9516 FE 18                 cp   $18
2893  9518 28 0A                 jr   z,aHLSM2
2894  951A 21 98 95              ld   hl,CAPSTAB
2895  951D FE 27                 cp   $27
2896  951F 28 03                 jr   z,aHLSM2
2897  9521 21 BF 95              ld   hl,NORMTAB
2898  9524 16 00        aHLSM2    ld   d,0
2899  9526 19                    add  hl,de
2900  9527 7E                    ld   a,(hl)
2901  9528 B7                    or   a
2902  9529 28 DA                 jr   z,INKEY
2903  952B
2904  952B 06 00        aLAST_KEY ld   b,0
2905  952D B8                    cp   b
2906  952E 28 05                 jr   z,aSEDI_KEY
2907  9530
2908  9530 06 03                 ld   b,3
2909  9532 76           aLOOP_LST halt
2910  9533 10 FD                 djnz aLOOP_LST
2911  9535              aSEDI_KEY
2912  9535 32 2C 95              ld   (aLAST_KEY+1),a
2913  9538 F5           		push af
2914  9539 CD E7 95     		call beepk
2915  953C F1           		pop af
2916  953D C9           		ret
2917  953E
2918  953E              ;KeyScan od Busyho z MRSu
2919  953E 2E 2F        KEYSCAN  ld   l,47			;testovani klavesnice
2920  9540 11 FF FF              ld   de,65535
2921  9543 01 FE FE              ld   bc,65278
2922  9546 ED 78        KEYLINE  in   a,(c)
2923  9548 2F                    cpl
2924  9549 E6 1F                 and  31
2925  954B 28 0E                 jr   z,KEYDONE
2926  954D 67                    ld   h,a
2927  954E 7D                    ld   a,l
2928  954F 14           KEY3KEYS inc  d
2929  9550 C0                    ret  nz
2930  9551 D6 08        KEYBITS  sub  8
2931  9553 CB 3C                 srl  h
2932  9555 30 FA                 jr   nc,KEYBITS
2933  9557 53                    ld   d,e
2934  9558 5F                    ld   e,a
2935  9559 20 F4                 jr   nz,KEY3KEYS
2936  955B 2D           KEYDONE  dec  l
2937  955C CB 00                 rlc  b
2938  955E 38 E6                 jr   c,KEYLINE
2939  9560 7A                    ld   a,d
2940  9561 3C                    inc  a
2941  9562 C8                    ret  z
2942  9563 FE 28                 cp   40
2943  9565 C8                    ret  z
2944  9566 FE 19                 cp   25
2945  9568 C8                    ret  z
2946  9569 7B                    ld   a,e
2947  956A 5A                    ld   e,d
2948  956B 57                    ld   d,a
2949  956C FE 18                 cp   24
2950  956E C9                    ret
2951  956F 00           keysound db 0				;key sound 0= yes,1= no, klavesnicove echo
2952  9570 2A 5E 5B 26  SYMTAB   db "*^[&%>}/"
2952  9574 25 3E 7D 2F
2953  9578 2C 2D 5D 27           db ",-]'$<{?"
2953  957C 24 3C 7B 3F
2954  9580 2E 2B 7F 28           db ".+($"
2954  9584 24
2955  9585 C8                    db 200
2956  9586 2F 20                 db '/',' '
2957  9588 00                    db 0
2958  9589 3D 3B 29 40           db "=;)@"
2959  958D C9                    db 201
2960  958E 7C 3A                 db "|:"
2961  9590 20 0D 22              db 32,13,34
2962  9593 5F 21                 db "_!"
2963  9595 C7                    db 199
2964  9596 7E 00                 db "~",0
2965  9598
2966  9598 42 48 59     CAPSTAB  db "BHY"
2967  959B 0A 08                 db 10,8
2968  959D 54 47 56              db "TGV"
2969  95A0 4E 4A 55              db "NJU"
2970  95A3 0B 05                 db 11,5
2971  95A5 52 46 43              db "RFC"
2972  95A8 4D 4B 49              db "MKI"
2973  95AB 09 04                 db 9,4
2974  95AD 45 44 58              db "EDX"
2975  95B0 02                    db 2
2976  95B1 4C 4F                 db "LO"
2977  95B3 0F 06                 db 15,6
2978  95B5 57 53 5A              db "WSZ"
2979  95B8 01 0D 50              db 1,13,"P"
2980  95BB 0C 07                 db 12,7
2981  95BD 51 41                 db "QA"
2982  95BF
2983  95BF 62 68 79 36  NORMTAB  db "bhy65tgv"
2983  95C3 35 74 67 76
2984  95C7 6E 6A 75 37           db "nju74rfc"
2984  95CB 34 72 66 63
2985  95CF 6D 6B 69 38           db "mki83edx"
2985  95D3 33 65 64 78
2986  95D7 00                    db 0
2987  95D8 6C 6F 39 32           db "lo92wsz"
2987  95DC 77 73 7A
2988  95DF 20 0D                 db 32,13
2989  95E1 70 30 31 71           db "p01qa"
2989  95E5 61
2990  95E6 00                    db 0
2991  95E7
2992  95E7 3A 6F 95     beepk		ld a,(keysound)		;Busyho nahradni rutina,kratsi
2993  95EA B7           		or a
2994  95EB C0           		ret nz
2995  95EC 3A FF 95     		ld a,(BORDER)
2996  95EF 5F           		ld e,a
2997  95F0 06 10        		ld b,$10
2998  95F2 80           		add a,b
2999  95F3              ;		ld a,$10+border
3000  95F3 D3 FE        		out ($fe),a
3001  95F5 06 1C        		ld b,$1c
3002  95F7 10 FE        beepk1		djnz beepk1
3003  95F9 3E 08        		ld a,$08
3004  95FB 83           		add a,e
3005  95FC              ;		ld a,$08+border
3006  95FC D3 FE        		out ($fe),a
3007  95FE C9           		ret
3008  95FF 01           BORDER   db 1				;okraj
3009  9600              info
3010  9600 CD E6 91     		call savescr
3011  9603 21 0A 0A     		ld hl,10 * 256 + 10
3012  9606 01 0A 3C     		ld bc,60 * 256 + 10
3013  9609 3E 10        		ld a,16
3014  960B CD B7 97     		call window
3015  960E
3016  960E 21 0B 0B     		ld hl,11*256+11
3017  9611 3E 10        		ld a,16
3018  9613 11 4F 96     		ld de,calmcommander
3019  9616 CD 97 97     		call print
3020  9619
3021  9619 21 0D 0B     		ld hl,11*256+13
3022  961C 3E 10        		ld a,16
3023  961E 11 7B 96     		ld de,info1txt
3024  9621 CD 97 97     		call print
3025  9624
3026  9624 21 0F 0B     		ld hl,11*256+15
3027  9627 3E 10        		ld a,16
3028  9629 11 9F 96     		ld de,info2txt
3029  962C CD 97 97     		call print
3030  962F
3031  962F 21 10 0B     		ld hl,11*256+16
3032  9632 3E 10        		ld a,16
3033  9634 11 BD 96     		ld de,info3txt
3034  9637 CD 97 97     		call print
3035  963A
3036  963A
3037  963A 21 14 2F     		ld hl,47*256+20
3038  963D 3E 20        		ld a,32
3039  963F 11 62 96     		ld de,breaktxt
3040  9642 CD 97 97     		call print
3041  9645
3042  9645              info0
3043  9645 CD 05 95     		call INKEY
3044  9648 FE 01        		cp 1
3045  964A CA FA 91     		jp z,loadscr
3046  964D 18 F6        		jr info0
3047  964F
3048  964F
3049  964F 43 41 4C 4D  calmcommander	defb "CALM COMMANDER 1.0",0
3049  9653 20 43 4F 4D
3049  9657 4D 41 4E 44
3049  965B 45 52 20 31
3049  965F 2E 30 00
3050  9662 42 52 45 41  breaktxt defb "BREAK: close this window",0
3050  9666 4B 3A 20 63
3050  966A 6C 6F 73 65
3050  966E 20 74 68 69
3050  9672 73 20 77 69
3050  9676 6E 64 6F 77
3050  967A 00
3051  967B 46 69 6C 65  info1txt defb "File manager for ZX Spectrum Next. ",0
3051  967F 20 6D 61 6E
3051  9683 61 67 65 72
3051  9687 20 66 6F 72
3051  968B 20 5A 58 20
3051  968F 53 70 65 63
3051  9693 74 72 75 6D
3051  9697 20 4E 65 78
3051  969B 74 2E 20 00
3052  969F 4D 61 69 6E  info2txt defb "Main program: Shrek/MB Maniax",0
3052  96A3 20 70 72 6F
3052  96A7 67 72 61 6D
3052  96AB 3A 20 53 68
3052  96AF 72 65 6B 2F
3052  96B3 4D 42 20 4D
3052  96B7 61 6E 69 61
3052  96BB 78 00
3053  96BD 42 69 67 20  info3txt defb "Big help: ped7g",0
3053  96C1 68 65 6C 70
3053  96C5 3A 20 70 65
3053  96C9 64 37 67 00
3054  96CD 20 00        info4txt defb " ",0
3055  96CF 20 00        info5txt defb " ",0
3056  96D1
3057  96D1              kresli
3058  96D1 21 01 00     		ld hl,0 * 256 + 1
3059  96D4              		;	  delka      vyska
3060  96D4 01 1B 26     		ld bc,38 * 256 + 27
3061  96D7 3E 00        		ld a,0
3062  96D9 CD B7 97     		call window
3063  96DC
3064  96DC
3065  96DC
3066  96DC 21 01 28     		ld hl,40* 256 + 1
3067  96DF              		;	  delka      vyska
3068  96DF 01 1B 26     		ld bc,38 * 256 + 27
3069  96E2 3E 00        		ld a,0
3070  96E4 CD B7 97     		call window
3071  96E7
3072  96E7 21 1E 02     		ld hl,2*256+30
3073  96EA 3E 20        		ld a,32
3074  96EC 11 4B 97     		ld de,left_txt
3075  96EF CD 97 97     		call print
3076  96F2
3077  96F2 21 1E 0A     		ld hl,10*256+30
3078  96F5 3E 20        		ld a,32
3079  96F7 11 53 97     		ld de,right_txt
3080  96FA CD 97 97     		call print
3081  96FD
3082  96FD 21 1E 13     		ld hl,19*256+30
3083  9700 3E 20        		ld a,32
3084  9702 11 5C 97     		ld de,view_txt
3085  9705 CD 97 97     		call print
3086  9708
3087  9708 21 1E 1B     		ld hl,27*256+30
3088  970B 3E 20        		ld a,32
3089  970D 11 64 97     		ld de,edit_txt
3090  9710 CD 97 97     		call print
3091  9713
3092  9713 21 1E 23     		ld hl,35*256+30
3093  9716 3E 20        		ld a,32
3094  9718 11 6C 97     		ld de,copy_txt
3095  971B CD 97 97     		call print
3096  971E
3097  971E 21 1E 2B     		ld hl,43*256+30
3098  9721 3E 20        		ld a,32
3099  9723 11 74 97     		ld de,move_txt
3100  9726 CD 97 97     		call print
3101  9729
3102  9729 21 1E 33     		ld hl,51*256+30
3103  972C 3E 20        		ld a,32
3104  972E 11 7C 97     		ld de,mkdir_txt
3105  9731 CD 97 97     		call print
3106  9734
3107  9734 21 1E 3C     		ld hl,60*256+30
3108  9737 3E 20        		ld a,32
3109  9739 11 85 97     		ld de,delete_txt
3110  973C CD 97 97     		call print
3111  973F
3112  973F 21 1E 46     		ld hl,70*256+30
3113  9742 3E 20        		ld a,32
3114  9744 11 8F 97     		ld de,menu_txt
3115  9747 CD 97 97     		call print
3116  974A
3117  974A
3118  974A C9           		ret
3119  974B              offset	equ 3
3120  974B
3121  974B 31 3A 20 4C  left_txt defb "1: LEFT",0
3121  974F 45 46 54 00
3122  9753 32 3A 20 52  right_txt defb "2: RIGHT",0
3122  9757 49 47 48 54
3122  975B 00
3123  975C 33 3A 20 56  view_txt defb "3: VIEW",0
3123  9760 49 45 57 00
3124  9764 34 3A 20 45  edit_txt defb "4: EDIT",0
3124  9768 44 49 54 00
3125  976C 35 3A 20 43  copy_txt defb "5: COPY",0
3125  9770 4F 50 59 00
3126  9774 36 3A 20 4D  move_txt defb "6: MOVE",0
3126  9778 4F 56 45 00
3127  977C 37 3A 20 4D  mkdir_txt defb "7: MKDIR",0
3127  9780 4B 44 49 52
3127  9784 00
3128  9785 38 3A 20 44  delete_txt defb "8: DELETE",0
3128  9789 45 4C 45 54
3128  978D 45 00
3129  978F 30 3A 20 4D  menu_txt defb "0: MENU",0
3129  9793 45 4E 55 00
3130  9797
3131  9797
3132  9797
3133  9797
3134  9797              ;vstup:
3135  9797              ; HL .... XY
3136  9797              ; DE .... TEXT zakonceny 0 bytem
3137  9797              ; A ..... atribut palety
3138  9797 32 B0 97     print  ld (paleta + 1),a
3139  979A D5           		push de
3140  979B 55           		ld d,l
3141  979C 1E A0        		ld e,160
3142  979E ED 30        		mul d,e
3143  97A0 7C           		ld a,h
3144  97A1 87           		add a,a
3145  97A2 6F           		ld l,a
3146  97A3 26 00        		ld h,0
3147  97A5 19           		add hl,de
3148  97A6 11 00 40     		ld de,$4000
3149  97A9 19           		add hl,de
3150  97AA D1           		pop de
3151  97AB              print0
3152  97AB 1A           		ld a,(de)
3153  97AC B7           		or a
3154  97AD C8           		ret z
3155  97AE 77           		ld (hl),a
3156  97AF
3157  97AF 3E 00        paleta	ld a,0
3158  97B1 23           		inc hl
3159  97B2 13           		inc de
3160  97B3 77           		ld (hl),a
3161  97B4 23           		inc hl
3162  97B5 18 F4        		jr print0
3163  97B7
3164  97B7              window
3165  97B7 32 E7 97     		ld (atr1+1),a
3166  97BA 32 F2 97     		ld (atr2+1),a
3167  97BD 32 FB 97     		ld (atr3+1),a
3168  97C0 32 13 98     		ld (atr4+1),a
3169  97C3 32 23 98     		ld (atr5+1),a
3170  97C6 32 2E 98     		ld (atr6+1),a
3171  97C9 32 44 98     		ld (atr7+1),a
3172  97CC 32 4D 98     		ld (atr8+1),a
3173  97CF 32 56 98     		ld (atr9+1),a
3174  97D2
3175  97D2 5D           		ld e,l
3176  97D3 16 A0        		ld d,160
3177  97D5 ED 30        		mul d,e
3178  97D7 7C           		ld a,h
3179  97D8 87           		add a,a
3180  97D9 6F           		ld l,a
3181  97DA 26 00        		ld h,0
3182  97DC 19           		add hl,de
3183  97DD 11 00 40     		ld de,#4000
3184  97E0 19           		add hl,de		;adresa v tilemode
3185  97E1 E5           window0	push hl
3186  97E2
3187  97E2 3E 12        		ld a,18
3188  97E4 77           		ld (hl),a
3189  97E5 23           		inc hl
3190  97E6 36 00        atr1	ld (hl),0
3191  97E8 78           		ld a,b
3192  97E9 32 46 98     		ld (w5+1),a
3193  97EC 3E 10        		ld a,16
3194  97EE 23           		inc hl
3195  97EF
3196  97EF
3197  97EF 77           w2		ld (hl),a
3198  97F0 23           		inc hl
3199  97F1 36 00        atr2	ld (hl),0
3200  97F3 23           		inc hl
3201  97F4 10 F9        		djnz w2
3202  97F6 3E 13        		ld a,19
3203  97F8 77           		ld (hl),a
3204  97F9 23           		inc hl
3205  97FA
3206  97FA 36 00        atr3	ld (hl),0
3207  97FC 11 9F 00     		ld de,160-1
3208  97FF 19           		add hl,de
3209  9800
3210  9800 22 0C 98     		ld (w3+1),hl	;uloz adresu
3211  9803 E1           		pop hl
3212  9804 11 A0 00     		ld de,160
3213  9807 19           		add hl,de
3214  9808 22 1C 98     		ld (w4+1),hl
3215  980B
3216  980B 21 00 00     w3		ld hl,0
3217  980E 3E 17        		ld a,23
3218  9810 77           		ld (hl),a
3219  9811 23           		inc hl
3220  9812 36 00        atr4	ld (hl),0
3221  9814
3222  9814 11 9F 00     		ld de,160-1
3223  9817 19           		add hl,de
3224  9818 22 0C 98     		ld (w3+1),hl
3225  981B 21 00 00     w4		ld hl,0					;leva cast
3226  981E 3E 16        		ld a,22
3227  9820 77           		ld (hl),a
3228  9821 23           		inc hl
3229  9822 36 00        atr5	ld (hl),0
3230  9824 E5           		push hl
3231  9825 23           		inc hl
3232  9826 3A 46 98     		ld a,(w5+1)
3233  9829 47           		ld b,a
3234  982A 36 00        cisti	ld 	(hl),0
3235  982C 23           		inc hl
3236  982D 36 00        atr6	ld (hl),0
3237  982F 23           		inc hl
3238  9830 10 F8        		djnz cisti
3239  9832
3240  9832 E1           		pop hl
3241  9833 11 9F 00     		ld de,160-1
3242  9836 19           		add hl,de
3243  9837 22 1C 98     		ld (w4+1),hl
3244  983A 0D           		dec c
3245  983B 79           		ld a,c
3246  983C B7           		or a
3247  983D 20 CC        		jr nz,w3
3248  983F
3249  983F 3E 15        		ld a,21
3250  9841 77           		ld (hl),a
3251  9842 23           		inc hl
3252  9843 36 00        atr7	ld (hl),0
3253  9845 06 00        w5 		ld b,0
3254  9847 3E 11        		ld a,17
3255  9849 23           w6		inc hl
3256  984A 77           		ld (hl),a
3257  984B 23           		inc hl
3258  984C 36 00        atr8	ld (hl),0
3259  984E 10 F9        		djnz w6
3260  9850 23           		inc hl
3261  9851 3E 14        		ld a,20
3262  9853 77           		ld (hl),a
3263  9854 23           		inc hl
3264  9855 36 00        atr9	ld (hl),0
3265  9857 C9           		ret
3266  9858
3267  9858
3268  9858
3269  9858
3270  9858
3271  9858              reload_dir
3272  9858
3273  9858 F3           			di
3274  9859
3275  9859 21 FF 83     			ld hl,numsel
3276  985C CD BB 93     			call ROZHOD2
3277  985F AF           			xor a
3278  9860 77           			ld (hl),a
3279  9861 23           			inc hl
3280  9862 77           			ld (hl),a
3281  9863
3282  9863
3283  9863 CD AC 9A     			call BUFF83
3284  9866 21 00 A0     			ld hl,#a000
3285  9869 11 01 A0     			ld de,#a001
3286  986C 01 00 04     			ld bc,1024
3287  986F AF           			xor a
3288  9870 77           			ld (hl),a
3289  9871 ED B0        			ldir
3290  9873
3291  9873
3292  9873 01 FD 7F     			ld bc,port1       ;the horizontal ROM switch/RAM
3293  9876                                              ;switch I/O ad dress
3294  9876 3A F3 9B                 ld a,(bankm)      ;sys tem vari able that holds cur rent
3295  9879                                              ;switch state
3296  9879 CB A7                    res 4,a           ;move right to left in hor i zon tal
3297  987B                                              ;ROM switch (3 to 2)
3298  987B
3299  987B F6 07                      or 7              ;switch in RAM page 7
3300  987D 32 F3 9B                   ld (bankm),a      ;must keep sys tem vari able up to
3301  9880                                              	                  ;date (very im por tant)
3302  9880 ED 79                      out (c),a         ;make the switch
3303  9882
3304  9882                                             ;be low BFE0h
3305  9882                                            ;in ter rupts can now be en abled
3306  9882
3307  9882 21 00 A0                   ld hl,catbuff     ;some where for DOS to put the cata
3308  9885                                              ;log
3309  9885 11 01 A0                   ld de,catbuff+1   ;
3310  9888 01 00 04                   ld bc,1024        ;max i mum (for +3DOS) is ac tu ally
3311  988B                                              ;64x13+13 = 845
3312  988B 36 00                      ld (hl),0
3313  988D ED B0                      ldir              ;make sure at least first en try is
3314  988F 11 00 A0                   ld de,catbuff     ;the lo ca tion to be filled with the
3315  9892              aNextDirItem
3316  9892 06 C8                      ld b,pocetpolozek ;the num ber of en tries in the
3317  9894                                              ;buffer
3318  9894 0E 05                      ld c,%101            ;include sys tem files in the cata
3319  9896 21 F4 9B                   ld hl,stardstar   ;the file name ("*.*")
3320  9899 CD 1E 01                   call dos_catalog  ;call the DOS en try
3321  989C              NEXT0
3322  989C
3323  989C
3324  989C 22 EF 9B     			  ld (savehl),hl
3325  989F DD 22 F1 9B  			  ld (saveix),ix
3326  98A3 78           			  ld a,b
3327  98A4 FE C8        			  cp pocetpolozek
3328  98A6 F5           			  push af
3329  98A7
3330  98A7
3331  98A7
3332  98A7
3333  98A7 21 D1 9A     			  ld hl,ALLFILES
3334  98AA CD BB 93     			  call ROZHOD2
3335  98AD 7E           			  ld a,(hl)
3336  98AE 23           			  inc hl
3337  98AF 66           			  ld h,(hl)
3338  98B0 6F           			  ld l,a
3339  98B1
3340  98B1 58           			  ld e,b
3341  98B2 16 00        			  ld d,0
3342  98B4 19           			  add hl,de
3343  98B5 2B           			  dec hl
3344  98B6 E5           			  push hl
3345  98B7 21 CD 9A     			  ld hl,ALLFILESL
3346  98BA CD BB 93     			  call ROZHOD2
3347  98BD 7E           			  ld a,(hl)
3348  98BE 23           			  inc hl
3349  98BF 66           			  ld h,(hl)
3350  98C0 6F           			  ld l,a
3351  98C1 22 C6 98     			  ld (N0+1),hl
3352  98C4 E1           			  pop hl
3353  98C5 22 00 00     N0			  ld (0),hl
3354  98C8
3355  98C8
3356  98C8
3357  98C8 E5           			push hl
3358  98C9 D5           			push de
3359  98CA C5           			push bc
3360  98CB
3361  98CB
3362  98CB 2A FF 9B     			ld hl,(dirNum)
3363  98CE 19           			add	hl,de
3364  98CF 2B           			dec hl
3365  98D0 22 FF 9B     			ld 	(dirNum),hl
3366  98D3 C1           			pop bc
3367  98D4 D1           			pop de
3368  98D5 E1           			pop hl
3369  98D6
3370  98D6
3371  98D6 3A FE 9B     			  ld a,(FILES)
3372  98D9 80           			  add a,b
3373  98DA 3D           			  dec a
3374  98DB 32 FE 9B     			  ld (FILES),a
3375  98DE F1           			  pop af
3376  98DF 38 15        			  jr c,acont
3377  98E1
3378  98E1 78           			  ld a,b
3379  98E2 B7           			  or a
3380  98E3 28 11        			  jr z,acont
3381  98E5
3382  98E5 3A 0F 80     			  ld a,(virtmem)
3383  98E8 FE 01        			  cp 1
3384  98EA 28 0A        			  jr z,acont
3385  98EC
3386  98EC CD C2 9A     			  call CountMemory
3387  98EF EB           			  ex de,hl
3388  98F0 21 0F 80     			ld hl,virtmem
3389  98F3 34           			inc (hl)
3390  98F4 18 9C        			jr aNextDirItem
3391  98F6              acont
3392  98F6 F5                       push af
3393  98F7
3394  98F7 2A FF 9B     			ld hl,(dirNum)
3395  98FA
3396  98FA
3397  98FA
3398  98FA E1                         pop hl
3399  98FB 22 FA 9B                   ld (dosret),hl    ;put it where it can be seen from
3400  98FE                                              ; NextBASIC
3401  98FE 48                         ld c,b            ;move num ber of files in cat a log to
3402  98FF                                              ;low byte of BC
3403  98FF 06 00                      ld b,0            ;this will be re turned in NextBASIC
3404  9901
3405  9901 F3                         di                ;about to ROM/RAM switch so be
3406  9902                                              ;care ful
3407  9902 C5                         push bc           ;save num ber of files
3408  9903 01 FD 7F                   ld bc,port1       ;I/O ad dress of hor i zon tal ROM/RAM
3409  9906                                              ;switch
3410  9906 3A F3 9B                   ld a,(bankm)      ;get cur rent switch state
3411  9909
3412  9909
3413  9909 CB E7                      set 4,a           ;move left to right (ROM 2 to ROM
3414  990B                                              ;3)
3415  990B E6 F8                      and #F8           ;also want RAM page 0
3416  990D 32 F3 9B                   ld (bankm),a      ;up date the sys tem vari able (very
3417  9910                                              ;im por tant)
3418  9910 ED 79                      out (c),a         ;make the switch
3419  9912 C1                         pop bc            ;get back the saved num ber of files
3420  9913 0B                         dec bc
3421  9914
3422  9914
3423  9914
3424  9914 CD AC 9A     			 call BUFF83
3425  9917              JKJK
3426  9917 21 0D A0     			 ld hl,catbuff+13
3427  991A              askon
3428  991A CD 7A 99     			call getAllLFN
3429  991D CD 94 91     			call getdir
3430  9920 2A D1 9A     			ld hl,(ALLFILES)
3431  9923 2B           			dec hl
3432  9924
3433  9924 E5           			push hl
3434  9925 21 E8 92     			ld hl,downall
3435  9928 CD BB 93     			call ROZHOD2
3436  992B 7E           			ld a,(hl)
3437  992C 23           			inc hl
3438  992D 66           			ld h,(hl)
3439  992E 6F           			ld l,a
3440  992F D1           			pop de
3441  9930 EB           			ex de,hl
3442  9931 73           			ld (hl),e
3443  9932 23           			inc hl
3444  9933 72           			ld (hl),d
3445  9934
3446  9934 21 21 80     			ld hl,pathl
3447  9937 CD BB 93     			call ROZHOD2
3448  993A 7E           			ld a,(hl)
3449  993B 23           			inc hl
3450  993C 66           			ld h,(hl)
3451  993D 6F           			ld l,a
3452  993E 11 03 00     			ld de,3
3453  9941 19           			add hl,de
3454  9942 7E           			ld a,(hl)
3455  9943 FE FF        			cp 255
3456  9945 28 04        			jr z,jetoroot
3457  9947 3E 01        			ld a,1
3458  9949 18 01        			jr nenitoroot
3459  994B AF           jetoroot	xor a
3460  994C              nenitoroot
3461  994C 32 56 99     			ld (pocatek+1),a
3462  994F
3463  994F 21 1D 80     			ld hl,STARTWINL
3464  9952 CD BB 93     			call ROZHOD2
3465  9955 36 00        pocatek		ld (hl),0
3466  9957
3467  9957 C9           			ret
3468  9958
3469  9958              dospage
3470  9958 01 FD 7F     		ld bc,port1
3471  995B 3A F3 9B             ld a,(bankm)
3472  995E CB A7                res 4,a
3473  9960 F6 07                or 7
3474  9962 32 F3 9B             ld (bankm),a
3475  9965 ED 79                out (c),a
3476  9967 C9           		ret
3477  9968
3478  9968              basicpage
3479  9968 01 FD 7F     		ld bc,port1
3480  996B 3A F3 9B             ld a,(bankm)
3481  996E CB E7                set 4,a
3482  9970 E6 F8                and #F8
3483  9972 32 F3 9B             ld (bankm),a
3484  9975 ED 79                out (c),a
3485  9977 C9           		ret
3486  9978
3487  9978
3488  9978 18 1E        lfnpage	defb 24,30
3489  997A
3490  997A              getAllLFN
3491  997A
3492  997A 21 00 00     			ld hl,0
3493  997D 22 FC 9B     			ld (numLoop),hl
3494  9980 21 00 E0     			ld hl,#e000
3495  9983 22 D9 99     			ld (InBuff+1),hl
3496  9986
3497  9986 21 78 99     			ld hl,lfnpage
3498  9989 CD B3 93     			call ROZHOD
3499  998C 7E           			ld a,(hl)
3500  998D
3501  998D              ;			ld a,24
3502  998D 32 D4 99     			ld (Page+1),a
3503  9990
3504  9990
3505  9990 CD AC 9A     			call BUFF83
3506  9993 21 0D A0     			ld hl,catbuff+#d
3507  9996 11 E0 9B     			ld de,bufftmp
3508  9999 01 0D 00     			ld bc,13
3509  999C ED B0        			ldir
3510  999E CD BD 9A     			call NOBUFF83
3511  99A1
3512  99A1 21 0D A0     			ld hl,catbuff+#d
3513  99A4 22 DE 9B     			ld (tmpname),hl
3514  99A7
3515  99A7 21 D1 9A     			ld hl,ALLFILES
3516  99AA CD BB 93     			call ROZHOD2
3517  99AD 7E           			ld a,(hl)
3518  99AE 23           			inc hl
3519  99AF 46           			ld b,(hl)
3520  99B0 4F           			ld c,a
3521  99B1
3522  99B1 C5           LFN1		push bc
3523  99B2
3524  99B2 2A FC 9B     			ld hl,(numLoop)
3525  99B5 23           			inc hl
3526  99B6 22 FC 9B     			ld 	(numLoop),hl
3527  99B9 11 98 48     lfnpos		ld de,18560+24	;pozice ve VideoRam
3528  99BC
3529  99BC F3           			di				;zakaž přerušení, jinak bude problém, nemáme nastránkovanou ZX Rom
3530  99BD
3531  99BD CD 58 99     			call dospage
3532  99C0              BFN
3533  99C0 11 E0 9B     BufferName	ld de,bufftmp			;jmeno souboru
3534  99C3 21 F4 9B     			ld hl,stardstar
3535  99C6 DD 2A EF 9B  			ld ix,(savehl)
3536  99CA 01 D7 9A     			ld bc,LFNNAME
3537  99CD CD B7 01     			call $01b7
3538  99D0
3539  99D0 CD 68 99     			call basicpage
3540  99D3
3541  99D3 3E 18        Page		ld a,24
3542  99D5 ED 92 57     			nextreg $57,a	;nastrankuj stranku s volnymi daty
3543  99D8
3544  99D8 11 00 E0     InBuff		ld de,#e000		;ukazatel na pamet v bufferu
3545  99DB 21 D7 9A     			ld hl,LFNNAME	;buffer pro LFN
3546  99DE 01 05 01     			ld bc,maxlen		;ulož 64 bytů
3547  99E1 ED B0        			ldir
3548  99E3
3549  99E3 CD AC 9A     			call BUFF83
3550  99E6 2A DE 9B     			ld hl,(tmpname)	;přesuň se na další položku v adresáři
3551  99E9 11 0D 00     			ld de,13
3552  99EC 19           			add hl,de
3553  99ED 22 DE 9B     			ld (tmpname),hl	;a ulož adresu, kde se nachází
3554  99F0 11 E0 9B     			ld de,bufftmp
3555  99F3 01 0D 00     			ld bc,13
3556  99F6 ED B0        			ldir
3557  99F8 CD BD 9A     			call NOBUFF83
3558  99FB 3A D4 99     			ld a,(Page+1)
3559  99FE ED 92 57     			nextreg $57,a
3560  9A01 2A D9 99     			ld hl,(InBuff+1)		;vypočti další adresu v bance ZX Next, kam budu ukládat
3561  9A04 11 05 01     			ld de,maxlen
3562  9A07 19           			add hl,de
3563  9A08 22 D9 99     			ld (InBuff+1),hl
3564  9A0B 11 7F FF     			ld de,#FFFF-128
3565  9A0E B7           			or a
3566  9A0F ED 52        			sbc hl,de
3567  9A11 38 0A        			jr c,contin
3568  9A13 21 D4 99     			ld hl,Page+1
3569  9A16 34           			inc (hl)
3570  9A17 21 00 E0     			ld hl,#e000
3571  9A1A 22 D9 99     			ld (InBuff+1),hl
3572  9A1D C1           contin		pop bc				;zopakuj to pro všechny soubory, které máme načtené...
3573  9A1E 0B           			dec bc
3574  9A1F 78           			ld a,b
3575  9A20 B1           			or c
3576  9A21 20 8E        			jr nz,LFN1
3577  9A23              AAA
3578  9A23 ED 91 57 01  			nextreg $57,1			;vráť zpátky stránku, kde se nachází data pro player
3579  9A27 C9           			ret
3580  9A28
3581  9A28
3582  9A28
3583  9A28              ; Input: HL = Dividend, C = Divisor, A = 0
3584  9A28              ; Output: HL = Quotient, A = Remainder
3585  9A28 AF           deleno		xor a
3586  9A29 06 10        			ld b,16
3587  9A2B              de
3588  9A2B 29           			add	hl,hl
3589  9A2C 17           			rla
3590  9A2D B9           			cp	c
3591  9A2E 38 02        			jr	c,de1
3592  9A30 91           			sub	c
3593  9A31 2C           			inc	l
3594  9A32 10 F7        de1			djnz de
3595  9A34 C9           			ret
3596  9A35
3597  9A35 00 00        addrlfn		dw 0
3598  9A37
3599  9A37              FINDLFN
3600  9A37
3601  9A37 E5           			push hl
3602  9A38
3603  9A38 21 78 99     			ld hl,lfnpage
3604  9A3B CD B3 93     			call ROZHOD
3605  9A3E 7E           			ld a,(hl)
3606  9A3F 32 66 9A     			ld (lfnroot+1),a
3607  9A42
3608  9A42 21 D7 9A     			ld hl,LFNNAME
3609  9A45 11 D8 9A     			ld de,LFNNAME+1
3610  9A48 01 05 01     			ld bc,261
3611  9A4B 3E 20        			ld a,32
3612  9A4D 77           			ld (hl),a
3613  9A4E ED B0        			ldir
3614  9A50
3615  9A50 E1           			pop hl
3616  9A51 B7           			or a
3617  9A52 11 1F 00     			ld de,31
3618  9A55 ED 52        			sbc hl,de
3619  9A57 19           			add hl,de
3620  9A58 38 07        			jr c,prvni
3621  9A5A 0E 1F        			ld c,31
3622  9A5C CD 28 9A     			call deleno
3623  9A5F 18 03        		    jr oddeleno
3624  9A61 7D           prvni		ld a,l
3625  9A62 2E 00        			ld l,0
3626  9A64
3627  9A64 F5           oddeleno	push af
3628  9A65 3E 18        lfnroot		ld a,24
3629  9A67 85           			add a,l
3630  9A68 ED 92 57     			nextreg $57,a
3631  9A6B C1           			pop bc
3632  9A6C 11 05 01     			ld de,maxlen
3633  9A6F 78           			ld a,b
3634  9A70 B7           			or a
3635  9A71 21 00 E0     			ld hl,$e000
3636  9A74 28 03        			jr z,prvnizaznam
3637  9A76              lll
3638  9A76 19           			add hl,de
3639  9A77 10 FD        			djnz lll
3640  9A79
3641  9A79              prvnizaznam
3642  9A79 22 35 9A     			ld (addrlfn),hl
3643  9A7C 11 D7 9A     			ld de,LFNNAME
3644  9A7F 01 05 01     			ld bc,maxlen
3645  9A82              popop
3646  9A82 7E           			ld a,(hl)
3647  9A83 FE FF        			cp 255
3648  9A85 28 08        			jr z,kon
3649  9A87 12           			ld (de),a
3650  9A88 23           			inc hl
3651  9A89 13           			inc de
3652  9A8A 0B           			dec bc
3653  9A8B 78           			ld a,b
3654  9A8C B1           			or c
3655  9A8D 20 F3        			jr nz,popop
3656  9A8F              kon
3657  9A8F 21 D7 9A     			ld hl,LFNNAME
3658  9A92 06 28        			ld b,40
3659  9A94              F22222
3660  9A94 7E           			ld a,(hl)
3661  9A95 FE FF        			cp 255
3662  9A97 CC A7 9A     			call z,setspace
3663  9A9A 23           			inc hl
3664  9A9B 10 F7        			djnz F22222
3665  9A9D 21 D7 9A     lfnend		ld hl,LFNNAME
3666  9AA0
3667  9AA0 11 C2 50     lfnat		ld de,20672+2
3668  9AA3 21 D7 9A     			ld hl,LFNNAME
3669  9AA6 C9           			ret
3670  9AA7
3671  9AA7              setspace
3672  9AA7 36 20        		ld (hl),32
3673  9AA9 C9           		ret
3674  9AAA
3675  9AAA 14           buffl		defb 20
3676  9AAB 15           buffr		defb 21
3677  9AAC
3678  9AAC              BUFF83
3679  9AAC E5           			push hl
3680  9AAD D5           			push de
3681  9AAE F5           			push af
3682  9AAF 21 AA 9A     			ld hl,buffl
3683  9AB2 CD B3 93     			call ROZHOD
3684  9AB5 7E           			ld a,(hl)
3685  9AB6 ED 92 55     			nextreg $55,a	;nastrankuj data pro spravne okno
3686  9AB9 F1           			pop af
3687  9ABA D1           			pop de
3688  9ABB E1           			pop hl
3689  9ABC C9           			ret
3690  9ABD
3691  9ABD              NOBUFF83
3692  9ABD ED 91 55 05  			nextreg $55,5
3693  9AC1 C9           			ret
3694  9AC2              CountMemory
3695  9AC2 11 1B 0A     			ld de,13*(pocetpolozek-1)
3696  9AC5 21 00 A0     Count11		ld hl,catbuff
3697  9AC8 19           			add hl,de
3698  9AC9 22 C6 9A     			ld (Count11+1),hl
3699  9ACC
3700  9ACC C9           			ret
3701  9ACD
3702  9ACD D1 9A D3 9A  ALLFILESL  defw ALLFILES, ALLFILES2
3703  9AD1
3704  9AD1 00 00        ALLFILES    defw 0
3705  9AD3 00 00        ALLFILES2	defw 0
3706  9AD5 00 00        ALLFILESR	defw 0
3707  9AD7 00 00 00...  LFNNAME		defs 263
3708  9BDE 00 00        tmpname		ds 2
3709  9BE0              BFT
3710  9BE0 00 00 00...  bufftmp		ds 15
3711  9BEF              M_P3DOS	equ $94
3712  9BEF 00 00        savehl		defw 0
3713  9BF1 00 00        saveix		defw 0
3714  9BF3 00           bankm       defb 0 ;  equ  #5B5C         ;sys tem vari able that holds the
3715  9BF4
3716  9BF4              stardstar:
3717  9BF4 2A 2E 3F 3F                defb "*.???",#FF
3717  9BF8 3F FF
3718  9BFA              dosret:
3719  9BFA 00 00                      defw 0
3720  9BFC 00 00        numLoop		defw 0
3721  9BFE 00           FILES    defb 0
3722  9BFF 00 00        dirNum	 defw 0
3723  9C01              tilemapPalette:
3724  9C01 03 01                        db  %000'000'11,1       ; 0 modra(paper)
3725  9C03 92 01                        db  %100'100'10,1       ; 1 light grey (25% ink)
3726  9C05 49 01                        db  %010'010'01,1       ; 2 dark grey (75% ink)
3727  9C07 B7 00                        db  %101'101'11,0       ; 0 white-blueish (ink)
3728  9C09 C4 01                        db  %110'001'00,1       ; 4 red
3729  9C0B F8 01                        db  %111'110'00,1       ; 5 yellow
3730  9C0D 10 00                        db  %000'100'00,0       ; 6 green
3731  9C0F 00 00 00...  				ds 18
3732  9C21 00 00        				db  %000'000'00,0       ; 0 modra (paper)
3733  9C23 92 01                        db  %100'100'10,1       ; 1 light grey (25% ink)
3734  9C25 49 01                        db  %010'010'01,1       ; 2 dark grey (75% ink)
3735  9C27 B7 00        				db  %101'101'11,0       ; 0 white-blueish (ink)
3736  9C29 C4 01                        db  %110'001'00,1       ; 4 red
3737  9C2B F8 01                        db  %111'110'00,1       ; 5 yellow
3738  9C2D 10 00                        db  %000'100'00,0       ; 6 green
3739  9C2F 00 00 00...  				ds 18
3740  9C41 0E 01        				db  %000'011'10,1       ; 0 modra (paper)
3741  9C43 92 01                        db  %100'100'10,1       ; 1 light grey (25% ink)
3742  9C45 49 01                        db  %010'010'01,1       ; 2 dark grey (75% ink)
3743  9C47 B7 00        				db  %101'101'11,0       ; 0 white-blueish (ink)
3744  9C49 C4 01                        db  %110'001'00,1       ; 4 red
3745  9C4B F8 01                        db  %111'110'00,1       ; 5 yellow
3746  9C4D 10 00                        db  %000'100'00,0       ; 6 green
3747  9C4F 00 00 00...  				ds 18
3748  9C61 FF 01        				db  %111'111'11,1       ; 0 modra (paper)
3749  9C63 92 01                        db  %100'100'10,1       ; 1 light grey (25% ink)
3750  9C65 49 01                        db  %010'010'01,1       ; 2 dark grey (75% ink)
3751  9C67 00 00        				db  %000'000'000,0       ; 0 white-blueish (ink)
3752  9C69 C4 01                        db  %110'001'00,1       ; 4 red
3753  9C6B F8 01                        db  %111'110'00,1       ; 5 yellow
3754  9C6D 10 00                        db  %000'100'00,0       ; 6 green
3755  9C6F 00 00 00...  				ds 18
3756  9C81 BD 01        				db  %101'111'01,1       ; 0 zluta (paper)
3757  9C83 92 01                        db  %100'100'10,1       ; 1 light grey (25% ink)
3758  9C85 49 01                        db  %010'010'01,1       ; 2 dark grey (75% ink)
3759  9C87 00 00        				db  %000'000'00,0       ; 0 white-blueish (ink)
3760  9C89 C4 01                        db  %110'001'00,1       ; 4 red
3761  9C8B F8 01                        db  %111'110'00,1       ; 5 yellow
3762  9C8D 10 00                        db  %000'100'00,0       ; 6 green
3763  9C8F 00 00 00...  				ds 18
3764  9CA1 16 01        				db  %000'101'10,1       ; 0 zluta (paper)
3765  9CA3 92 01                        db  %100'100'10,1       ; 1 light grey (25% ink)
3766  9CA5 49 01                        db  %010'010'01,1       ; 2 dark grey (75% ink)
3767  9CA7 00 00        				db  %000'000'00,0       ; 0 white-blueish (ink)
3768  9CA9 C4 01                        db  %110'001'00,1       ; 4 red
3769  9CAB F8 01                        db  %111'110'00,1       ; 5 yellow
3770  9CAD 10 00                        db  %000'100'00,0       ; 6 green
3771  9CAF 00 00 00...  				ds 18
3772  9CC1
3773  9CC1
3774  9CC1
3775  9CC1
3776  9CC1              tilemapPalette_SZ:  EQU $ - tilemapPalette
3777  9CC1
3778  9CC1
3779  9CC1 00 00 00...  tilemapFont:    ds   16*32
3780  9EC1                                                                                  ; 24 chars skipped (3*256)
3781  9EC1                                                                                  ; starts at character 32 - 4 dir_arrows - 3 color dots - 1 reserve = 24
3782  9EC1
3783  9EC1              FILEBUFF
3784  9EC1              tilemapFont_char24:
3785  9EC1                          INCLUDE "tilemap_font_8x6.i.asm"
# file opened: tilemap_font_8x6.i.asm
   1+ 9EC1              specialchar
   2+ 9EC1              ;rovna horni cara
   3+ 9EC1 00 00 00 00  	HEX 00000000
   4+ 9EC5 33 33 33 33  	HEX 33333333
   5+ 9EC9 00 00 00 00  	HEX 00000000
   6+ 9ECD 33 33 33 33  	HEX 33333333
   7+ 9ED1 00 00 00 00  	HEX 00000000
   8+ 9ED5 00 00 00 00  	HEX 00000000
   9+ 9ED9 00 00 00 00  	HEX 00000000
  10+ 9EDD 00 00 00 00  	HEX 00000000
  11+ 9EE1              ;rovna spodni cara
  12+ 9EE1 00 00 00 00  	HEX 00000000
  13+ 9EE5 00 00 00 00  	HEX 00000000
  14+ 9EE9 00 00 00 00  	HEX 00000000
  15+ 9EED 00 00 00 00  	HEX 00000000
  16+ 9EF1 33 33 33 33  	HEX 33333333
  17+ 9EF5 00 00 00 00  	HEX 00000000
  18+ 9EF9 33 33 33 33  	HEX 33333333
  19+ 9EFD 00 00 00 00  	HEX 00000000
  20+ 9F01
  21+ 9F01              ;levy horni roh
  22+ 9F01 00 00 00 00  	HEX 00000000
  23+ 9F05 03 33 33 33  	HEX 03333333
  24+ 9F09 03 00 00 00  	HEX 03000000
  25+ 9F0D 03 03 33 33  	HEX 03033333
  26+ 9F11 03 03 00 00  	HEX 03030000
  27+ 9F15 03 03 00 00  	HEX 03030000
  28+ 9F19 03 03 00 00  	HEX 03030000
  29+ 9F1D 03 03 00 00  	HEX 03030000
  30+ 9F21              ;pravy horni roh
  31+ 9F21 00 00 00 00  	HEX 00000000
  32+ 9F25 33 33 33 30  	HEX 33333330
  33+ 9F29 00 00 00 30  	HEX 00000030
  34+ 9F2D 33 33 30 30  	HEX 33333030
  35+ 9F31 00 00 30 30  	HEX 00003030
  36+ 9F35 00 00 30 30  	HEX 00003030
  37+ 9F39 00 00 30 30  	HEX 00003030
  38+ 9F3D 00 00 30 30  	HEX 00003030
  39+ 9F41
  40+ 9F41              ;20 - pravy spodni roh
  41+ 9F41 00 00 30 30  	HEX 00003030
  42+ 9F45 00 00 30 30  	HEX 00003030
  43+ 9F49 00 00 30 30  	HEX 00003030
  44+ 9F4D 00 00 30 30  	HEX 00003030
  45+ 9F51 33 33 30 30  	HEX 33333030
  46+ 9F55 00 00 00 30  	HEX 00000030
  47+ 9F59 33 33 33 30  	HEX 33333330
  48+ 9F5D 00 00 00 00  	HEX 00000000
  49+ 9F61              ;21 - levy spodni roh
  50+ 9F61 03 03 00 00  	HEX 03030000
  51+ 9F65 03 03 00 00  	HEX 03030000
  52+ 9F69 03 03 00 00  	HEX 03030000
  53+ 9F6D 03 03 00 00  	HEX 03030000
  54+ 9F71 03 03 33 33  	HEX 03033333
  55+ 9F75 03 00 00 00  	HEX 03000000
  56+ 9F79 03 33 33 33  	HEX 03333333
  57+ 9F7D 00 00 00 00  	HEX 00000000
  58+ 9F81
  59+ 9F81              ;22 - rovna leva cara
  60+ 9F81 03 03 00 00  	HEX 03030000
  61+ 9F85 03 03 00 00  	HEX 03030000
  62+ 9F89 03 03 00 00  	HEX 03030000
  63+ 9F8D 03 03 00 00  	HEX 03030000
  64+ 9F91 03 03 00 00  	HEX 03030000
  65+ 9F95 03 03 00 00  	HEX 03030000
  66+ 9F99 03 03 00 00  	HEX 03030000
  67+ 9F9D 03 03 00 00  	HEX 03030000
  68+ 9FA1              ;23 - rovna prava cara
  69+ 9FA1 00 00 30 30  	HEX 00003030
  70+ 9FA5 00 00 30 30  	HEX 00003030
  71+ 9FA9 00 00 30 30  	HEX 00003030
  72+ 9FAD 00 00 30 30  	HEX 00003030
  73+ 9FB1 00 00 30 30  	HEX 00003030
  74+ 9FB5 00 00 30 30  	HEX 00003030
  75+ 9FB9 00 00 30 30  	HEX 00003030
  76+ 9FBD 00 00 30 30  	HEX 00003030
  77+ 9FC1              specialchar2
  78+ 9FC1              ;	HEX 00000000
  79+ 9FC1              ;HEX 00000000
  80+ 9FC1
  81+ 9FC1              ; 24 - full invisible (all red/yellow stripes)
  82+ 9FC1 55 55 44 44  	HEX	55554444
  83+ 9FC5 55 44 44 55  	HEX	55444455
  84+ 9FC9 44 44 55 55  	HEX	44445555
  85+ 9FCD 44 55 55 44  	HEX	44555544
  86+ 9FD1 55 55 44 44  	HEX	55554444
  87+ 9FD5 55 44 44 55  	HEX	55444455
  88+ 9FD9 44 44 55 55  	HEX	44445555
  89+ 9FDD 44 55 55 44  	HEX	44555544
  90+ 9FE1              ; 25 - red dot
  91+ 9FE1 00 00 00 00  	HEX	00000000 00444000 04444400
  91+ 9FE5 00 44 40 00
  91+ 9FE9 04 44 44 00
  92+ 9FED 04 44 44 00  	HEX	04444400 00444000 00000000
  92+ 9FF1 00 44 40 00
  92+ 9FF5 00 00 00 00
  93+ 9FF9 00 00 00 00  	HEX	00000000 00000000
  93+ 9FFD 00 00 00 00
  94+ A001              ; 26 - yellow dot
  95+ A001 00 00 00 00  	HEX	00000000 00555000 05555500
  95+ A005 00 55 50 00
  95+ A009 05 55 55 00
  96+ A00D 05 55 55 00  	HEX	05555500 00555000 00000000
  96+ A011 00 55 50 00
  96+ A015 00 00 00 00
  97+ A019 00 00 00 00  	HEX	00000000 00000000
  97+ A01D 00 00 00 00
  98+ A021              ; 27 - green dot
  99+ A021 00 00 00 00  	HEX	00000000 00666000 06666600
  99+ A025 00 66 60 00
  99+ A029 06 66 66 00
 100+ A02D 06 66 66 00  	HEX	06666600 00666000 00000000
 100+ A031 00 66 60 00
 100+ A035 00 00 00 00
 101+ A039 00 00 00 00  	HEX	00000000 00000000
 101+ A03D 00 00 00 00
 102+ A041              ; 28 - left arrow
 103+ A041 00 00 00 00  	HEX	00000000
 104+ A045 00 03 00 00  	HEX	00030000
 105+ A049 00 30 00 20  	HEX	00300020
 106+ A04D 03 00 02 00  	HEX	03000200
 107+ A051 00 30 00 20  	HEX	00300020
 108+ A055 00 03 00 00  	HEX	00030000
 109+ A059 00 00 00 00  	HEX	00000000
 110+ A05D 00 00 00 00  	HEX	00000000
 111+ A061              ; 29 - top arrow
 112+ A061 00 00 00 00  	HEX	00000000
 113+ A065 00 03 00 00  	HEX	00030000
 114+ A069 00 30 30 00  	HEX	00303000
 115+ A06D 03 00 03 00  	HEX	03000300
 116+ A071 30 02 00 30  	HEX	30020030
 117+ A075 00 20 20 00  	HEX	00202000
 118+ A079 02 00 02 00  	HEX	02000200
 119+ A07D 00 00 00 00  	HEX	00000000
 120+ A081              ; 30 - right arrow
 121+ A081 00 00 00 00  	HEX	00000000
 122+ A085 00 00 30 00  	HEX	00003000
 123+ A089 02 00 03 00  	HEX	02000300
 124+ A08D 00 20 00 30  	HEX	00200030
 125+ A091 02 00 03 00  	HEX	02000300
 126+ A095 00 00 30 00  	HEX	00003000
 127+ A099 00 00 00 00  	HEX	00000000
 128+ A09D 00 00 00 00  	HEX	00000000
 129+ A0A1              ; 31 - bottom arrow
 130+ A0A1 00 00 00 00  	HEX	00000000
 131+ A0A5 02 00 02 00  	HEX	02000200
 132+ A0A9 00 20 20 00  	HEX	00202000
 133+ A0AD 30 02 00 30  	HEX	30020030
 134+ A0B1 03 00 03 00  	HEX	03000300
 135+ A0B5 00 30 30 00  	HEX	00303000
 136+ A0B9 00 03 00 00  	HEX	00030000
 137+ A0BD 00 00 00 00  	HEX	00000000
 138+ A0C1              ; 32 - space (regular ZX charset onward)
 139+ A0C1 00 00 00 00  	HEX	00000000 00000000 00000000
 139+ A0C5 00 00 00 00
 139+ A0C9 00 00 00 00
 140+ A0CD 00 00 00 00  	HEX	00000000 00000000 00000000
 140+ A0D1 00 00 00 00
 140+ A0D5 00 00 00 00
 141+ A0D9 00 00 00 00  	HEX	00000000 00000000
 141+ A0DD 00 00 00 00
 142+ A0E1 00 32 00 00  	HEX	00320000 00320000 00320000
 142+ A0E5 00 32 00 00
 142+ A0E9 00 32 00 00
 143+ A0ED 00 00 00 00  	HEX	00000000 00320000 00000000
 143+ A0F1 00 32 00 00
 143+ A0F5 00 00 00 00
 144+ A0F9 00 00 00 00  	HEX	00000000 00000000
 144+ A0FD 00 00 00 00
 145+ A101 02 30 23 00  	HEX	02302300 01301300 03003000
 145+ A105 01 30 13 00
 145+ A109 03 00 30 00
 146+ A10D 00 00 00 00  	HEX	00000000 00000000 00000000
 146+ A111 00 00 00 00
 146+ A115 00 00 00 00
 147+ A119 00 00 00 00  	HEX	00000000 00000000
 147+ A11D 00 00 00 00
 148+ A121 00 30 30 00  	HEX	00303000 03333300 00303000
 148+ A125 03 33 33 00
 148+ A129 00 30 30 00
 149+ A12D 03 33 33 00  	HEX	03333300 00303000 00000000
 149+ A131 00 30 30 00
 149+ A135 00 00 00 00
 150+ A139 00 00 00 00  	HEX	00000000 00000000
 150+ A13D 00 00 00 00
 151+ A141 00 33 33 00  	HEX	00333300 03030000 00333000
 151+ A145 03 03 00 00
 151+ A149 00 33 30 00
 152+ A14D 00 03 03 00  	HEX	00030300 03333000 00030000
 152+ A151 03 33 30 00
 152+ A155 00 03 00 00
 153+ A159 00 00 00 00  	HEX	00000000 00000000
 153+ A15D 00 00 00 00
 154+ A161 03 30 03 00  	HEX	03300300 03203000 00030000
 154+ A165 03 20 30 00
 154+ A169 00 03 00 00
 155+ A16D 00 30 33 00  	HEX	00303300 03003200 00000000
 155+ A171 03 00 32 00
 155+ A175 00 00 00 00
 156+ A179 00 00 00 00  	HEX	00000000 00000000
 156+ A17D 00 00 00 00
 157+ A181 00 30 00 00  	HEX	00300000 03020000 00330300
 157+ A185 03 02 00 00
 157+ A189 00 33 03 00
 158+ A18D 03 00 30 00  	HEX	03003000 00330300 00000000
 158+ A191 00 33 03 00
 158+ A195 00 00 00 00
 159+ A199 00 00 00 00  	HEX	00000000 00000000
 159+ A19D 00 00 00 00
 160+ A1A1 00 23 00 00  	HEX	00230000 00130000 00300000
 160+ A1A5 00 13 00 00
 160+ A1A9 00 30 00 00
 161+ A1AD 00 00 00 00  	HEX	00000000 00000000 00000000
 161+ A1B1 00 00 00 00
 161+ A1B5 00 00 00 00
 162+ A1B9 00 00 00 00  	HEX	00000000 00000000
 162+ A1BD 00 00 00 00
 163+ A1C1 00 00 03 00  	HEX	00000300 00003000 00003000
 163+ A1C5 00 00 30 00
 163+ A1C9 00 00 30 00
 164+ A1CD 00 00 30 00  	HEX	00003000 00000300 00000000
 164+ A1D1 00 00 03 00
 164+ A1D5 00 00 00 00
 165+ A1D9 00 00 00 00  	HEX	00000000 00000000
 165+ A1DD 00 00 00 00
 166+ A1E1 03 00 00 00  	HEX	03000000 00300000 00300000
 166+ A1E5 00 30 00 00
 166+ A1E9 00 30 00 00
 167+ A1ED 00 30 00 00  	HEX	00300000 03000000 00000000
 167+ A1F1 03 00 00 00
 167+ A1F5 00 00 00 00
 168+ A1F9 00 00 00 00  	HEX	00000000 00000000
 168+ A1FD 00 00 00 00
 169+ A201 01 30 31 00  	HEX	01303100 00232000 03333300
 169+ A205 00 23 20 00
 169+ A209 03 33 33 00
 170+ A20D 00 23 20 00  	HEX	00232000 01303100 00000000
 170+ A211 01 30 31 00
 170+ A215 00 00 00 00
 171+ A219 00 00 00 00  	HEX	00000000 00000000
 171+ A21D 00 00 00 00
 172+ A221 00 03 00 00  	HEX	00030000 00030000 03333300
 172+ A225 00 03 00 00
 172+ A229 03 33 33 00
 173+ A22D 00 03 00 00  	HEX	00030000 00030000 00000000
 173+ A231 00 03 00 00
 173+ A235 00 00 00 00
 174+ A239 00 00 00 00  	HEX	00000000 00000000
 174+ A23D 00 00 00 00
 175+ A241 00 00 00 00  	HEX	00000000 00000000 00000000
 175+ A245 00 00 00 00
 175+ A249 00 00 00 00
 176+ A24D 01 30 00 00  	HEX	01300000 03000000 00000000
 176+ A251 03 00 00 00
 176+ A255 00 00 00 00
 177+ A259 00 00 00 00  	HEX	00000000 00000000
 177+ A25D 00 00 00 00
 178+ A261 00 00 00 00  	HEX	00000000 00000000 03333300
 178+ A265 00 00 00 00
 178+ A269 03 33 33 00
 179+ A26D 00 00 00 00  	HEX	00000000 00000000 00000000
 179+ A271 00 00 00 00
 179+ A275 00 00 00 00
 180+ A279 00 00 00 00  	HEX	00000000 00000000
 180+ A27D 00 00 00 00
 181+ A281 00 00 00 00  	HEX	00000000 00000000 00000000
 181+ A285 00 00 00 00
 181+ A289 00 00 00 00
 182+ A28D 00 00 00 00  	HEX	00000000 03200000 00000000
 182+ A291 03 20 00 00
 182+ A295 00 00 00 00
 183+ A299 00 00 00 00  	HEX	00000000 00000000
 183+ A29D 00 00 00 00
 184+ A2A1 00 00 03 00  	HEX	00000300 00003000 00030000
 184+ A2A5 00 00 30 00
 184+ A2A9 00 03 00 00
 185+ A2AD 00 30 00 00  	HEX	00300000 03000000 00000000
 185+ A2B1 03 00 00 00
 185+ A2B5 00 00 00 00
 186+ A2B9 00 00 00 00  	HEX	00000000 00000000
 186+ A2BD 00 00 00 00
 187+ A2C1 00 33 30 00  	HEX	00333000 03102300 03020300
 187+ A2C5 03 10 23 00
 187+ A2C9 03 02 03 00
 188+ A2CD 03 20 13 00  	HEX	03201300 00333000 00000000
 188+ A2D1 00 33 30 00
 188+ A2D5 00 00 00 00
 189+ A2D9 00 00 00 00  	HEX	00000000 00000000
 189+ A2DD 00 00 00 00
 190+ A2E1 00 02 30 00  	HEX	00023000 00233000 00013000
 190+ A2E5 00 23 30 00
 190+ A2E9 00 01 30 00
 191+ A2ED 00 01 30 00  	HEX	00013000 00133300 00000000
 191+ A2F1 00 13 33 00
 191+ A2F5 00 00 00 00
 192+ A2F9 00 00 00 00  	HEX	00000000 00000000
 192+ A2FD 00 00 00 00
 193+ A301 02 33 30 00  	HEX	02333000 01001300 00333000
 193+ A305 01 00 13 00
 193+ A309 00 33 30 00
 194+ A30D 03 10 00 00  	HEX	03100000 03333300 00000000
 194+ A311 03 33 33 00
 194+ A315 00 00 00 00
 195+ A319 00 00 00 00  	HEX	00000000 00000000
 195+ A31D 00 00 00 00
 196+ A321 02 33 30 00  	HEX	02333000 00001300 00333000
 196+ A325 00 00 13 00
 196+ A329 00 33 30 00
 197+ A32D 00 00 13 00  	HEX	00001300 02333000 00000000
 197+ A331 02 33 30 00
 197+ A335 00 00 00 00
 198+ A339 00 00 00 00  	HEX	00000000 00000000
 198+ A33D 00 00 00 00
 199+ A341 00 03 30 00  	HEX	00033000 00313000 03013000
 199+ A345 00 31 30 00
 199+ A349 03 01 30 00
 200+ A34D 03 33 33 00  	HEX	03333300 00013000 00000000
 200+ A351 00 01 30 00
 200+ A355 00 00 00 00
 201+ A359 00 00 00 00  	HEX	00000000 00000000
 201+ A35D 00 00 00 00
 202+ A361 03 33 33 00  	HEX	03333300 03000000 03333000
 202+ A365 03 00 00 00
 202+ A369 03 33 30 00
 203+ A36D 00 00 13 00  	HEX	00001300 02333000 00000000
 203+ A371 02 33 30 00
 203+ A375 00 00 00 00
 204+ A379 00 00 00 00  	HEX	00000000 00000000
 204+ A37D 00 00 00 00
 205+ A381 00 33 30 00  	HEX	00333000 03100000 03333000
 205+ A385 03 10 00 00
 205+ A389 03 33 30 00
 206+ A38D 03 10 13 00  	HEX	03101300 00333000 00000000
 206+ A391 00 33 30 00
 206+ A395 00 00 00 00
 207+ A399 00 00 00 00  	HEX	00000000 00000000
 207+ A39D 00 00 00 00
 208+ A3A1 03 33 32 00  	HEX	03333200 00003200 00032000
 208+ A3A5 00 00 32 00
 208+ A3A9 00 03 20 00
 209+ A3AD 00 32 00 00  	HEX	00320000 00320000 00000000
 209+ A3B1 00 32 00 00
 209+ A3B5 00 00 00 00
 210+ A3B9 00 00 00 00  	HEX	00000000 00000000
 210+ A3BD 00 00 00 00
 211+ A3C1 00 33 30 00  	HEX	00333000 03101300 00333000
 211+ A3C5 03 10 13 00
 211+ A3C9 00 33 30 00
 212+ A3CD 03 10 13 00  	HEX	03101300 00333000 00000000
 212+ A3D1 00 33 30 00
 212+ A3D5 00 00 00 00
 213+ A3D9 00 00 00 00  	HEX	00000000 00000000
 213+ A3DD 00 00 00 00
 214+ A3E1 00 33 30 00  	HEX	00333000 03101300 00333300
 214+ A3E5 03 10 13 00
 214+ A3E9 00 33 33 00
 215+ A3ED 00 00 13 00  	HEX	00001300 00333000 00000000
 215+ A3F1 00 33 30 00
 215+ A3F5 00 00 00 00
 216+ A3F9 00 00 00 00  	HEX	00000000 00000000
 216+ A3FD 00 00 00 00
 217+ A401 00 00 00 00  	HEX	00000000 00320000 00000000
 217+ A405 00 32 00 00
 217+ A409 00 00 00 00
 218+ A40D 00 32 00 00  	HEX	00320000 00000000 00000000
 218+ A411 00 00 00 00
 218+ A415 00 00 00 00
 219+ A419 00 00 00 00  	HEX	00000000 00000000
 219+ A41D 00 00 00 00
 220+ A421 00 00 00 00  	HEX	00000000 00230000 00000000
 220+ A425 00 23 00 00
 220+ A429 00 00 00 00
 221+ A42D 00 13 00 00  	HEX	00130000 00300000 00000000
 221+ A431 00 30 00 00
 221+ A435 00 00 00 00
 222+ A439 00 00 00 00  	HEX	00000000 00000000
 222+ A43D 00 00 00 00
 223+ A441 00 03 10 00  	HEX	00031000 00310000 03100000
 223+ A445 00 31 00 00
 223+ A449 03 10 00 00
 224+ A44D 00 31 00 00  	HEX	00310000 00031000 00000000
 224+ A451 00 03 10 00
 224+ A455 00 00 00 00
 225+ A459 00 00 00 00  	HEX	00000000 00000000
 225+ A45D 00 00 00 00
 226+ A461 00 00 00 00  	HEX	00000000 03333300 00000000
 226+ A465 03 33 33 00
 226+ A469 00 00 00 00
 227+ A46D 03 33 33 00  	HEX	03333300 00000000 00000000
 227+ A471 00 00 00 00
 227+ A475 00 00 00 00
 228+ A479 00 00 00 00  	HEX	00000000 00000000
 228+ A47D 00 00 00 00
 229+ A481 01 30 00 00  	HEX	01300000 00130000 00013000
 229+ A485 00 13 00 00
 229+ A489 00 01 30 00
 230+ A48D 00 13 00 00  	HEX	00130000 01300000 00000000
 230+ A491 01 30 00 00
 230+ A495 00 00 00 00
 231+ A499 00 00 00 00  	HEX	00000000 00000000
 231+ A49D 00 00 00 00
 232+ A4A1 02 33 00 00  	HEX	02330000 00013000 00330000
 232+ A4A5 00 01 30 00
 232+ A4A9 00 33 00 00
 233+ A4AD 00 00 00 00  	HEX	00000000 00310000 00000000
 233+ A4B1 00 31 00 00
 233+ A4B5 00 00 00 00
 234+ A4B9 00 00 00 00  	HEX	00000000 00000000
 234+ A4BD 00 00 00 00
 235+ A4C1 00 33 30 00  	HEX	00333000 03130300 03023200
 235+ A4C5 03 13 03 00
 235+ A4C9 03 02 32 00
 236+ A4CD 03 10 00 00  	HEX	03100000 00333000 00000000
 236+ A4D1 00 33 30 00
 236+ A4D5 00 00 00 00
 237+ A4D9 00 00 00 00  	HEX	00000000 00000000
 237+ A4DD 00 00 00 00
 238+ A4E1 00 33 30 00  	HEX	00333000 03101300 03333300
 238+ A4E5 03 10 13 00
 238+ A4E9 03 33 33 00
 239+ A4ED 03 00 03 00  	HEX	03000300 03000300 00000000
 239+ A4F1 03 00 03 00
 239+ A4F5 00 00 00 00
 240+ A4F9 00 00 00 00  	HEX	00000000 00000000
 240+ A4FD 00 00 00 00
 241+ A501 03 33 30 00  	HEX	03333000 03001300 03333000
 241+ A505 03 00 13 00
 241+ A509 03 33 30 00
 242+ A50D 03 00 13 00  	HEX	03001300 03333000 00000000
 242+ A511 03 33 30 00
 242+ A515 00 00 00 00
 243+ A519 00 00 00 00  	HEX	00000000 00000000
 243+ A51D 00 00 00 00
 244+ A521 00 33 32 00  	HEX	00333200 03100100 03000000
 244+ A525 03 10 01 00
 244+ A529 03 00 00 00
 245+ A52D 03 10 01 00  	HEX	03100100 00333200 00000000
 245+ A531 00 33 32 00
 245+ A535 00 00 00 00
 246+ A539 00 00 00 00  	HEX	00000000 00000000
 246+ A53D 00 00 00 00
 247+ A541 03 33 30 00  	HEX	03333000 03001300 03000300
 247+ A545 03 00 13 00
 247+ A549 03 00 03 00
 248+ A54D 03 00 13 00  	HEX	03001300 03333000 00000000
 248+ A551 03 33 30 00
 248+ A555 00 00 00 00
 249+ A559 00 00 00 00  	HEX	00000000 00000000
 249+ A55D 00 00 00 00
 250+ A561 03 33 33 00  	HEX	03333300 03000000 03330000
 250+ A565 03 00 00 00
 250+ A569 03 33 00 00
 251+ A56D 03 00 00 00  	HEX	03000000 03333300 00000000
 251+ A571 03 33 33 00
 251+ A575 00 00 00 00
 252+ A579 00 00 00 00  	HEX	00000000 00000000
 252+ A57D 00 00 00 00
 253+ A581 03 33 33 00  	HEX	03333300 03000000 03330000
 253+ A585 03 00 00 00
 253+ A589 03 33 00 00
 254+ A58D 03 00 00 00  	HEX	03000000 03000000 00000000
 254+ A591 03 00 00 00
 254+ A595 00 00 00 00
 255+ A599 00 00 00 00  	HEX	00000000 00000000
 255+ A59D 00 00 00 00
 256+ A5A1 00 33 32 00  	HEX	00333200 03100000 03003300
 256+ A5A5 03 10 00 00
 256+ A5A9 03 00 33 00
 257+ A5AD 03 10 03 00  	HEX	03100300 00333100 00000000
 257+ A5B1 00 33 31 00
 257+ A5B5 00 00 00 00
 258+ A5B9 00 00 00 00  	HEX	00000000 00000000
 258+ A5BD 00 00 00 00
 259+ A5C1 03 00 03 00  	HEX	03000300 03000300 03333300
 259+ A5C5 03 00 03 00
 259+ A5C9 03 33 33 00
 260+ A5CD 03 00 03 00  	HEX	03000300 03000300 00000000
 260+ A5D1 03 00 03 00
 260+ A5D5 00 00 00 00
 261+ A5D9 00 00 00 00  	HEX	00000000 00000000
 261+ A5DD 00 00 00 00
 262+ A5E1 00 33 30 00  	HEX	00333000 00030000 00030000
 262+ A5E5 00 03 00 00
 262+ A5E9 00 03 00 00
 263+ A5ED 00 03 00 00  	HEX	00030000 00333000 00000000
 263+ A5F1 00 33 30 00
 263+ A5F5 00 00 00 00
 264+ A5F9 00 00 00 00  	HEX	00000000 00000000
 264+ A5FD 00 00 00 00
 265+ A601 00 03 33 00  	HEX	00033300 00003000 00003000
 265+ A605 00 00 30 00
 265+ A609 00 00 30 00
 266+ A60D 03 10 30 00  	HEX	03103000 00331000 00000000
 266+ A611 00 33 10 00
 266+ A615 00 00 00 00
 267+ A619 00 00 00 00  	HEX	00000000 00000000
 267+ A61D 00 00 00 00
 268+ A621 03 00 03 00  	HEX	03000300 03003000 03330000
 268+ A625 03 00 30 00
 268+ A629 03 33 00 00
 269+ A62D 03 00 30 00  	HEX	03003000 03000300 00000000
 269+ A631 03 00 03 00
 269+ A635 00 00 00 00
 270+ A639 00 00 00 00  	HEX	00000000 00000000
 270+ A63D 00 00 00 00
 271+ A641 03 00 00 00  	HEX	03000000 03000000 03000000
 271+ A645 03 00 00 00
 271+ A649 03 00 00 00
 272+ A64D 03 00 00 00  	HEX	03000000 03333300 00000000
 272+ A651 03 33 33 00
 272+ A655 00 00 00 00
 273+ A659 00 00 00 00  	HEX	00000000 00000000
 273+ A65D 00 00 00 00
 274+ A661 03 00 03 00  	HEX	03000300 03303300 03030300
 274+ A665 03 30 33 00
 274+ A669 03 03 03 00
 275+ A66D 03 00 03 00  	HEX	03000300 03000300 00000000
 275+ A671 03 00 03 00
 275+ A675 00 00 00 00
 276+ A679 00 00 00 00  	HEX	00000000 00000000
 276+ A67D 00 00 00 00
 277+ A681 03 00 03 00  	HEX	03000300 03300300 03030300
 277+ A685 03 30 03 00
 277+ A689 03 03 03 00
 278+ A68D 03 00 33 00  	HEX	03003300 03000300 00000000
 278+ A691 03 00 03 00
 278+ A695 00 00 00 00
 279+ A699 00 00 00 00  	HEX	00000000 00000000
 279+ A69D 00 00 00 00
 280+ A6A1 00 33 30 00  	HEX	00333000 03101300 03000300
 280+ A6A5 03 10 13 00
 280+ A6A9 03 00 03 00
 281+ A6AD 03 10 13 00  	HEX	03101300 00333000 00000000
 281+ A6B1 00 33 30 00
 281+ A6B5 00 00 00 00
 282+ A6B9 00 00 00 00  	HEX	00000000 00000000
 282+ A6BD 00 00 00 00
 283+ A6C1 03 33 30 00  	HEX	03333000 03001300 03333000
 283+ A6C5 03 00 13 00
 283+ A6C9 03 33 30 00
 284+ A6CD 03 00 00 00  	HEX	03000000 03000000 00000000
 284+ A6D1 03 00 00 00
 284+ A6D5 00 00 00 00
 285+ A6D9 00 00 00 00  	HEX	00000000 00000000
 285+ A6DD 00 00 00 00
 286+ A6E1 00 33 30 00  	HEX	00333000 03101300 03000300
 286+ A6E5 03 10 13 00
 286+ A6E9 03 00 03 00
 287+ A6ED 03 10 23 00  	HEX	03102300 00333200 00000020
 287+ A6F1 00 33 32 00
 287+ A6F5 00 00 00 20
 288+ A6F9 00 00 00 00  	HEX	00000000 00000000
 288+ A6FD 00 00 00 00
 289+ A701 03 33 30 00  	HEX	03333000 03001300 03333000
 289+ A705 03 00 13 00
 289+ A709 03 33 30 00
 290+ A70D 03 00 30 00  	HEX	03003000 03000300 00000000
 290+ A711 03 00 03 00
 290+ A715 00 00 00 00
 291+ A719 00 00 00 00  	HEX	00000000 00000000
 291+ A71D 00 00 00 00
 292+ A721 00 33 32 00  	HEX	00333200 03100100 00333000
 292+ A725 03 10 01 00
 292+ A729 00 33 30 00
 293+ A72D 01 00 13 00  	HEX	01001300 02333000 00000000
 293+ A731 02 33 30 00
 293+ A735 00 00 00 00
 294+ A739 00 00 00 00  	HEX	00000000 00000000
 294+ A73D 00 00 00 00
 295+ A741 03 33 33 00  	HEX	03333300 00030000 00030000
 295+ A745 00 03 00 00
 295+ A749 00 03 00 00
 296+ A74D 00 03 00 00  	HEX	00030000 00030000 00000000
 296+ A751 00 03 00 00
 296+ A755 00 00 00 00
 297+ A759 00 00 00 00  	HEX	00000000 00000000
 297+ A75D 00 00 00 00
 298+ A761 03 00 03 00  	HEX	03000300 03000300 03000300
 298+ A765 03 00 03 00
 298+ A769 03 00 03 00
 299+ A76D 03 10 13 00  	HEX	03101300 00333000 00000000
 299+ A771 00 33 30 00
 299+ A775 00 00 00 00
 300+ A779 00 00 00 00  	HEX	00000000 00000000
 300+ A77D 00 00 00 00
 301+ A781 03 00 03 00  	HEX	03000300 03000300 03000300
 301+ A785 03 00 03 00
 301+ A789 03 00 03 00
 302+ A78D 00 30 30 00  	HEX	00303000 00030000 00000000
 302+ A791 00 03 00 00
 302+ A795 00 00 00 00
 303+ A799 00 00 00 00  	HEX	00000000 00000000
 303+ A79D 00 00 00 00
 304+ A7A1 03 00 03 00  	HEX	03000300 03000300 03030300
 304+ A7A5 03 00 03 00
 304+ A7A9 03 03 03 00
 305+ A7AD 03 03 03 00  	HEX	03030300 00303000 00000000
 305+ A7B1 00 30 30 00
 305+ A7B5 00 00 00 00
 306+ A7B9 00 00 00 00  	HEX	00000000 00000000
 306+ A7BD 00 00 00 00
 307+ A7C1 03 00 03 00  	HEX	03000300 00303000 00030000
 307+ A7C5 00 30 30 00
 307+ A7C9 00 03 00 00
 308+ A7CD 00 30 30 00  	HEX	00303000 03000300 00000000
 308+ A7D1 03 00 03 00
 308+ A7D5 00 00 00 00
 309+ A7D9 00 00 00 00  	HEX	00000000 00000000
 309+ A7DD 00 00 00 00
 310+ A7E1 03 00 03 00  	HEX	03000300 00303000 00030000
 310+ A7E5 00 30 30 00
 310+ A7E9 00 03 00 00
 311+ A7ED 00 03 00 00  	HEX	00030000 00030000 00000000
 311+ A7F1 00 03 00 00
 311+ A7F5 00 00 00 00
 312+ A7F9 00 00 00 00  	HEX	00000000 00000000
 312+ A7FD 00 00 00 00
 313+ A801 03 33 33 00  	HEX	03333300 00003000 00030000
 313+ A805 00 00 30 00
 313+ A809 00 03 00 00
 314+ A80D 00 30 00 00  	HEX	00300000 03333300 00000000
 314+ A811 03 33 33 00
 314+ A815 00 00 00 00
 315+ A819 00 00 00 00  	HEX	00000000 00000000
 315+ A81D 00 00 00 00
 316+ A821 00 00 33 00  	HEX	00003300 00003000 00003000
 316+ A825 00 00 30 00
 316+ A829 00 00 30 00
 317+ A82D 00 00 30 00  	HEX	00003000 00003300 00000000
 317+ A831 00 00 33 00
 317+ A835 00 00 00 00
 318+ A839 00 00 00 00  	HEX	00000000 00000000
 318+ A83D 00 00 00 00
 319+ A841 03 00 00 00  	HEX	03000000 00300000 00030000
 319+ A845 00 30 00 00
 319+ A849 00 03 00 00
 320+ A84D 00 00 30 00  	HEX	00003000 00000300 00000000
 320+ A851 00 00 03 00
 320+ A855 00 00 00 00
 321+ A859 00 00 00 00  	HEX	00000000 00000000
 321+ A85D 00 00 00 00
 322+ A861 03 30 00 00  	HEX	03300000 00300000 00300000
 322+ A865 00 30 00 00
 322+ A869 00 30 00 00
 323+ A86D 00 30 00 00  	HEX	00300000 03300000 00000000
 323+ A871 03 30 00 00
 323+ A875 00 00 00 00
 324+ A879 00 00 00 00  	HEX	00000000 00000000
 324+ A87D 00 00 00 00
 325+ A881 00 03 00 00  	HEX	00030000 00333000 02131200
 325+ A885 00 33 30 00
 325+ A889 02 13 12 00
 326+ A88D 00 03 00 00  	HEX	00030000 00030000 00000000
 326+ A891 00 03 00 00
 326+ A895 00 00 00 00
 327+ A899 00 00 00 00  	HEX	00000000 00000000
 327+ A89D 00 00 00 00
 328+ A8A1 00 00 00 00  	HEX	00000000 00000000 00000000
 328+ A8A5 00 00 00 00
 328+ A8A9 00 00 00 00
 329+ A8AD 00 00 00 00  	HEX	00000000 33333330 00000000
 329+ A8B1 33 33 33 30
 329+ A8B5 00 00 00 00
 330+ A8B9 00 00 00 00  	HEX	00000000 00000000
 330+ A8BD 00 00 00 00
 331+ A8C1 00 03 30 00  	HEX	00033000 00300300 03330000
 331+ A8C5 00 30 03 00
 331+ A8C9 03 33 00 00
 332+ A8CD 00 30 00 00  	HEX	00300000 03333300 00000000
 332+ A8D1 03 33 33 00
 332+ A8D5 00 00 00 00
 333+ A8D9 00 00 00 00  	HEX	00000000 00000000
 333+ A8DD 00 00 00 00
 334+ A8E1 00 00 00 00  	HEX	00000000 00330000 00113000
 334+ A8E5 00 33 00 00
 334+ A8E9 00 11 30 00
 335+ A8ED 03 22 30 00  	HEX	03223000 00333000 00000000
 335+ A8F1 00 33 30 00
 335+ A8F5 00 00 00 00
 336+ A8F9 00 00 00 00  	HEX	00000000 00000000
 336+ A8FD 00 00 00 00
 337+ A901 03 00 00 00  	HEX	03000000 03000000 03330000
 337+ A905 03 00 00 00
 337+ A909 03 33 00 00
 338+ A90D 03 01 30 00  	HEX	03013000 03330000 00000000
 338+ A911 03 33 00 00
 338+ A915 00 00 00 00
 339+ A919 00 00 00 00  	HEX	00000000 00000000
 339+ A91D 00 00 00 00
 340+ A921 00 00 00 00  	HEX	00000000 00333000 03100000
 340+ A925 00 33 30 00
 340+ A929 03 10 00 00
 341+ A92D 03 10 00 00  	HEX	03100000 00333000 00000000
 341+ A931 00 33 30 00
 341+ A935 00 00 00 00
 342+ A939 00 00 00 00  	HEX	00000000 00000000
 342+ A93D 00 00 00 00
 343+ A941 00 00 30 00  	HEX	00003000 00003000 00333000
 343+ A945 00 00 30 00
 343+ A949 00 33 30 00
 344+ A94D 03 10 30 00  	HEX	03103000 00333000 00000000
 344+ A951 00 33 30 00
 344+ A955 00 00 00 00
 345+ A959 00 00 00 00  	HEX	00000000 00000000
 345+ A95D 00 00 00 00
 346+ A961 00 00 00 00  	HEX	00000000 00330000 03223000
 346+ A965 00 33 00 00
 346+ A969 03 22 30 00
 347+ A96D 03 11 00 00  	HEX	03110000 00333000 00000000
 347+ A971 00 33 30 00
 347+ A975 00 00 00 00
 348+ A979 00 00 00 00  	HEX	00000000 00000000
 348+ A97D 00 00 00 00
 349+ A981 00 33 10 00  	HEX	00331000 03100000 03310000
 349+ A985 03 10 00 00
 349+ A989 03 31 00 00
 350+ A98D 03 00 00 00  	HEX	03000000 03000000 00000000
 350+ A991 03 00 00 00
 350+ A995 00 00 00 00
 351+ A999 00 00 00 00  	HEX	00000000 00000000
 351+ A99D 00 00 00 00
 352+ A9A1 00 00 00 00  	HEX	00000000 00333000 03103000
 352+ A9A5 00 33 30 00
 352+ A9A9 03 10 30 00
 353+ A9AD 00 33 30 00  	HEX	00333000 00013000 00330000
 353+ A9B1 00 01 30 00
 353+ A9B5 00 33 00 00
 354+ A9B9 00 00 00 00  	HEX	00000000 00000000
 354+ A9BD 00 00 00 00
 355+ A9C1 03 00 00 00  	HEX	03000000 03000000 03331000
 355+ A9C5 03 00 00 00
 355+ A9C9 03 33 10 00
 356+ A9CD 03 00 30 00  	HEX	03003000 03003000 00000000
 356+ A9D1 03 00 30 00
 356+ A9D5 00 00 00 00
 357+ A9D9 00 00 00 00  	HEX	00000000 00000000
 357+ A9DD 00 00 00 00
 358+ A9E1 00 03 00 00  	HEX	00030000 00000000 00230000
 358+ A9E5 00 00 00 00
 358+ A9E9 00 23 00 00
 359+ A9ED 00 03 00 00  	HEX	00030000 00232000 00000000
 359+ A9F1 00 23 20 00
 359+ A9F5 00 00 00 00
 360+ A9F9 00 00 00 00  	HEX	00000000 00000000
 360+ A9FD 00 00 00 00
 361+ AA01 00 03 00 00  	HEX	00030000 00000000 00030000
 361+ AA05 00 00 00 00
 361+ AA09 00 03 00 00
 362+ AA0D 00 03 00 00  	HEX	00030000 03030000 00300000
 362+ AA11 03 03 00 00
 362+ AA15 00 30 00 00
 363+ AA19 00 00 00 00  	HEX	00000000 00000000
 363+ AA1D 00 00 00 00
 364+ AA21 03 00 00 00  	HEX	03000000 03003000 03330000
 364+ AA25 03 00 30 00
 364+ AA29 03 33 00 00
 365+ AA2D 03 00 30 00  	HEX	03003000 03003000 00000000
 365+ AA31 03 00 30 00
 365+ AA35 00 00 00 00
 366+ AA39 00 00 00 00  	HEX	00000000 00000000
 366+ AA3D 00 00 00 00
 367+ AA41 00 30 00 00  	HEX	00300000 00300000 00300000
 367+ AA45 00 30 00 00
 367+ AA49 00 30 00 00
 368+ AA4D 00 30 00 00  	HEX	00300000 00030000 00000000
 368+ AA51 00 03 00 00
 368+ AA55 00 00 00 00
 369+ AA59 00 00 00 00  	HEX	00000000 00000000
 369+ AA5D 00 00 00 00
 370+ AA61 00 00 00 00  	HEX	00000000 03303000 03131300
 370+ AA65 03 30 30 00
 370+ AA69 03 13 13 00
 371+ AA6D 03 03 03 00  	HEX	03030300 03030300 00000000
 371+ AA71 03 03 03 00
 371+ AA75 00 00 00 00
 372+ AA79 00 00 00 00  	HEX	00000000 00000000
 372+ AA7D 00 00 00 00
 373+ AA81 00 00 00 00  	HEX	00000000 03330000 03013000
 373+ AA85 03 33 00 00
 373+ AA89 03 01 30 00
 374+ AA8D 03 00 30 00  	HEX	03003000 03003000 00000000
 374+ AA91 03 00 30 00
 374+ AA95 00 00 00 00
 375+ AA99 00 00 00 00  	HEX	00000000 00000000
 375+ AA9D 00 00 00 00
 376+ AAA1 00 00 00 00  	HEX	00000000 00330000 03003000
 376+ AAA5 00 33 00 00
 376+ AAA9 03 00 30 00
 377+ AAAD 03 00 30 00  	HEX	03003000 00330000 00000000
 377+ AAB1 00 33 00 00
 377+ AAB5 00 00 00 00
 378+ AAB9 00 00 00 00  	HEX	00000000 00000000
 378+ AABD 00 00 00 00
 379+ AAC1 00 00 00 00  	HEX	00000000 03330000 03013000
 379+ AAC5 03 33 00 00
 379+ AAC9 03 01 30 00
 380+ AACD 03 01 30 00  	HEX	03013000 03330000 03000000
 380+ AAD1 03 33 00 00
 380+ AAD5 03 00 00 00
 381+ AAD9 00 00 00 00  	HEX	00000000 00000000
 381+ AADD 00 00 00 00
 382+ AAE1 00 00 00 00  	HEX	00000000 00333000 03103000
 382+ AAE5 00 33 30 00
 382+ AAE9 03 10 30 00
 383+ AAED 03 10 30 00  	HEX	03103000 00333000 00002300
 383+ AAF1 00 33 30 00
 383+ AAF5 00 00 23 00
 384+ AAF9 00 00 00 00  	HEX	00000000 00000000
 384+ AAFD 00 00 00 00
 385+ AB01 00 00 00 00  	HEX	00000000 03033000 03300000
 385+ AB05 03 03 30 00
 385+ AB09 03 30 00 00
 386+ AB0D 03 00 00 00  	HEX	03000000 03000000 00000000
 386+ AB11 03 00 00 00
 386+ AB15 00 00 00 00
 387+ AB19 00 00 00 00  	HEX	00000000 00000000
 387+ AB1D 00 00 00 00
 388+ AB21 00 00 00 00  	HEX	00000000 00333000 03220000
 388+ AB25 00 33 30 00
 388+ AB29 03 22 00 00
 389+ AB2D 00 11 30 00  	HEX	00113000 03330000 00000000
 389+ AB31 03 33 00 00
 389+ AB35 00 00 00 00
 390+ AB39 00 00 00 00  	HEX	00000000 00000000
 390+ AB3D 00 00 00 00
 391+ AB41 00 30 00 00  	HEX	00300000 01331000 00300000
 391+ AB45 01 33 10 00
 391+ AB49 00 30 00 00
 392+ AB4D 00 31 00 00  	HEX	00310000 00031000 00000000
 392+ AB51 00 03 10 00
 392+ AB55 00 00 00 00
 393+ AB59 00 00 00 00  	HEX	00000000 00000000
 393+ AB5D 00 00 00 00
 394+ AB61 00 00 00 00  	HEX	00000000 03003000 03003000
 394+ AB65 03 00 30 00
 394+ AB69 03 00 30 00
 395+ AB6D 03 10 30 00  	HEX	03103000 02333000 00000000
 395+ AB71 02 33 30 00
 395+ AB75 00 00 00 00
 396+ AB79 00 00 00 00  	HEX	00000000 00000000
 396+ AB7D 00 00 00 00
 397+ AB81 00 00 00 00  	HEX	00000000 03000300 03000300
 397+ AB85 03 00 03 00
 397+ AB89 03 00 03 00
 398+ AB8D 00 30 30 00  	HEX	00303000 00030000 00000000
 398+ AB91 00 03 00 00
 398+ AB95 00 00 00 00
 399+ AB99 00 00 00 00  	HEX	00000000 00000000
 399+ AB9D 00 00 00 00
 400+ ABA1 00 00 00 00  	HEX	00000000 03030300 03030300
 400+ ABA5 03 03 03 00
 400+ ABA9 03 03 03 00
 401+ ABAD 03 13 13 00  	HEX	03131300 03303000 00000000
 401+ ABB1 03 30 30 00
 401+ ABB5 00 00 00 00
 402+ ABB9 00 00 00 00  	HEX	00000000 00000000
 402+ ABBD 00 00 00 00
 403+ ABC1 00 00 00 00  	HEX	00000000 03003000 03103000
 403+ ABC5 03 00 30 00
 403+ ABC9 03 10 30 00
 404+ ABCD 00 33 00 00  	HEX	00330000 03013000 00000000
 404+ ABD1 03 01 30 00
 404+ ABD5 00 00 00 00
 405+ ABD9 00 00 00 00  	HEX	00000000 00000000
 405+ ABDD 00 00 00 00
 406+ ABE1 00 00 00 00  	HEX	00000000 03003000 03103000
 406+ ABE5 03 00 30 00
 406+ ABE9 03 10 30 00
 407+ ABED 02 33 30 00  	HEX	02333000 00013000 03330000
 407+ ABF1 00 01 30 00
 407+ ABF5 03 33 00 00
 408+ ABF9 00 00 00 00  	HEX	00000000 00000000
 408+ ABFD 00 00 00 00
 409+ AC01 00 00 00 00  	HEX	00000000 03333000 00030000
 409+ AC05 03 33 30 00
 409+ AC09 00 03 00 00
 410+ AC0D 00 30 00 00  	HEX	00300000 03333000 00000000
 410+ AC11 03 33 30 00
 410+ AC15 00 00 00 00
 411+ AC19 00 00 00 00  	HEX	00000000 00000000
 411+ AC1D 00 00 00 00
 412+ AC21 00 00 23 00  	HEX	00002300 00003000 00032000
 412+ AC25 00 00 30 00
 412+ AC29 00 03 20 00
 413+ AC2D 00 00 30 00  	HEX	00003000 00002300 00000000
 413+ AC31 00 00 23 00
 413+ AC35 00 00 00 00
 414+ AC39 00 00 00 00  	HEX	00000000 00000000
 414+ AC3D 00 00 00 00
 415+ AC41 00 03 20 00  	HEX	00032000 00032000 00000000
 415+ AC45 00 03 20 00
 415+ AC49 00 00 00 00
 416+ AC4D 00 03 20 00  	HEX	00032000 00032000 00000000
 416+ AC51 00 03 20 00
 416+ AC55 00 00 00 00
 417+ AC59 00 00 00 00  	HEX	00000000 00000000
 417+ AC5D 00 00 00 00
 418+ AC61 03 20 00 00  	HEX	03200000 00300000 00230000
 418+ AC65 00 30 00 00
 418+ AC69 00 23 00 00
 419+ AC6D 00 30 00 00  	HEX	00300000 03200000 00000000
 419+ AC71 03 20 00 00
 419+ AC75 00 00 00 00
 420+ AC79 00 00 00 00  	HEX	00000000 00000000
 420+ AC7D 00 00 00 00
 421+ AC81 01 33 10 30  	HEX	01331030 03013310 00000000
 421+ AC85 03 01 33 10
 421+ AC89 00 00 00 00
 422+ AC8D 00 00 00 00  	HEX	00000000 00000000 00000000
 422+ AC91 00 00 00 00
 422+ AC95 00 00 00 00
 423+ AC99 00 00 00 00  	HEX	00000000 00000000
 423+ AC9D 00 00 00 00
 424+ ACA1 00 33 33 00  	HEX	00333300 03122130 03210030
 424+ ACA5 03 12 21 30
 424+ ACA9 03 21 00 30
 425+ ACAD 03 21 00 30  	HEX	03210030 03122130 00333300
 425+ ACB1 03 12 21 30
 425+ ACB5 00 33 33 00
 426+ ACB9 00 00 00 00  	HEX	00000000 00000000
 426+ ACBD 00 00 00 00
 427+ ACC1
# file closed: tilemap_font_8x6.i.asm
3786  ACC1              last:
3787  ACC1
3788  ACC1                            CSPECTMAP player.map
3789  ACC1                            savenex open "CalmCommander.nex",start,32766
3790  ACC1                            savenex core 2,0,0
3791  ACC1                            savenex auto
3792  ACC1                            savenex close
# file closed: cc.asm
